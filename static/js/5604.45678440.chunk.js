"use strict";(self.webpackChunkmaterialpro_main=self.webpackChunkmaterialpro_main||[]).push([[5604],{96447:(e,a,n)=>{n.r(a),n.d(a,{default:()=>ce});var t=n(65043),l=n(77348),r=n(22016),i=n(15710),s=n(86506),o=n(24056),c=n(93933),d=n(49157),u=n(18353),m=n(55080),h=n(65113),p=n(86178),g=n.n(p),b=(n(63578),n(93397)),x=n(70579);const j=()=>{g().locale("id");const e=(0,b.A)(),[a,n]=(0,t.useState)([]),[l,r]=(0,t.useState)([]);return(0,t.useEffect)((()=>{e.get("dapi/mobil/get").then((a=>{if(a.data.success){const t=a.data.data.map((e=>({id:e.id,title:"".concat(e.brand," ").concat(e.plat)})));n(t),console.log("Available cars:",t),e.get("dapi/mobil/pengambilan-calendar").then((e=>{if(e.data.success){const a={};t.forEach((e=>{a[e.title]=e.id}));const n=e.data.data.map(((e,n)=>{let t=e.group||e.group_id;if(!t&&e.brand&&e.plat){const n="".concat(e.brand," ").concat(e.plat);t=a[n]||1}return{id:e.id||n+1,group:t||1,title:e.title||e.user||"-",start_time:g()(e.start_time),end_time:g()(e.end_time),bgColor:e.bgColor||"rgba(225, 166, 244, 0.6)"}}));r(n),console.log("Pengambilan calendar:",n)}})).catch((e=>{console.error("Error fetching pengambilan calendar:",e)}))}})).catch((e=>{console.error("Error fetching available cars:",e)}))}),[]),(0,x.jsx)("div",{children:(0,x.jsx)(h.Ay,{groups:a,items:l,defaultTimeStart:g()().add(0,"day"),defaultTimeEnd:g()().add(12,"hour"),headerLabelFormats:{yearLong:"YYYY",yearShort:"YY",monthShort:"MMM YYYY",monthMedium:"MMMM YYYY",monthLong:"MMMM YYYY",dayShort:"DD MMM",dayLong:"dddd, DD MMM YYYY",hourShort:"HH:mm",hourMedium:"HH:mm",hourLong:"HH:mm:ss"}})})};var v=n(89379),A=n(22019),f=n(34535),y=n(5174),k=n(30815),M=n(37970),S=n(42788),C=n(26259);const w=[];function D(e){return Array.from({length:e},(()=>function(){let e="#";for(let a=0;a<6;a++)e+="0123456789ABCDEF"[Math.floor(16*Math.random())];return e}()))}const B=()=>{const e=(0,b.A)(),a=(new Date).getFullYear(),n=[a-2,a-1,a],[l,r]=(0,t.useState)({series:[{data:[]}],options:{chart:{height:350,type:"bar"},colors:w,plotOptions:{bar:{columnWidth:"45%",distributed:!0}},dataLabels:{enabled:!1},legend:{show:!1},xaxis:{categories:[],labels:{style:{colors:w,fontSize:"12px"}}}}}),[i,s]=(0,t.useState)("yearly"),[o,c]=(0,t.useState)(""),[d,u]=(0,t.useState)(a),[m,h]=(0,t.useState)(""),[p,g]=(0,t.useState)(""),j=(0,f.Ay)(y.A)({borderRadius:"17px",backgroundColor:"white",letterSpacing:"0.5px",border:"none","& .MuiOutlinedInput-notchedOutline":{borderRadius:"17px",border:"none"}});return t.useEffect((()=>{const n="".concat(a,"-01-01 00:00:00"),t="".concat(a,"-12-31 23:59:59");e.get("dapi/mobil/bbm-laporan",{params:{startdate:n,enddate:t}}).then((e=>{if(e.data.success){const a=e.data.data.categories||[],n=e.data.data.data||[],t=D(a.length);r((e=>(0,v.A)((0,v.A)({},e),{},{series:[{data:n}],options:(0,v.A)((0,v.A)({},e.options),{},{colors:t,xaxis:(0,v.A)((0,v.A)({},e.options.xaxis),{},{categories:a})})})))}})).catch((()=>{r((e=>(0,v.A)((0,v.A)({},e),{},{series:[{data:[]}],options:(0,v.A)((0,v.A)({},e.options),{},{xaxis:(0,v.A)((0,v.A)({},e.options.xaxis),{},{categories:[]})})})))}))}),[]),(0,x.jsxs)("div",{className:"chart-container",children:[(0,x.jsxs)(k.A,{display:"flex",justifyContent:"space-between",alignItems:"center",children:[(0,x.jsx)("h4",{style:{fontWeight:"bold",color:"black"},children:"Grafik BBM Mobil Operasional"}),(0,x.jsxs)(k.A,{display:"flex",alignItems:"center",children:[(0,x.jsx)(k.A,{className:"me-2",children:(0,x.jsxs)(j,{value:i,onChange:e=>{s(e.target.value),c(""),u(a),h(""),g("")},displayEmpty:!0,size:"small",children:[(0,x.jsx)(M.A,{value:"monthly",children:"Bulanan"}),(0,x.jsx)(M.A,{value:"yearly",children:"Tahunan"}),(0,x.jsx)(M.A,{value:"custom",children:"Kustom"})]})}),"monthly"===i&&(0,x.jsxs)(k.A,{display:"flex",alignItems:"center",children:[(0,x.jsxs)(j,{value:o,onChange:e=>c(e.target.value),displayEmpty:!0,size:"small",sx:{mr:1},children:[(0,x.jsx)(M.A,{value:"",children:(0,x.jsx)("em",{children:"Pilih Bulan"})}),Array.from({length:12},((e,a)=>(0,x.jsx)(M.A,{value:a+1,children:"Bulan ".concat(a+1)},a)))]}),(0,x.jsxs)(j,{value:d,onChange:e=>u(e.target.value),displayEmpty:!0,size:"small",children:[(0,x.jsx)(M.A,{value:"",children:(0,x.jsx)("em",{children:"Pilih Tahun"})}),n.map((e=>(0,x.jsx)(M.A,{value:e,children:e},e)))]})]}),"yearly"===i&&(0,x.jsx)(k.A,{children:(0,x.jsxs)(j,{value:d,onChange:e=>u(e.target.value),displayEmpty:!0,size:"small",children:[(0,x.jsx)(M.A,{value:"",children:(0,x.jsx)("em",{children:"Pilih Tahun"})}),n.map((e=>(0,x.jsx)(M.A,{value:e,children:e},e)))]})}),"custom"===i&&(0,x.jsxs)(k.A,{display:"flex",alignItems:"center",children:[(0,x.jsx)(S.A,{label:"Tanggal Mulai",type:"date",value:m,onChange:e=>h(e.target.value),size:"small",InputLabelProps:{shrink:!0},sx:{mr:1}}),(0,x.jsx)(S.A,{label:"Tanggal Akhir",type:"date",value:p,onChange:e=>g(e.target.value),size:"small",InputLabelProps:{shrink:!0}})]}),(0,x.jsx)(C.A,{color:"primary",size:"sm",style:{padding:"6px 18px",borderRadius:"17px",fontWeight:"bold"},onClick:()=>{const{start:n,end:t}=(()=>{if("yearly"===i&&d)return{start:"".concat(d,"-01-01 00:00:00"),end:"".concat(d,"-12-31 23:59:59")};if("monthly"===i&&d&&o){const e=new Date(d,o,0).getDate();return{start:"".concat(d,"-").concat(String(o).padStart(2,"0"),"-01 00:00:00"),end:"".concat(d,"-").concat(String(o).padStart(2,"0"),"-").concat(e," 23:59:59")}}return"custom"===i&&m&&p?{start:"".concat(m," 00:00:00"),end:"".concat(p," 23:59:59")}:{start:"".concat(a,"-01-01 00:00:00"),end:"".concat(a,"-12-31 23:59:59")}})();e.get("dapi/mobil/bbm-laporan",{params:{startdate:n,enddate:t}}).then((e=>{if(e.data.success){const a=e.data.data.categories||[],n=e.data.data.data||[],t=D(a.length);r((e=>(0,v.A)((0,v.A)({},e),{},{series:[{data:n}],options:(0,v.A)((0,v.A)({},e.options),{},{colors:t,xaxis:(0,v.A)((0,v.A)({},e.options.xaxis),{},{categories:a})})})))}else r((e=>(0,v.A)((0,v.A)({},e),{},{series:[{data:[]}],options:(0,v.A)((0,v.A)({},e.options),{},{xaxis:(0,v.A)((0,v.A)({},e.options.xaxis),{},{categories:[]})})})))})).catch((e=>{console.error("Error fetching BBM data:",e),r((e=>(0,v.A)((0,v.A)({},e),{},{series:[{data:[]}],options:(0,v.A)((0,v.A)({},e.options),{},{xaxis:(0,v.A)((0,v.A)({},e.options.xaxis),{},{categories:[]})})})))}))},children:"Tampilkan"})]})]}),(0,x.jsx)(A.A,{options:l.options,series:l.series,type:"bar",height:350})]})},P=()=>{const e=(0,t.useRef)(null),a=(0,b.A)(),[n,l]=(0,t.useState)([]);(0,t.useEffect)((()=>{a.get("dapi/mobil/available").then((e=>{e.data.success&&(l(e.data.data),console.log("Available cars:",e.data.data))})).catch((e=>{console.error("Error fetching available cars:",e)}))}),[]);return(0,x.jsxs)("div",{className:"available-cars",children:[(0,x.jsx)("button",{type:"button",className:"arrow-button left-arrow",onClick:()=>{e.current.scrollLeft-=300},children:"<"}),(0,x.jsx)("div",{className:"car-list",ref:e,children:n.map((e=>{const a=e.brand?e.brand.toLowerCase():"";let n="https://agungtoyota.co.id/app/sam/assets/product_car_model/a1f5610604298e07d5b4b2c369555fda.png";return a.includes("scoopy")?n="https://i.imgur.com/6N80uyd.png":a.includes("vanza")?n="https://www.seva.id/_next/image?url=https%3A%2F%2Fimages.prod.seva.id%2FToyota%2FAll%20New%20Avanza%2Fmain_color%2Fhitam.png&w=640&q=75":a.includes("fourtuner")?n="https://omnispace.blob.core.windows.net/strapi-prod/2022-09-19/TRAC_SUV_Car_Toyota_Fortuner_2_ffd7275fdf.png":a.includes("zenix")&&(n="https://www.kallatoyota.co.id/storage/images/thumbnail/car-types/1673314489-hybrid-20-v-hv-cvt-modelista.png"),(0,x.jsxs)("div",{className:"car-card",children:[(0,x.jsx)("img",{src:n,alt:e.name,className:"car-image"}),(0,x.jsx)("h4",{children:e.brand}),(0,x.jsx)("span",{children:e.plat})]},e.plat)}))}),(0,x.jsx)("button",{type:"button",className:"arrow-button right-arrow",onClick:()=>{e.current.scrollLeft+=300},children:">"})]})};var Y=n(81509),N=n(58390),T=n(89302),_=n(66919),E=n(18039),H=n(57972),R=n(74605),K=n(14256),I=n(11906),O=n(60446),L=n.n(O),F=n(40028),z=n(58786),U=n(20917),V=(n(94727),n(30342));const q=(0,t.forwardRef)(((e,a)=>{const n=(0,b.A)(),[l,r]=(0,t.useState)([]),{auth:i}=(0,V.A)(),s=e.afterReviewRef||null,o=(0,t.useCallback)((()=>{var e,a;console.log(i.user);const t=null!==(e=i.user)&&void 0!==e&&null!==(a=e.roles)&&void 0!==a&&a.includes("PICMobil")?"dapi/mobil/get-permintaan-all":"dapi/mobil/get-permintaan";n.get(t).then((e=>{const a=e.data.data.map((e=>(0,v.A)((0,v.A)({},e),{},{displayMobil:"".concat(e.brand," - ").concat(e.plat)})));r(a)})).catch((e=>{console.error("Error fetching data:",e)}))}),[i.user,n]);(0,t.useEffect)((()=>{o()}),[]),(0,t.useImperativeHandle)(a,(()=>({refreshData:o})));const c=[{name:"Aksi",cell:e=>{var a,t,l,r;return(0,x.jsxs)(x.Fragment,{children:[(null===(a=i.user)||void 0===a||null===(t=a.roles)||void 0===t?void 0:t.includes("PICMobil"))&&(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)(I.A,{variant:"contained",color:"success",size:"small",onClick:()=>(e=>{n.post("dapi/mobil/approve-permintaan/".concat(e)).then((()=>{(0,F.x)("success","Permintaan berhasil disetujui."),o(),s&&s.current&&s.current.refreshData&&s.current.refreshData()})).catch((e=>{console.error("Error approving request:",e),(0,F.x)("error","Terjadi kesalahan saat menyetujui permintaan.")}))})(null===e||void 0===e?void 0:e.id),style:{marginRight:"5px"},children:"Approve"}),(0,x.jsx)(I.A,{variant:"contained",color:"error",size:"small",onClick:()=>(e=>{let a="";(0,U.ZX)({title:"Konfirmasi Penolakan",message:"Masukkan alasan penolakan:",customUI:t=>{let{onClose:l}=t;return(0,x.jsxs)("div",{className:"custom-ui",children:[(0,x.jsx)("h1",{children:"Konfirmasi Penolakan"}),(0,x.jsx)(S.A,{label:"Alasan Penolakan",fullWidth:!0,multiline:!0,rows:3,onChange:e=>{a=e.target.value}}),(0,x.jsxs)("div",{style:{marginTop:"20px"},children:[(0,x.jsx)(I.A,{variant:"contained",color:"primary",onClick:()=>{a.trim()?(n.post("dapi/mobil/reject-permintaan/".concat(e),{ket:a}).then((()=>{(0,F.x)("success","Permintaan berhasil ditolak."),o(),s&&s.current&&s.current.refreshData&&s.current.refreshData()})).catch((e=>{console.error("Error rejecting request:",e),(0,F.x)("error","Terjadi kesalahan saat menolak permintaan.")})),l()):(0,F.x)("error","Harap masukkan alasan penolakan.")},children:"Submit"}),(0,x.jsx)(I.A,{variant:"outlined",color:"secondary",onClick:l,style:{marginLeft:"10px"},children:"Batal"})]})]})}})})(null===e||void 0===e?void 0:e.id),style:{marginRight:"5px"},children:"Reject"})]}),!(null!==(l=i.user)&&void 0!==l&&null!==(r=l.roles)&&void 0!==r&&r.includes("PICMobil"))&&(0,x.jsx)(I.A,{variant:"contained",color:"error",size:"small",disabled:null!==(null===e||void 0===e?void 0:e.status),onClick:()=>((e,a)=>{null===a?(0,U.ZX)({title:"Konfirmasi Hapus",message:"Apakah Anda yakin ingin menghapus permintaan ini?",buttons:[{label:"Ya",onClick:()=>{n.post("dapi/mobil/delete-permintaan/".concat(e)).then((()=>{(0,F.x)("success","Permintaan berhasil dihapus."),o()})).catch((e=>{console.error("Error deleting data:",e),(0,F.x)("error","Terjadi kesalahan saat menghapus permintaan.")}))}},{label:"Tidak",onClick:()=>{}}]}):(0,F.x)("error","Tidak bisa dihapus, permintaan sudah direview.")})(null===e||void 0===e?void 0:e.id,null===e||void 0===e?void 0:e.status),children:"Hapus"})]})},ignoreRowClick:!0,allowOverflow:!0,button:!0,width:"250px"},{name:"Tgl Pengajuan",selector:e=>null!==e&&void 0!==e&&e.created_at?new Date(null===e||void 0===e?void 0:e.created_at).toLocaleString():"Unknown",sortable:!0},{name:"Keperluan",selector:e=>null===e||void 0===e?void 0:e.keperluan,sortable:!0},{name:"Mobil",selector:e=>(null===e||void 0===e?void 0:e.displayMobil)||"-",sortable:!0},{name:"Dari",selector:e=>new Date(null===e||void 0===e?void 0:e.mulai).toLocaleString(),sortable:!0},{name:"Sampai",selector:e=>new Date(null===e||void 0===e?void 0:e.hingga).toLocaleString(),sortable:!0},{name:"Perlu Sopir",selector:e=>1===(null===e||void 0===e?void 0:e.sopir)?"Ya":"Tidak",sortable:!0},{name:"Status",selector:e=>null===(null===e||void 0===e?void 0:e.status)?"Under Review":0===(null===e||void 0===e?void 0:e.status)?"Reject":1===(null===e||void 0===e?void 0:e.status)?"Approve":"Unknown",sortable:!0},{name:"Keterangan",selector:e=>(null===e||void 0===e?void 0:e.ket)||"-",sortable:!1}];return(0,x.jsx)(z.Ay,{title:"List Permintaan Kendaraan",columns:c,data:l,pagination:!0,highlightOnHover:!0,striped:!0})})),Z=q,G=t.forwardRef(((e,a)=>{const n=(0,b.A)(),[l,r]=(0,t.useState)([]),i=()=>{n.get("dapi/mobil/get-permintaan-after").then((e=>{e.data.success&&r(e.data.data)})).catch((e=>{console.error("Error fetching after review data:",e)}))};(0,t.useEffect)((()=>{i()}),[]),t.useImperativeHandle(a,(()=>({refreshData:i})));const s=[{name:"Keperluan",selector:e=>e.keperluan,sortable:!0},{name:"Dibuat",selector:e=>e.created_by_name,sortable:!0},{name:"Dari",selector:e=>new Date(e.mulai).toLocaleString(),sortable:!0},{name:"Sampai",selector:e=>new Date(e.hingga).toLocaleString(),sortable:!0},{name:"Status",selector:e=>1===e.status?"Disetujui":"Ditolak",sortable:!0},{name:"Direview",selector:e=>e.review_by_name,sortable:!0},{name:"Keterangan",selector:e=>e.ket,sortable:!0}];return(0,x.jsx)(z.Ay,{title:"Permintaan Setelah Review",columns:s,data:l,pagination:!0,highlightOnHover:!0,striped:!0})})),W=()=>{const e=(0,b.A)(),[a,n]=(0,t.useState)(""),[l,r]=(0,t.useState)(null),[i,s]=(0,t.useState)(null),[o,c]=(0,t.useState)(0),m=(0,t.useRef)(null),h=(0,t.useRef)(null),[p,g]=t.useState(!0);return(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)(d.A,{children:(0,x.jsxs)(u.A,{children:[(0,x.jsx)(Y.A,{color:"info",isOpen:p,toggle:()=>g(!1),fade:!1,children:"Permintaan Mobil Minimal 1 Jam sebelum pemakaian"}),(0,x.jsxs)(k.A,{component:"form",onSubmit:t=>{if(t.preventDefault(),!a||!l||!i)return void(0,F.x)("error","Harap isi semua field sebelum mengajukan permintaan.");const d={keperluan:a,dari:l?L()(l).format("YYYY-MM-DD HH:mm:ss"):null,sampai:i?L()(i).format("YYYY-MM-DD HH:mm:ss"):null,perluSopir:o};e.post("dapi/mobil/insert-permintaan",d).then((e=>{console.log("Data submitted successfully:",e.data),(0,F.x)("success","Permintaan berhasil diajukan!"),n(""),r(null),s(null),c(0),m.current&&m.current.refreshData()})).catch((e=>{console.error("Error submitting data:",e),(0,F.x)("error","Terjadi kesalahan saat mengajukan permintaan.")}))},sx:{"& .MuiTextField-root":{m:1,width:"100%"},"& .MuiAutocomplete-root":{m:1,width:"100%"},"& .MuiButton-root":{m:1,width:"100%"},display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",width:"100%",margin:"auto"},noValidate:!0,autoComplete:"off",children:[(0,x.jsx)(S.A,{required:!0,id:"keperluan",label:"Keperluan",variant:"outlined",value:a,onChange:e=>n(e.target.value)}),(0,x.jsxs)(N.$,{dateAdapter:T.R,children:[(0,x.jsx)(_.K,{renderInput:e=>(0,x.jsx)(S.A,(0,v.A)({},e)),label:"Dari",ampm:!1,value:l,onChange:r,viewRenderers:{hours:E.Zo,minutes:E.Zo}}),(0,x.jsx)(_.K,{renderInput:e=>(0,x.jsx)(S.A,(0,v.A)({},e)),label:"Sampai",ampm:!1,value:i,onChange:s,viewRenderers:{hours:E.Zo,minutes:E.Zo}})]}),(0,x.jsx)(k.A,{sx:{"& .MuiFormLabel-root":{m:1,width:"100%"},"& .MuiRadioGroup-root":{m:1,width:"100%"},display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",border:"1px solid #ccc",borderRadius:"4px",paddingLeft:"20px",paddingRight:"20px",width:"100%",margin:"auto",marginTop:"8px"},children:(0,x.jsxs)(H.A,{row:!0,value:o,onChange:e=>c(e.target.value),sx:{justifyContent:"space-between",width:"100%"},children:[(0,x.jsx)(R.A,{value:"1",control:(0,x.jsx)(K.A,{}),label:"Memerlukan Sopir"}),(0,x.jsx)(R.A,{value:"0",control:(0,x.jsx)(K.A,{}),label:"Tidak Memerlukan Sopir"})]})}),(0,x.jsx)(I.A,{type:"submit",variant:"contained",color:"secondary",size:"large",children:"Submit Pemintaan"})]})]})}),(0,x.jsx)(d.A,{children:(0,x.jsx)(u.A,{children:(0,x.jsx)(Z,{ref:m,afterReviewRef:h})})}),(0,x.jsx)(d.A,{children:(0,x.jsx)(u.A,{children:(0,x.jsx)(G,{ref:h})})})]})};var J=n(80045),X=n(28007);const $=["key"],Q=()=>{const e=(0,b.A)(),[a,n]=(0,t.useState)(null),[l,r]=(0,t.useState)([]),[i,s]=(0,t.useState)(null),[o,c]=(0,t.useState)(""),[h,p]=(0,t.useState)("booking"),[g,j]=(0,t.useState)(""),[A,f]=(0,t.useState)(""),[y,C]=(0,t.useState)([]),[w,D]=(0,t.useState)([]),[B,P]=(0,t.useState)([]),H=()=>{e.get("dapi/mobil/get-pengambilan").then((e=>{e.data.success&&P(e.data.data)})).catch((e=>{console.error("Error fetching pengambilan:",e)}))};(0,t.useEffect)((()=>{e.get("api/employe/assignment-list?search=all").then((e=>{r(e.data.data),console.log(e.data.data)})),e.get("dapi/mobil/get-permintaan-by-status").then((e=>{e.data.success&&(console.log(e),C(e.data.data))})).catch((e=>{console.error("Error fetching bookings:",e)})),e.get("dapi/mobil/get").then((e=>{e.data.success&&D(e.data.data)})).catch((e=>{console.error("Error fetching mobils:",e)})),H()}),[]);const R={padding:"5px 10px",backgroundColor:"#007BFF",color:"#fff",border:"none",borderRadius:"5px",cursor:"pointer"},K=[{name:"Pengembalian",cell:a=>a.real_pengembalian?(0,x.jsx)("span",{children:L()(a.real_pengembalian).format("YYYY-MM-DD HH:mm")}):(0,x.jsx)("button",{type:"button",style:R,onClick:()=>(a=>{let n=null;(0,U.ZX)({title:"Konfirmasi Pengembalian",message:"Cek apakah kilometer dan minyak sesuai?",customUI:t=>{let{onClose:l}=t;return(0,x.jsxs)("div",{className:"custom-ui",children:[(0,x.jsx)("h1",{children:"Konfirmasi Pengembalian"}),(0,x.jsx)("p",{children:"Cek apakah kilometer dan minyak sesuai?"}),(0,x.jsx)(S.A,{label:"Kilometer Terakhir",type:"number",fullWidth:!0,onChange:e=>{n=e.target.value}}),(0,x.jsxs)("div",{style:{marginTop:"20px"},children:[(0,x.jsx)(I.A,{variant:"contained",color:"primary",onClick:()=>{n?(e.post("dapi/mobil/pengembalian/".concat(a),{last_km:n}).then((e=>{e.data.success?((0,F.x)("success","Mobil berhasil dikembalikan."),H()):(0,F.x)("error","Gagal mengembalikan mobil.")})).catch((e=>{console.error("Error during return:",e),(0,F.x)("error","Terjadi kesalahan saat mengembalikan mobil.")})),l()):(0,F.x)("error","Harap masukkan kilometer terbaru.")},children:"Ya"}),(0,x.jsx)(I.A,{variant:"outlined",color:"secondary",onClick:l,style:{marginLeft:"10px"},children:"Tidak"})]})]})}})})(a.id),children:"Pengembalian"}),width:"150px",button:!0,sortable:!1},{name:"Nama Karyawan",selector:e=>e.employe_name||e.employe_name,sortable:!0},{name:"Pengambilan",selector:e=>e.taken_time||e.taken_time,sortable:!0},{name:"Perjanjian Pengembalian",selector:e=>e.pengembalian||e.pengembalian,sortable:!0},{name:"Nama Mobil",selector:e=>"".concat(e.brand," - ").concat(e.plat),sortable:!0}],O=(0,x.jsx)("div",{style:{textAlign:"center",padding:"20px"},children:"Tidak ada data yang tersedia."}),[V,q]=t.useState(!0);return(0,x.jsxs)(x.Fragment,{children:[(0,x.jsxs)(d.A,{children:[(0,x.jsx)(m.A,{children:(0,x.jsx)("strong",{children:"Pengambilan Mobil"})}),(0,x.jsxs)(u.A,{children:[(0,x.jsx)(Y.A,{color:"info",isOpen:V,toggle:()=>q(!1),fade:!1,children:"Utamakan yang telah melakukan booking terlebih dahulu"}),(0,x.jsxs)(k.A,{component:"form",sx:{"& .MuiTextField-root":{m:1,width:"100%"},"& .MuiAutocomplete-root":{m:1,width:"100%"},"& .MuiButton-root":{m:1,width:"100%"},display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",width:"100%",margin:"auto"},noValidate:!0,autoComplete:"off",onSubmit:t=>{if(t.preventDefault(),"booking"===h&&!o)return void(0,F.x)("error","Harap isi semua field (Mobil dan Perkiraan Pengembalian) sebelum menyimpan.");if("booking"!==h&&(!o||!a||!A||!i))return void(0,F.x)("error","Harap isi semua field sebelum menyimpan.");console.log(a);const l={id_mobil:o,booked:"booking"===h?g:null,employe_id:"booking"!==h?null===a||void 0===a?void 0:a.value:null,keperluan:"booking"!==h?A:null,sampai:L()(i).format("YYYY-MM-DD HH:mm:ss"),book:h};e.post("dapi/mobil/insert-pengambilan",l).then((e=>{e.data.success?((0,F.x)("success","Data pengambilan berhasil disimpan."),c(""),j(""),n(null),f(""),s(null),p("booking")):(0,F.x)("error","Gagal menyimpan data pengambilan.")})).catch((e=>{console.error("Error saving data:",e),(0,F.x)("error","Terjadi kesalahan saat menyimpan data.")}))},children:[(0,x.jsxs)(S.A,{style:{width:"100%"},variant:"outlined",value:h,onChange:e=>p(e.target.value),select:!0,label:"Booking / No Booking",children:[(0,x.jsx)(M.A,{value:"booking",children:"Booking"}),(0,x.jsx)(M.A,{value:"no-booking",children:"No Booking"})]}),"booking"===h&&(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)(S.A,{style:{width:"100%"},variant:"outlined",value:g,onChange:e=>j(e.target.value),select:!0,label:"Nomor Booking",children:y.map((e=>(0,x.jsx)(M.A,{value:e.id,children:"".concat(e.created_by_name," - ").concat(L()(e.mulai).format("YYYY-MM-DD HH:mm")," s/d ").concat(L()(e.hingga).format("YYYY-MM-DD HH:mm"))},e.id)))}),(0,x.jsx)(S.A,{style:{width:"100%"},variant:"outlined",value:o,onChange:e=>c(e.target.value),select:!0,label:"Unit Mobil",children:w.map((e=>(0,x.jsx)(M.A,{value:e.id,children:"".concat(e.brand," - ").concat(e.plat)},e.id)))})]}),"booking"!==h&&(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)(S.A,{style:{width:"100%"},variant:"outlined",value:o,onChange:e=>c(e.target.value),select:!0,label:"Unit Mobil",children:w.map((e=>(0,x.jsx)(M.A,{value:e.id,children:"".concat(e.brand," - ").concat(e.plat)},e.id)))}),l.length>0&&(0,x.jsx)(X.A,{style:{marginLeft:-10},disablePortal:!0,id:"combo-box-demo",options:l||[],value:a,onChange:(e,a)=>{"string"===typeof a?n({label:a}):a&&a.inputValue?n({label:a.inputValue}):n(a)},getOptionLabel:e=>"string"===typeof e?e:e.inputValue?e.inputValue:e.label,renderOption:(e,a)=>{const{key:n}=e,t=(0,J.A)(e,$);return(0,x.jsx)("li",(0,v.A)((0,v.A)({},t),{},{children:a.label}),n)},renderInput:e=>(0,x.jsx)(S.A,(0,v.A)((0,v.A)({},e),{},{label:"Nama Karyawan"}))}),(0,x.jsx)(S.A,{required:!0,id:"keperluan",label:"Keperluan",variant:"outlined",value:A,onChange:e=>f(e.target.value)}),(0,x.jsx)(N.$,{dateAdapter:T.R,children:(0,x.jsx)(_.K,{renderInput:e=>(0,x.jsx)(S.A,(0,v.A)({},e)),label:"Perkiraan Pengembalian",ampm:!1,value:i,onChange:s,viewRenderers:{hours:E.Zo,minutes:E.Zo}})})]}),(0,x.jsx)(I.A,{type:"submit",variant:"contained",color:"secondary",size:"large",children:"Simpan"})]})]})]}),(0,x.jsxs)(d.A,{children:[(0,x.jsx)(m.A,{children:(0,x.jsx)("strong",{children:"Pengembalian Mobil"})}),(0,x.jsx)(u.A,{children:(0,x.jsx)(z.Ay,{columns:K,data:B,noDataComponent:O,pagination:!0,fixedHeader:!0,sortable:!0,fixedHeaderScrollHeight:"300px"})})]})]})};var ee=n(53193),ae=n(79190),ne=n(85865);const te=()=>{const e=(0,b.A)(),[a,n]=(0,t.useState)([]);(0,t.useEffect)((()=>{e.get("dapi/mobil/get-bbm").then((e=>{e.data.success&&(console.log(e.data.data),n(e.data.data))})).catch((e=>{console.error("Error fetching BBM data:",e)}))}),[]);return(0,x.jsx)(z.Ay,{title:"Daftar Pengisian BBM",columns:[{name:"Unit Kendaraan",selector:e=>"".concat(e.name),sortable:!0},{name:"Jenis BBM",selector:e=>e.jenis_bbm,sortable:!0},{name:"Jumlah Biaya (Rp)",selector:e=>e.jumlah,sortable:!0},{name:"Tanggal Pengisian",selector:e=>e.w_pengisian,sortable:!0},{name:"Pengisian Oleh",selector:e=>e.oleh_name,sortable:!0}],data:a,pagination:!0,highlightOnHover:!0,striped:!0})},le=["key"],re=()=>{const e=(0,b.A)(),[a,n]=(0,t.useState)(""),[l,r]=(0,t.useState)(""),[i,s]=(0,t.useState)(""),[o,c]=(0,t.useState)(null),[m,h]=(0,t.useState)(null),[p,g]=(0,t.useState)([]),[j,A]=(0,t.useState)([]),[f,C]=(0,t.useState)(0),[w,D]=(0,t.useState)({});return(0,t.useEffect)((()=>{e.get("api/employe/assignment-list?search=all").then((e=>{g(e.data.data),console.log(e.data.data)})),e.get("dapi/mobil/get").then((e=>{if(e.data.success){const a=e.data.data.map((e=>({value:e.id,label:"".concat(e.brand," - ").concat(e.plat)})));A(a)}})).catch((e=>{console.error("Error fetching unit mobil:",e)}))}),[]),(0,x.jsx)(d.A,{children:(0,x.jsxs)(u.A,{children:[(0,x.jsxs)(k.A,{component:"form",onSubmit:t=>{t.preventDefault();const d={};if(a||(d.unitMobil="Unit Mobil is required"),l||(d.jenisBbm="Jenis BBM is required"),(!i||Number.isNaN(Number(i))||Number(i)<=0)&&(d.jumlahBiaya="Jumlah Biaya must be a positive number"),o||(d.tanggal="Tanggal Pengisian is required"),m||(d.employe="Pengisian oleh is required"),Object.keys(d).length>0)return void D(d);const u=L()(o).format("YYYY-MM-DD HH:mm:ss"),p={id_mobil:a,jenis_bbm:l,jumlah:i,w_pengisian:u,oleh:null===m||void 0===m?void 0:m.value};e.post("dapi/mobil/insert-bbm",p).then((e=>{e.data.success?((0,F.x)("success","Data pengisian BBM berhasil disimpan."),n(""),r(""),s(""),c(null),h(null),D({}),C((e=>e+1))):(0,F.x)("error","Gagal menyimpan data pengisian BBM.")})).catch((e=>{console.error("Error submitting data:",e),(0,F.x)("error","Terjadi kesalahan saat menyimpan data pengisian BBM.")}))},noValidate:!0,autoComplete:"off",sx:{display:"flex",flexDirection:"column",gap:2,margin:"auto",padding:2},children:[(0,x.jsxs)(ee.A,{fullWidth:!0,error:Boolean(w.unitMobil),children:[(0,x.jsx)(ae.A,{id:"unit-mobil-label",children:"Unit Kendaraan"}),(0,x.jsx)(y.A,{labelId:"unit-mobil-label",id:"unit-mobil",value:a,onChange:e=>n(e.target.value),label:"Unit Kendaraan",children:j.map((e=>(0,x.jsx)(M.A,{value:e.value,children:e.label},e.value)))}),w.unitMobil&&(0,x.jsx)(ne.A,{color:"error",children:w.unitMobil})]}),(0,x.jsxs)(ee.A,{fullWidth:!0,error:Boolean(w.jenisBbm),children:[(0,x.jsx)(ae.A,{id:"jenis-bbm-label",children:"Jenis BBM"}),(0,x.jsx)(y.A,{labelId:"jenis-bbm-label",id:"jenis-bbm",value:l,onChange:e=>r(e.target.value),label:"Jenis BBM",children:[{label:"Solar (CN 48)",value:"bio_solar",ron:"48",jenis:"diesel"},{label:"Dexlite (CN 51)",value:"dexlite",ron:"51",jenis:"diesel"},{label:"Pertalite (RON 90)",value:"pertalite",ron:"90",jenis:"bensin"},{label:"Pertamax (RON 92)",value:"pertamax",ron:"92",jenis:"bensin"},{label:"Pertamax Green (RON 95)",value:"pertamax_green",ron:"95",jenis:"bensin"},{label:"Pertamax Turbo (RON 98)",value:"pertamax_turbo",ron:"98",jenis:"bensin"},{label:"Dex (CN 53)",value:"dex",ron:"53",jenis:"diesel"}].map((e=>(0,x.jsx)(M.A,{value:e.value,children:e.label},e.value)))}),w.jenisBbm&&(0,x.jsx)(ne.A,{color:"error",children:w.jenisBbm})]}),(0,x.jsx)(S.A,{label:"Jumlah Biaya (Rp)",variant:"outlined",type:"number",value:i,onChange:e=>s(e.target.value),error:Boolean(w.jumlahBiaya),helperText:w.jumlahBiaya,fullWidth:!0}),(0,x.jsx)(N.$,{dateAdapter:T.R,children:(0,x.jsx)(_.K,{renderInput:e=>(0,x.jsx)(S.A,(0,v.A)({},e)),label:"Tgl Pengisian",ampm:!1,value:o,onChange:c,viewRenderers:{hours:E.Zo,minutes:E.Zo}})}),p.length>0&&(0,x.jsx)(X.A,{disablePortal:!0,id:"combo-box-demo",options:p||[],value:m,onChange:(e,a)=>{"string"===typeof a?h({label:a}):a&&a.inputValue?h({label:a.inputValue}):h(a)},getOptionLabel:e=>"string"===typeof e?e:e.inputValue?e.inputValue:e.label,renderOption:(e,a)=>{const{key:n}=e,t=(0,J.A)(e,le);return(0,x.jsx)("li",(0,v.A)((0,v.A)({},t),{},{children:a.label}),n)},renderInput:e=>(0,x.jsx)(S.A,(0,v.A)((0,v.A)({},e),{},{label:"Pengisian oleh"}))}),(0,x.jsx)(I.A,{type:"submit",variant:"contained",color:"primary",children:"Submit"})]}),(0,x.jsx)(k.A,{mt:4,children:(0,x.jsx)(te,{},f)})]})})};var ie=n(4598);const se=()=>{const e=(0,b.A)(),[a,n]=(0,t.useState)([]),[l,r]=t.useState(""),[i,s]=t.useState(""),[o,c]=t.useState(""),[h,p]=(0,t.useState)({}),g=()=>{e.get("dapi/mobil/get").then((e=>{e.data.success&&n(e.data.data)})).catch((e=>{console.log(e)}))};t.useEffect((()=>{g()}),[]);const j=[{name:"No",selector:(e,a)=>a+1,sortable:!0},{name:"Brand Kendaraan",selector:e=>e.brand,sortable:!0},{name:"Plat Kendaraan",selector:e=>e.plat,sortable:!0},{name:"Status",selector:a=>(0,x.jsx)(R.A,{control:(0,x.jsx)(ie.A,{checked:"aktif"===a.status,onChange:()=>((a,n)=>{e.post("dapi/mobil/update/".concat(a),{status:"aktif"===n?"non-aktif":"aktif"}).then((e=>{e.data.success?((0,F.x)("success","Status berhasil diubah"),g()):(0,F.x)("error","Status gagal diubah")})).catch((e=>{console.log(e),(0,F.x)("error","Terjadi kesalahan saat mengubah status")}))})(a.id,a.status),color:"primary"}),label:"aktif"===a.status?"Aktif":"Nonaktif"})},{name:"Action",selector:a=>(0,x.jsx)(I.A,{size:"small",variant:"contained",color:"secondary",onClick:()=>{(a=>{(0,U.ZX)({title:"Konfirmasi Hapus",message:"Apakah Anda yakin ingin menghapus data ini?",buttons:[{label:"Ya",onClick:()=>{e.post("dapi/mobil/delete/".concat(a)).then((e=>{e.data.success?((0,F.x)("success","Data berhasil dihapus"),g()):(0,F.x)("error","Data gagal dihapus")})).catch((e=>{console.log(e),(0,F.x)("error","Terjadi kesalahan saat menghapus data")}))}},{label:"Tidak",onClick:()=>{}}]})})(a.id)},children:"Hapus"})}];return(0,x.jsx)(x.Fragment,{children:(0,x.jsxs)(d.A,{children:[(0,x.jsx)(m.A,{children:(0,x.jsx)("strong",{children:"Management Kendaraan Operasional"})}),(0,x.jsxs)(u.A,{children:[(0,x.jsxs)(k.A,{component:"form",onSubmit:async a=>{a.preventDefault();const n={};l||(n.brand="Brand Kendaraan is required"),i||(n.plat="Plat Kendaraan is required"),o||(n.status="Status Kendaraan is required"),Object.keys(n).length>0?p(n):(await e.post("dapi/mobil/insert",{brand:l,plat:i,status:o}).then((e=>{e.data.success?((0,F.x)("success","Data berhasil disimpan"),r(""),s(""),c(""),g()):(0,F.x)("error","Data gagal disimpan")})).catch((e=>{console.log(e),(0,F.x)("error","Terjadi kesalahan saat menyimpan data")})),p({}))},noValidate:!0,autoComplete:"off",sx:{display:"flex",flexDirection:"column",gap:2,margin:"auto",padding:2},children:[(0,x.jsx)(S.A,{label:"Merek Kendaraan",variant:"outlined",type:"text",value:l,onChange:e=>r(e.target.value),error:Boolean(h.brand),helperText:h.brand,fullWidth:!0}),(0,x.jsx)(S.A,{label:"Plat Kendaraan",variant:"outlined",type:"text",value:i,onChange:e=>s(e.target.value),error:Boolean(h.plat),helperText:h.plat,fullWidth:!0}),(0,x.jsxs)(ee.A,{fullWidth:!0,error:Boolean(h.status),children:[(0,x.jsx)(ae.A,{id:"unit-kendaraan-label",children:"Status"}),(0,x.jsxs)(y.A,{labelId:"unit-kendaraan-label",id:"unit-kendaraan",value:o,onChange:e=>c(e.target.value),label:"Unit Kendaraan",children:[(0,x.jsx)(M.A,{value:"aktif",children:"Aktif"}),(0,x.jsx)(M.A,{value:"non-aktif",children:"Non-Aktif"})]}),h.status&&(0,x.jsx)(ne.A,{color:"error",children:h.status})]}),(0,x.jsx)(I.A,{type:"submit",variant:"contained",color:"primary",children:"Tambah Data Kendaraan"})]}),(0,x.jsx)(z.Ay,{className:"mt-3",columns:j,data:a,pagination:!0,highlightOnHover:!0,pointerOnHover:!0,striped:!0,responsive:!0})]})]})})},oe=()=>{var e,a;const[n,l]=(0,t.useState)("1"),{auth:h}=(0,V.A)();(0,t.useEffect)((()=>{const e=()=>{const e=window.location.hash.replace("#","");["1","2","3","4","5"].includes(e)&&l(e)};return e(),window.addEventListener("hashchange",e),()=>window.removeEventListener("hashchange",e)}),[]);const p=null===h||void 0===h||null===(e=h.user)||void 0===e||null===(a=e.roles)||void 0===a?void 0:a.includes("PICMobil");return(0,x.jsx)(x.Fragment,{children:(0,x.jsxs)(r.Ay,{value:n,children:[(0,x.jsx)(d.A,{className:"mb-1",children:(0,x.jsxs)(i.A,{onChange:(e,a)=>{l(a),window.location.hash="#".concat(a)},"aria-label":"lab API tabs example",vertical:"sm",variant:"scrollable",scrollButtons:"auto",children:[(0,x.jsx)(o.A,{label:(0,x.jsxs)(c.A,{badgeContent:0,anchorOrigin:{vertical:"top",horizontal:"right"},color:"primary",children:[(0,x.jsx)("strong",{children:"DASHBOARD"})," \xa0\xa0"]}),value:"1"}),(0,x.jsx)(o.A,{label:(0,x.jsxs)(c.A,{badgeContent:0,anchorOrigin:{vertical:"top",horizontal:"right"},color:"primary",children:[(0,x.jsx)("strong",{children:"BOOKING"})," \xa0\xa0"]}),value:"2"}),p&&(0,x.jsx)(o.A,{label:(0,x.jsxs)(c.A,{badgeContent:0,anchorOrigin:{vertical:"top",horizontal:"right"},color:"primary",children:[(0,x.jsx)("strong",{children:"PENGAMBILAN & PENGEMBALIAN"})," \xa0\xa0"]}),value:"3"}),p&&(0,x.jsx)(o.A,{label:(0,x.jsxs)(c.A,{badgeContent:0,anchorOrigin:{vertical:"top",horizontal:"right"},color:"primary",children:[(0,x.jsx)("strong",{children:"PENGISIAN BBM"})," \xa0\xa0"]}),value:"4"}),p&&(0,x.jsx)(o.A,{label:(0,x.jsxs)(c.A,{badgeContent:0,anchorOrigin:{vertical:"top",horizontal:"right"},color:"primary",children:[(0,x.jsx)("strong",{children:"SETTING"})," \xa0\xa0"]}),value:"5"})]})}),(0,x.jsxs)(s.A,{value:"1",className:"ps-0 pe-0",children:[(0,x.jsx)(d.A,{className:"mt-4",children:(0,x.jsx)(u.A,{children:(0,x.jsx)(B,{})})}),(0,x.jsxs)(d.A,{className:"mt-4",children:[(0,x.jsx)(m.A,{children:(0,x.jsx)("strong",{children:"Mobil Operasional yang Tersedia"})}),(0,x.jsx)(u.A,{children:(0,x.jsx)(P,{})})]}),(0,x.jsxs)(d.A,{children:[(0,x.jsx)(m.A,{children:(0,x.jsx)("strong",{children:"Daftar Penggunaan Mobil"})}),(0,x.jsx)(u.A,{className:"px-4",children:(0,x.jsx)(j,{})})]})]}),(0,x.jsx)(s.A,{value:"2",className:"ps-0 pe-0",children:(0,x.jsx)(W,{})}),p&&(0,x.jsx)(s.A,{value:"3",className:"ps-0 pe-0",children:(0,x.jsx)(Q,{})}),p&&(0,x.jsx)(s.A,{value:"4",className:"ps-0 pe-0",children:(0,x.jsx)(re,{})}),p&&(0,x.jsx)(s.A,{value:"5",className:"ps-0 pe-0",children:(0,x.jsx)(se,{})})]})})},ce=()=>(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)(l.A,{}),(0,x.jsx)(oe,{})]})}}]);
//# sourceMappingURL=5604.45678440.chunk.js.map