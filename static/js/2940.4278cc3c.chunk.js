"use strict";(self.webpackChunkmaterialpro_main=self.webpackChunkmaterialpro_main||[]).push([[2940],{82959:(e,n,a)=>{a.d(n,{x:()=>r,y:()=>l});a(65043);var t=a(23768),s=a(70579);const l=()=>(0,s.jsx)(t.l$,{toastOptions:{className:"",style:{}}}),r=(e,n)=>{((e,n)=>{"success"===e?t.Ay.success(n):"create"===e?(0,t.Ay)(n,{icon:"\ud83e\udd17"}):"start"===e?(0,t.Ay)("Lets get started, cheer up!",{icon:"\ud83d\udcaa"}):"done"===e?(0,t.Ay)("Horeee, task done!",{icon:"\ud83d\udc4f"}):t.Ay.error(n)})(e,n)}},77199:(e,n,a)=>{a.d(n,{A:()=>d});var t=a(55510),s=a(28249),l=a(73216),r=a(35475),i=a(70579);const d=()=>{const e=(0,l.zy)(),n=e.pathname.split("/")[1],a=e.pathname.split("/")[2];return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("h4",{className:"text-capitalize",children:"".concat(a||n)}),(0,i.jsxs)(t.A,{children:[(0,i.jsx)(s.A,{to:"/",tag:r.N_,className:"text-decoration-none",children:"Home"}),n?(0,i.jsx)(s.A,{active:!0,children:n}):"",a?(0,i.jsx)(s.A,{active:!0,children:a}):""]})]})}},60375:(e,n,a)=>{a.r(n),a.d(n,{default:()=>$});var t=a(65043),s=a(73216),l=a(49157),r=a(22016),i=a(15710),d=a(86506),o=a(24056),c=a(93933),m=a(203),u=a(59781),h=a(93397),j=a(77199),x=a(18353),p=a(12327),g=a(22345),b=a(88511),y=a(98606),v=a(15337),N=a(70579);const f=e=>{let{color:n,icon:a,title:t,count:s}=e;return(0,N.jsx)(l.A,{className:"shadow-sm border-0",style:{borderLeft:"5px solid ".concat(n)},children:(0,N.jsxs)(x.A,{className:"d-flex align-items-center",children:[(0,N.jsx)("div",{style:{fontSize:"2rem",color:n,marginRight:"1rem"},children:a}),(0,N.jsxs)("div",{children:[(0,N.jsx)("h6",{className:"mb-1 text-muted",children:t}),(0,N.jsx)("h3",{className:"mb-0",children:s})]})]})})},A=e=>{let{diproses:n,selesai:a,totalPengajuan:t}=e;return(0,N.jsx)("div",{children:(0,N.jsxs)(p.A,{children:[(0,N.jsx)(g.A,{md:"4",sm:"12",className:"mb-3",children:(0,N.jsx)(f,{color:"#f0ad4e",icon:(0,N.jsx)(b.A,{fontSize:"inherit"}),title:"Pengajuan Diproses",count:(0===n?"0":n)||"loading..."})}),(0,N.jsx)(g.A,{md:"4",sm:"12",className:"mb-3",children:(0,N.jsx)(f,{color:"#5cb85c",icon:(0,N.jsx)(y.A,{fontSize:"inherit"}),title:"Pengajuan Selesai",count:(0===a?"0":a)||"loading..."})}),(0,N.jsx)(g.A,{md:"4",sm:"12",className:"mb-3",children:(0,N.jsx)(f,{color:"#d9534f",icon:(0,N.jsx)(v.A,{fontSize:"inherit"}),title:"Total Pengajuan",count:(0===t?"0":t)||"loading..."})})]})})};var w=a(89379),_=a(3655),D=a(26259),S=a(7493),k=a(87426),P=a(23222),I=a(10591),B=a(20782),L=a(98268),C=a(64911),F=a(97877),J=a(55918),R=a.n(J),T=a(58786),z=a(24858),q=a(82959);const E=()=>{const e=(0,h.A)(),[n,a]=(0,t.useState)(!1),[s,r]=(0,t.useState)(!1),[i,d]=(0,t.useState)(""),[o,c]=(0,t.useState)([]),[u,j]=(0,t.useState)(!1),[b,y]=(0,t.useState)(!1),[v,f]=(0,t.useState)(null),[A,J]=(0,t.useState)(null),[E,K]=(0,t.useState)(!1),{register:U,handleSubmit:O,reset:M,control:H,setValue:G,formState:{errors:V}}=(0,z.mN)({defaultValues:{items:[{itemName:"",quantity:"",unit:"",price:"",description:""}]}}),{fields:Q,append:$,remove:W}=(0,z.jz)({control:H,name:"items"}),{data:X,isLoading:Y,error:Z,refetch:ee}=(0,m.I)({queryKey:["pengajuan-list"],queryFn:()=>e.get("api/pengajuan").then((e=>(console.log(e),e.data.data)))});(0,t.useEffect)((()=>{c(X||[])}),[X]),(0,t.useEffect)((()=>{c(i?null===X||void 0===X?void 0:X.filter((e=>e.sub_pengajuan[0].nama_item.toLowerCase().includes(i.toLowerCase()))):X)}),[i]);const ne=()=>{M(),K(!1),a(!1)},ae=[{name:"Aksi",selector:n=>{var t;return(0,N.jsxs)(N.Fragment,{children:[(0,N.jsx)(D.A,{color:"danger",outline:!0,size:"sm",className:"me-2",onClick:()=>(e=>{K(!0),a(!0),G("id",e.id),G("jenis_permohonan",e.pengajuan),G("documentNumber",e.no_dokumen),W(),e.sub_pengajuan&&e.sub_pengajuan.length>0&&e.sub_pengajuan.forEach((e=>{$({itemName:e.nama_item,quantity:e.jumlah,unit:e.satuan,price:e.biaya_satuan,description:e.keterangan})}))})(n),disabled:!(null!==n&&void 0!==n&&null!==(t=n.approvals)&&void 0!==t&&t.every((e=>{var a;return null===e.status||(null===n||void 0===n||null===(a=n.approvals)||void 0===a?void 0:a.some((e=>"0"===e.status)))}))),children:"Update"}),(0,N.jsx)(D.A,{color:"secondary",outline:!0,size:"sm",className:"me-2",onClick:()=>(async n=>{await e.get("api/pengajuan/".concat(n.id,"/show")).then((e=>{console.log("res",e),J(e.data.data),j(!0)})).catch((e=>{console.log(e),(0,q.x)("error","Terjadi Kesalahan")}))})(n),children:"Approval"}),(0,N.jsx)(D.A,{outline:!0,size:"sm",color:"info",onClick:()=>(n=>{f({row:n,title:"Detail Pengajuan",body:(0,N.jsxs)(N.Fragment,{children:[(0,N.jsxs)(p.A,{children:[(0,N.jsxs)(g.A,{md:6,children:[(0,N.jsx)("p",{className:"fw-bold",children:"Jenis Permohonan : "}),(0,N.jsx)("p",{children:n.pengajuan})]}),(0,N.jsxs)(g.A,{md:6,children:[(0,N.jsx)("p",{className:"fw-bold",children:"No Dokumen : "}),(0,N.jsx)("p",{children:n.no_dokumen})]})]}),(0,N.jsxs)(p.A,{children:[(0,N.jsxs)(g.A,{md:6,children:[(0,N.jsx)("p",{className:"fw-bold",children:"Tanggal Pengajuan : "}),(0,N.jsx)("p",{children:new Date(n.created_at).toLocaleDateString("id-ID",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"})})]}),(0,N.jsxs)(g.A,{md:6,children:[(0,N.jsx)("p",{className:"fw-bold",children:"Lampiran : "}),(0,N.jsx)("p",{children:(0,N.jsx)("a",{href:"".concat(e.defaults.baseURL,"/pengajuan/").concat(n.lampiran),target:"_blank",rel:"noopener noreferrer",className:"btn btn-info btn-sm",children:"Lihat Lampiran"})})]})]}),(0,N.jsx)(p.A,{children:(0,N.jsx)(g.A,{children:(0,N.jsx)("div",{className:"table-responsive",children:(0,N.jsxs)(_.A,{bordered:!0,responsive:!0,hover:!0,children:[(0,N.jsx)("thead",{children:(0,N.jsxs)("tr",{children:[(0,N.jsx)("th",{className:"text-center",style:{width:"50px"},children:"No"}),(0,N.jsx)("th",{children:"Nama Barang/Jasa"}),(0,N.jsx)("th",{children:"Jumlah"}),(0,N.jsx)("th",{children:"Satuan"}),(0,N.jsx)("th",{children:"Biaya Satuan"}),(0,N.jsx)("th",{children:"Total Biaya"}),(0,N.jsx)("th",{children:"Keterangan"})]})}),(0,N.jsxs)("tbody",{children:[n.sub_pengajuan.map(((e,n)=>(0,N.jsxs)("tr",{children:[(0,N.jsx)("td",{className:"text-center",children:n+1}),(0,N.jsx)("td",{children:e.nama_item}),(0,N.jsx)("td",{children:e.jumlah}),(0,N.jsx)("td",{children:e.satuan}),(0,N.jsx)("td",{children:new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR"}).format(e.biaya_satuan)}),(0,N.jsx)("td",{children:new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR"}).format(e.total_biaya)}),(0,N.jsx)("td",{children:e.keterangan||"-"})]},e.id))),(0,N.jsxs)("tr",{children:[(0,N.jsx)("td",{colSpan:5,className:"text-end fw-bold",children:"Total Biaya Keseluruhan"}),(0,N.jsx)("td",{colSpan:2,children:new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR"}).format(n.sub_pengajuan.reduce(((e,n)=>e+n.total_biaya),0))})]})]})]})})})})]})}),y(!0)})(n),children:"Detail"})]})},width:"300px"},{name:"Status",selector:e=>{var n,a;return(0,N.jsx)(N.Fragment,{children:null!==e&&void 0!==e&&null!==(n=e.approvals)&&void 0!==n&&n.every((e=>"1"===e.status))?(0,N.jsx)("span",{className:"badge bg-success rounded-pill",children:"Approved"}):null!==e&&void 0!==e&&null!==(a=e.approvals)&&void 0!==a&&a.some((e=>"0"===e.status))?(0,N.jsx)("span",{className:"badge bg-danger rounded-pill",children:"Rejected"}):(0,N.jsx)("span",{className:"badge bg-secondary rounded-pill",children:"Pending"})})}},{name:"Tanggal Pengajuan",selector:e=>new Date(e.created_at).toLocaleDateString("id-ID",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}),width:"200px"},{name:"Jenis Permohonan",selector:e=>e.pengajuan},{name:"No Dokumen",selector:e=>e.no_dokumen,width:"200px"},{name:"Nama Barang/Jasa",selector:e=>e.sub_pengajuan[0].nama_item},{name:"Jumlah Barang/Jasa",selector:e=>e.sub_pengajuan[0].jumlah},{name:"Satuan",selector:e=>e.sub_pengajuan[0].satuan},{name:"Biaya Satuan",selector:e=>(0,N.jsx)("div",{children:new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR"}).format(e.sub_pengajuan[0].biaya_satuan)})}];return(0,N.jsxs)(N.Fragment,{children:[(0,N.jsx)(l.A,{children:(0,N.jsxs)(x.A,{children:[!n&&(0,N.jsx)("div",{className:"d-grid gap-2",children:(0,N.jsx)(D.A,{size:"lg",color:"primary",onClick:async e=>{e.preventDefault(),a(!0)},children:"Tambah Permohonan"})}),n&&(0,N.jsxs)(N.Fragment,{children:[(0,N.jsx)("div",{className:"d-flex justify-content-end mb-3",children:(0,N.jsx)(R(),{icon:"close",onClick:ne,style:{cursor:"pointer"}})}),(0,N.jsxs)("form",{onSubmit:O(E?async n=>{console.log("Data Submit",n),r(!0);const a=new FormData;a.append("id",n.id),a.append("jenis_permohonan",n.jenis_permohonan),a.append("no_dokumen",n.documentNumber),n.file&&n.file[0]&&a.append("lampiran",n.file[0]),a.append("items",JSON.stringify(n.items)),await e.post("api/pengajuan/".concat(n.id,"/update"),a).then((e=>{ee(),console.log(e),r(!1),ne(),M(),(0,q.x)("success","Pengajuan Berhasil Diupdate")})).catch((e=>{console.log(e),r(!1),(0,q.x)("error","Terjadi Kesalahan")}))}:async n=>{console.log("Data Submit",n),r(!0);const a=new FormData;a.append("jenis_permohonan",n.jenis_permohonan),a.append("no_dokumen",n.documentNumber),a.append("lampiran",n.file[0]),a.append("items",JSON.stringify(n.items)),await e.post("api/pengajuan",a).then((e=>{console.log("res",e),r(!1),ee(),ne(),M(),(0,q.x)("success","Pengajuan Berhasil Ditambahkan")})).catch((e=>{console.log(e),r(!1),(0,q.x)("error","Terjadi Kesalahan")}))}),children:[E&&(0,N.jsx)("input",(0,w.A)((0,w.A)({type:"hidden"},U("id")),{},{required:!0})),(0,N.jsxs)("div",{className:"row",children:[(0,N.jsx)("div",{className:"col-md-6",children:(0,N.jsxs)("div",{className:"mb-3",children:[(0,N.jsx)(S.A,{children:"Jenis Permohonan"}),(0,N.jsxs)("select",(0,w.A)((0,w.A)({className:"form-control ".concat(V.jenis_permohonan?"is-invalid":"")},U("jenis_permohonan",{required:"Jenis Permohonan wajib diisi",onChange:e=>{return n=e.target.value,void G("documentNumber","Permohonan Biaya"===n?"FPR-UM-PEMA-01-04":"Reimbursement"===n?"FPR-UM-PEMA-01-02":"Tagihan Biaya"===n?"FPR-UM-PEMA-01-03":"Aktual Biaya"===n?"FPR-UM-PEMA-04-02":"");var n}})),{},{children:[(0,N.jsx)("option",{value:"",children:"Pilih Permohonan"}),(0,N.jsx)("option",{value:"Permohonan Biaya",children:"Permohonan Biaya"}),(0,N.jsx)("option",{value:"Reimbursement",children:"Reimbursement"}),(0,N.jsx)("option",{value:"Tagihan Biaya",children:"Tagihan Biaya"}),(0,N.jsx)("option",{value:"Aktual Biaya",children:"Aktual Biaya"})]})),V.jenis_permohonan&&(0,N.jsx)("div",{className:"invalid-feedback",children:V.jenis_permohonan.message})]})}),(0,N.jsx)("div",{className:"col-md-6",children:(0,N.jsxs)("div",{className:"mb-3",children:[(0,N.jsx)(S.A,{children:"No Dokumen"}),(0,N.jsx)("input",(0,w.A)({type:"text",className:"form-control ".concat(V.documentNumber?"is-invalid":""),placeholder:"No Dokumen"},U("documentNumber",{required:"No Dokumen wajib diisi"}))),V.documentNumber&&(0,N.jsx)("div",{className:"invalid-feedback",children:V.documentNumber.message})]})})]}),(0,N.jsx)("div",{className:"row",children:(0,N.jsx)("div",{className:"col-md-12",children:(0,N.jsxs)("div",{className:"mb-3",children:[(0,N.jsx)(S.A,{children:"Lampiran"}),(0,N.jsx)("input",(0,w.A)({type:"file",accept:".pdf",className:"form-control ".concat(V.file?"is-invalid":""),placeholder:"Lampiran"},U("file",{required:!E&&"Lampiran wajib diisi"}))),(0,N.jsx)("span",{className:"text-primary",children:"Hanya menerima file PDF"}),V.file&&(0,N.jsx)("div",{className:"invalid-feedback",children:V.file.message})]})})}),(0,N.jsx)("div",{className:"row",children:(0,N.jsx)("div",{className:"col-md-12",children:(0,N.jsxs)("div",{className:"table-responsive",children:[(0,N.jsxs)("table",{className:"table table-bordered",children:[(0,N.jsx)("thead",{children:(0,N.jsxs)("tr",{children:[(0,N.jsx)("th",{children:"Nama Barang/Jasa"}),(0,N.jsx)("th",{children:"Jumlah"}),(0,N.jsx)("th",{children:"Satuan"}),(0,N.jsx)("th",{children:"Harga Satuan"}),(0,N.jsx)("th",{children:"Keterangan"}),(0,N.jsx)("th",{children:"Aksi"})]})}),(0,N.jsx)("tbody",{children:Q.map(((e,n)=>{var a,t,s,l,r,i,d,o,c,m,u,h,j,x,p,g;return(0,N.jsxs)("tr",{children:[(0,N.jsxs)("td",{children:[(0,N.jsx)("textarea",(0,w.A)({className:"form-control ".concat(null!==(a=V.items)&&void 0!==a&&null!==(t=a[n])&&void 0!==t&&t.itemName?"is-invalid":""),placeholder:"Nama Barang/Jasa"},U("items.".concat(n,".itemName"),{required:"Nama Barang/Jasa wajib diisi"}))),(null===(s=V.items)||void 0===s||null===(l=s[n])||void 0===l?void 0:l.itemName)&&(0,N.jsx)("div",{className:"invalid-feedback",children:V.items[n].itemName.message})]}),(0,N.jsxs)("td",{children:[(0,N.jsx)("input",(0,w.A)({type:"number",className:"form-control ".concat(null!==(r=V.items)&&void 0!==r&&null!==(i=r[n])&&void 0!==i&&i.quantity?"is-invalid":""),placeholder:"Jumlah"},U("items.".concat(n,".quantity"),{required:"Jumlah wajib diisi"}))),(null===(d=V.items)||void 0===d||null===(o=d[n])||void 0===o?void 0:o.quantity)&&(0,N.jsx)("div",{className:"invalid-feedback",children:V.items[n].quantity.message})]}),(0,N.jsxs)("td",{children:[(0,N.jsx)("input",(0,w.A)({type:"text",className:"form-control ".concat(null!==(c=V.items)&&void 0!==c&&null!==(m=c[n])&&void 0!==m&&m.unit?"is-invalid":""),placeholder:"Paket/Bulan/Kg/Unit, dll"},U("items.".concat(n,".unit"),{required:"Satuan wajib diisi"}))),(null===(u=V.items)||void 0===u||null===(h=u[n])||void 0===h?void 0:h.unit)&&(0,N.jsx)("div",{className:"invalid-feedback",children:V.items[n].unit.message})]}),(0,N.jsxs)("td",{children:[(0,N.jsx)("input",(0,w.A)({type:"number",className:"form-control ".concat(null!==(j=V.items)&&void 0!==j&&null!==(x=j[n])&&void 0!==x&&x.price?"is-invalid":""),placeholder:"Harga Satuan"},U("items.".concat(n,".price"),{required:"Harga Satuan wajib diisi"}))),(null===(p=V.items)||void 0===p||null===(g=p[n])||void 0===g?void 0:g.price)&&(0,N.jsx)("div",{className:"invalid-feedback",children:V.items[n].price.message})]}),(0,N.jsx)("td",{children:(0,N.jsx)("textarea",(0,w.A)({className:"form-control",placeholder:"Keterangan"},U("items.".concat(n,".description"))))}),(0,N.jsx)("td",{children:n>0&&(0,N.jsx)("button",{type:"button",className:"btn btn-danger",onClick:()=>W(n),children:(0,N.jsx)(R(),{icon:"delete",fontSize:"17"})})})]},e.id)}))})]}),(0,N.jsx)("button",{type:"button",className:"btn btn-primary",onClick:()=>$({itemName:"",quantity:"",unit:"",price:"",description:""}),children:"Tambah Barang/Jasa"})]})})}),(0,N.jsx)("div",{className:"d-flex justify-content-end mb-3",children:(0,N.jsx)("button",{type:"submit",className:"btn btn-primary",disabled:s,children:s?(0,N.jsxs)(N.Fragment,{children:[(0,N.jsx)(k.A,{color:"light",size:"sm",className:"me-1"})," Loading"]}):(0,N.jsx)(N.Fragment,{children:E?"Update":"Submit"})})})]})]})]})}),!n&&(0,N.jsx)(l.A,{children:(0,N.jsxs)(x.A,{children:[(0,N.jsx)("div",{className:"mb-3 d-flex align-items-center justify-content-end",children:(0,N.jsx)("input",{type:"text",className:"form-control w-25",placeholder:"Cari...",value:i,onChange:e=>d(e.target.value)})}),Y?(0,N.jsxs)("div",{className:"text-center",children:[(0,N.jsx)(k.A,{color:"primary",size:"sm",className:"me-2"})," Sedang Mengambil Data"]}):Z?(0,N.jsx)("div",{className:"text-center",children:(0,N.jsx)("span",{className:"text-danger",children:"Something went wrong"})}):(0,N.jsx)(T.Ay,{columns:ae,data:o,pagination:!0,highlightOnHover:!0,responsive:!0,striped:!0})]})}),(0,N.jsxs)(P.A,{isOpen:u,toggle:()=>j(!u),children:[(0,N.jsx)(I.A,{toggle:()=>j(!u),children:"Approval Pengajuan"}),(0,N.jsx)(B.A,{children:A&&(0,N.jsx)(L.A,{flush:!0,children:A.map(((e,n)=>(0,N.jsxs)(C.A,{className:"d-flex justify-content-between align-items-start flex-column",children:[(0,N.jsxs)("div",{className:"w-100 d-flex justify-content-between align-items-center",children:[(0,N.jsxs)("div",{children:[(0,N.jsxs)("h6",{className:"mb-1",children:[(0,N.jsxs)("strong",{children:[n+1,"."]})," ",e.employe_id," - ",e.full_name]}),(0,N.jsx)("small",{className:"text-muted",children:e.position_name})]}),"1"===(null===e||void 0===e?void 0:e.status)?(0,N.jsxs)("div",{className:"d-flex flex-column align-items-end",children:[(0,N.jsx)("span",{className:"badge bg-success rounded-pill",children:"Approved"}),(0,N.jsx)("small",{className:"text-muted",children:new Date(null===e||void 0===e?void 0:e.updated_at).toLocaleString("id-ID",{day:"numeric",month:"long",year:"numeric",hour:"2-digit",minute:"2-digit"})})]}):"0"===(null===e||void 0===e?void 0:e.status)?(0,N.jsxs)("div",{className:"d-flex flex-column align-items-end",children:[(0,N.jsx)("span",{className:"badge bg-danger rounded-pill",children:"Rejected"}),(0,N.jsx)("small",{className:"text-muted",children:new Date(null===e||void 0===e?void 0:e.updated_at).toLocaleString("id-ID",{day:"numeric",month:"long",year:"numeric",hour:"2-digit",minute:"2-digit"})})]}):(0,N.jsx)("div",{className:"d-flex flex-column align-items-end",children:(0,N.jsx)("span",{className:"badge bg-secondary rounded-pill",children:"Pending"})})]}),"0"===(null===e||void 0===e?void 0:e.status)&&(null===e||void 0===e?void 0:e.keterangan)&&(0,N.jsx)("div",{className:"mt-2 w-100",children:(0,N.jsxs)("small",{children:[(0,N.jsx)("strong",{children:"Alasan Penolakan:"})," ",(0,N.jsx)("br",{}),e.keterangan]})})]})))})}),(0,N.jsx)(F.A,{children:(0,N.jsx)(D.A,{color:"secondary",onClick:()=>j(!1),children:"Tutup"})})]}),(0,N.jsxs)(P.A,{isOpen:b,toggle:()=>y(!b),size:"xl",children:[(0,N.jsx)(I.A,{toggle:()=>y(!b),children:"Detail Pengajuan"}),(0,N.jsx)(B.A,{children:null===v||void 0===v?void 0:v.body}),(0,N.jsx)(F.A,{children:(0,N.jsx)(D.A,{color:"secondary",onClick:()=>y(!1),children:"Tutup"})})]})]})};a(94727);const K=e=>{let{setBadgeCount:n}=e;const a=(0,h.A)(),[s,r]=(0,t.useState)([]),[i,d]=(0,t.useState)(!1),[o,c]=(0,t.useState)(null),[j,b]=(0,t.useState)(!1),[y,v]=(0,t.useState)(!1),[f,A]=(0,t.useState)(""),[w,L]=(0,t.useState)(!1),[C,J]=(0,t.useState)(""),R=(0,u.jE)(),z=()=>{d(!i),A(""),L(!1)},{data:E,isLoading:K,error:U,refetch:O}=(0,m.I)({queryKey:["approval-pengajuan-all"],queryFn:()=>a.get("api/pengajuan-approval").then((e=>e.data.data))});(0,t.useEffect)((()=>{r(E||[]),E&&(n(E.length),R.invalidateQueries(["dashboard-pengajuan"]))}),[E,n]),(0,t.useEffect)((()=>{r(C?null===E||void 0===E?void 0:E.filter((e=>e.sub_pengajuan[0].nama_item.toLowerCase().includes(C.toLowerCase()))):E)}),[C]);const M=[{name:"Aksi",selector:e=>(0,N.jsx)(D.A,{color:"primary",outline:!0,size:"sm",className:"me-2",onClick:()=>(e=>{c({row:e,title:"Detail Pengajuan",body:(0,N.jsxs)(N.Fragment,{children:[(0,N.jsxs)(p.A,{children:[(0,N.jsxs)(g.A,{md:6,children:[(0,N.jsx)("p",{className:"fw-bold",children:"Jenis Permohonan : "}),(0,N.jsx)("p",{children:e.pengajuan})]}),(0,N.jsxs)(g.A,{md:6,children:[(0,N.jsx)("p",{className:"fw-bold",children:"No Dokumen : "}),(0,N.jsx)("p",{children:e.no_dokumen})]})]}),(0,N.jsxs)(p.A,{children:[(0,N.jsxs)(g.A,{md:6,children:[(0,N.jsx)("p",{className:"fw-bold",children:"Tanggal Pengajuan : "}),(0,N.jsx)("p",{children:new Date(e.created_at).toLocaleDateString("id-ID",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"})})]}),(0,N.jsxs)(g.A,{md:6,children:[(0,N.jsx)("p",{className:"fw-bold",children:"Lampiran : "}),(0,N.jsx)("p",{children:(0,N.jsx)("a",{href:"".concat(a.defaults.baseURL,"/pengajuan/").concat(e.lampiran),target:"_blank",rel:"noopener noreferrer",className:"btn btn-info btn-sm",children:"Lihat Lampiran"})})]})]}),(0,N.jsx)(p.A,{children:(0,N.jsx)(g.A,{children:(0,N.jsx)("div",{className:"table-responsive",children:(0,N.jsxs)(_.A,{bordered:!0,responsive:!0,hover:!0,children:[(0,N.jsx)("thead",{children:(0,N.jsxs)("tr",{children:[(0,N.jsx)("th",{className:"text-center",style:{width:"50px"},children:"No"}),(0,N.jsx)("th",{children:"Nama Barang/Jasa"}),(0,N.jsx)("th",{children:"Jumlah"}),(0,N.jsx)("th",{children:"Satuan"}),(0,N.jsx)("th",{children:"Biaya Satuan"}),(0,N.jsx)("th",{children:"Total Biaya"}),(0,N.jsx)("th",{children:"Keterangan"})]})}),(0,N.jsxs)("tbody",{children:[e.sub_pengajuan.map(((e,n)=>(0,N.jsxs)("tr",{children:[(0,N.jsx)("td",{className:"text-center",children:n+1}),(0,N.jsx)("td",{children:e.nama_item}),(0,N.jsx)("td",{children:e.jumlah}),(0,N.jsx)("td",{children:e.satuan}),(0,N.jsx)("td",{children:new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR"}).format(e.biaya_satuan)}),(0,N.jsx)("td",{children:new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR"}).format(e.total_biaya)}),(0,N.jsx)("td",{children:e.keterangan||"-"})]},e.id))),(0,N.jsxs)("tr",{children:[(0,N.jsx)("td",{colSpan:5,className:"text-end fw-bold",children:"Total Biaya Keseluruhan"}),(0,N.jsx)("td",{colSpan:2,children:new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR"}).format(e.sub_pengajuan.reduce(((e,n)=>e+n.total_biaya),0))})]})]})]})})})})]})}),d(!0)})(e),children:"Pending Approval"}),width:"200px"},{name:"Tanggal Pengajuan",selector:e=>new Date(e.created_at).toLocaleDateString("id-ID",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}),width:"200px"},{name:"Jenis Permohonan",selector:e=>e.pengajuan,width:"250px"},{name:"No Dokumen",selector:e=>e.no_dokumen,width:"200px"},{name:"Nama Barang/Jasa",selector:e=>e.sub_pengajuan[0].nama_item},{name:"Jumlah Barang/Jasa",selector:e=>e.sub_pengajuan[0].jumlah},{name:"Satuan",selector:e=>e.sub_pengajuan[0].satuan},{name:"Biaya Satuan",selector:e=>(0,N.jsx)("div",{children:new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR"}).format(e.sub_pengajuan[0].biaya_satuan)})}];return(0,N.jsxs)("div",{children:[(0,N.jsx)(l.A,{children:(0,N.jsxs)(x.A,{className:"p-4",children:[(0,N.jsx)("div",{className:"mb-3 d-flex align-items-center justify-content-end",children:(0,N.jsx)("input",{type:"text",className:"form-control w-25",placeholder:"Cari...",value:C,onChange:e=>J(e.target.value)})}),K?(0,N.jsxs)("div",{className:"d-flex justify-content-center",children:[(0,N.jsx)(k.A,{color:"primary",size:"sm",className:"me-2"})," Sedang Mengambil Data"]}):U?(0,N.jsx)("div",{className:"text-center",children:"Something went wrong"}):(0,N.jsx)(T.Ay,{columns:M,data:s,pagination:!0,highlightOnHover:!0})]})}),(0,N.jsxs)(P.A,{isOpen:i,toggle:z,size:"xl",children:[(0,N.jsx)(I.A,{toggle:z,children:(null===o||void 0===o?void 0:o.title)||"Detail"}),(0,N.jsxs)(B.A,{children:[null===o||void 0===o?void 0:o.body,w&&(0,N.jsxs)("div",{className:"mt-3",children:[(0,N.jsx)(S.A,{children:(0,N.jsx)("strong",{children:"Alasan Penolakan:"})}),(0,N.jsx)("textarea",{className:"form-control",rows:"3",value:f,onChange:e=>A(e.target.value),placeholder:"Masukkan alasan penolakan"})]})]}),(0,N.jsxs)(F.A,{children:[(0,N.jsx)(D.A,{color:"secondary",onClick:z,children:"Tutup"}),w?(0,N.jsx)(D.A,{color:"danger",onClick:async()=>{if(null===o||void 0===o||!o.row)return;if(!f.trim())return void(0,q.x)("error","Silakan isi alasan penolakan");v(!0);const e={id:o.row.id,status:"reject",alasan:f};try{await a.post("api/pengajuan-approval/reject",e),O(),d(!1),A(""),L(!1),(0,q.x)("success","Pengajuan Ditolak")}catch(n){console.error(n),(0,q.x)("error","Terjadi kesalahan")}finally{v(!1)}},disabled:y,children:y?(0,N.jsxs)(N.Fragment,{children:[(0,N.jsx)(k.A,{size:"sm",color:"light",className:"me-2"})," Loading"]}):"Submit Reject"}):(0,N.jsx)(D.A,{color:"danger",onClick:()=>L(!0),children:"Reject"}),(0,N.jsx)(D.A,{color:"primary",onClick:async()=>{if(null===o||void 0===o||!o.row)return;b(!0);const e={id:o.row.id,status:"approve"};try{await a.post("api/pengajuan-approval/approve",e),O(),d(!1),(0,q.x)("success","Pengajuan berhasil diapprove")}catch(n){console.error(n),(0,q.x)("error","Terjadi kesalahan")}finally{b(!1)}},disabled:j,children:j?(0,N.jsxs)(N.Fragment,{children:[(0,N.jsx)(k.A,{size:"sm",color:"light",className:"me-2"})," Loading"]}):"Approve"})]})]})]})};var U=a(54211),O=a.n(U),M=a(55360),H=a.n(M);const G=a(49784);G&&G.pdfMake?O().vfs=G.pdfMake.vfs:(console.error("Failed to load pdfmake fonts. Using default font as fallback."),O().vfs={});const V={Archivo:{normal:"Archivo-Regular.ttf",bold:"Archivo-SemiBold.ttf",italics:"Archivo-Italic.ttf",bolditalics:"Archivo-SemiBoldItalic.ttf"}},Q=()=>{const e=(0,h.A)(),[n,a]=(0,t.useState)([]),[s,r]=(0,t.useState)(""),[i,d]=(0,t.useState)(null),[o,c]=(0,t.useState)(!1),{data:u,isLoading:j,error:b}=(0,m.I)({queryKey:["pengajuanSelesai"],queryFn:()=>e.get("/api/pengajuan-selesai").then((e=>(console.log(e),e.data.data)))});(0,t.useEffect)((()=>{a(u||[])}),[u]),(0,t.useEffect)((()=>{a(s?null===u||void 0===u?void 0:u.filter((e=>e.sub_pengajuan[0].nama_item.toLowerCase().includes(s.toLowerCase()))):u)}),[s]);const y=n=>{var a;d({row:n,title:"Detail Pengajuan",body:(0,N.jsxs)(N.Fragment,{children:[(0,N.jsx)("div",{className:"d-flex justify-content-end",children:(0,N.jsx)(D.A,{color:"primary",onClick:()=>(n=>{O().vfs=G.pdfMake.vfs,O().fonts=V;const a='\n    <div>\n      <h3 style="text-align: center;">Detail Pengajuan</h3>\n      <div style="text-align: left;">\n      <table style="border: none; border-collapse: collapse; width: 100%;">\n        <tr>\n          <td style="border: none; padding: 4px;"><strong>Jenis Permohonan</strong></td>\n          <td style="border: none; padding: 4px;">: '.concat(n.pengajuan,'</td>\n        </tr>\n        <tr>\n          <td style="border: none; padding: 4px;"><strong>No Dokumen</strong></td>\n          <td style="border: none; padding: 4px;">: ').concat(n.no_dokumen,'</td>\n        </tr>\n        <tr>\n          <td style="border: none; padding: 4px;"><strong>Tanggal Pengajuan</strong></td>\n          <td style="border: none; padding: 4px;">\n            : ').concat(new Date(n.created_at).toLocaleDateString("id-ID",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}),'\n          </td>\n        </tr>\n        <tr>\n          <td style="border: none; padding: 4px;"><strong>Lampiran</strong></td>\n          <td style="border: none; padding: 4px;">\n            : <a href="').concat(e.defaults.baseURL,"/pengajuan/").concat(n.lampiran,'" target="_blank">').concat(e.defaults.baseURL,"/pengajuan/").concat(n.lampiran,'</a>\n          </td>\n        </tr>\n        <tr>\n          <td style="border: none; padding: 4px;"><strong>Diapprove oleh</strong></td>\n          <td style="border: none; padding: 4px;">:\n            <ol style="margin-left: 20px;">\n              ').concat(n.approvals.map((e=>'<li style="margin-bottom: 10px;">'.concat(e.full_name," (").concat(e.position_name,") <br/>Approved At: ").concat(new Date(e.updated_at).toLocaleDateString("id-ID",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}),"</li>"))).join(""),'\n            </ol>\n          </td>\n        </tr>\n        <tr>\n          <td style="border: none; padding: 4px;"><strong>Detail Pengajuan</strong></td>\n          <td style="border: none; padding: 4px;">:</td>\n        </tr>\n        <tr>\n          <td colspan="2" style="border: none; padding: 4px;">\n                  <table style="width: 100%; border-collapse: collapse;" border="1">\n                    <thead>\n                      <tr style="text-align: center;">\n                        <th>No</th>\n                        <th>Nama Barang/Jasa</th>\n                        <th>Jumlah</th>\n                        <th>Satuan</th>\n                        <th>Biaya Satuan</th>\n                        <th>Total Biaya</th>\n                        <th>Keterangan</th>\n                      </tr>\n                    </thead>\n                    <tbody>\n                      ').concat(n.sub_pengajuan.map(((e,n)=>"\n                        <tr>\n                          <td>".concat(n+1,"</td>\n                          <td>").concat(e.nama_item,"</td>\n                          <td>").concat(e.jumlah,"</td>\n                          <td>").concat(e.satuan,"</td>\n                          <td>").concat(new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR"}).format(e.biaya_satuan),"</td>\n                          <td>").concat(new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR"}).format(e.total_biaya),"</td>\n                          <td>").concat(e.keterangan||"-","</td>\n                        </tr>"))).join(""),'\n                      <tr>\n                        <td colspan="5" style="text-align: right;"><strong>Total Biaya Keseluruhan</strong></td>\n                        <td colspan="2">').concat(new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR"}).format(n.sub_pengajuan.reduce(((e,n)=>e+n.total_biaya),0)),"</td>\n                      </tr>\n                    </tbody>\n                  </table>\n          </td>\n        </tr>\n      </table>\n      </div>\n\n      </div>\n    "),t={content:[H()(a,{defaultStyles:{table:{margin:[0,5,0,15]},th:{bold:!0,fillColor:"#eeeeee"}}})],defaultStyle:{font:"Archivo"}};O().createPdf(t).open()})(n),children:"Print PDF"})}),(0,N.jsx)(p.A,{className:"mb-4",children:(0,N.jsx)("table",{style:{border:"none",borderCollapse:"collapse",marginLeft:"10px"},children:(0,N.jsxs)("tbody",{children:[(0,N.jsxs)("tr",{style:{border:"none"},children:[(0,N.jsx)("td",{style:{border:"none",width:"200px"},children:(0,N.jsx)("strong",{children:"Jenis Permohonan"})}),(0,N.jsx)("td",{style:{border:"none"},children:(0,N.jsxs)("td",{style:{border:"none"},children:[": ",n.pengajuan]})})]}),(0,N.jsxs)("tr",{style:{border:"none"},children:[(0,N.jsx)("td",{style:{border:"none",width:"200px"},children:(0,N.jsx)("strong",{children:"No Dokumen"})}),(0,N.jsx)("td",{style:{border:"none"},children:(0,N.jsxs)("td",{style:{border:"none"},children:[": ",n.no_dokumen]})})]}),(0,N.jsxs)("tr",{style:{border:"none"},children:[(0,N.jsx)("td",{style:{border:"none",width:"200px"},children:(0,N.jsx)("strong",{children:"Tanggal Pengajuan"})}),(0,N.jsx)("td",{style:{border:"none"},children:(0,N.jsxs)("td",{style:{border:"none"},children:[":"," ",new Date(n.created_at).toLocaleDateString("id-ID",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"})]})})]}),(0,N.jsxs)("tr",{style:{border:"none"},children:[(0,N.jsx)("td",{style:{border:"none",width:"200px"},children:(0,N.jsx)("strong",{children:"Diapprove oleh"})}),(0,N.jsx)("td",{style:{border:"none"},children:(0,N.jsx)("td",{style:{border:"none"},children:":"})})]})]})})}),(0,N.jsx)(p.A,{className:"mb-4",children:null===n||void 0===n||null===(a=n.approvals)||void 0===a?void 0:a.map((e=>(0,N.jsx)(g.A,{md:4,className:"mb-3",children:(0,N.jsxs)("div",{className:"shadow-sm p-3 bg-light rounded",children:[(0,N.jsx)("h5",{className:"mb-1",children:null===e||void 0===e?void 0:e.full_name}),(0,N.jsx)("p",{className:"mb-1 text-muted",children:e.position_name}),(0,N.jsxs)("small",{className:"text-muted",children:[(0,N.jsx)("strong",{children:"Approved At: "}),new Date(e.updated_at).toLocaleDateString("id-ID",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"})]})]})},e.id)))}),(0,N.jsx)(p.A,{children:(0,N.jsx)(g.A,{children:(0,N.jsx)("div",{className:"table-responsive",children:(0,N.jsxs)(_.A,{bordered:!0,responsive:!0,hover:!0,children:[(0,N.jsx)("thead",{className:"",children:(0,N.jsxs)("tr",{children:[(0,N.jsx)("th",{className:"text-center",style:{width:"50px"},children:"No"}),(0,N.jsx)("th",{children:"Nama Barang/Jasa"}),(0,N.jsx)("th",{children:"Jumlah"}),(0,N.jsx)("th",{children:"Satuan"}),(0,N.jsx)("th",{children:"Biaya Satuan"}),(0,N.jsx)("th",{children:"Total Biaya"}),(0,N.jsx)("th",{children:"Keterangan"})]})}),(0,N.jsxs)("tbody",{children:[n.sub_pengajuan.map(((e,n)=>(0,N.jsxs)("tr",{children:[(0,N.jsx)("td",{className:"text-center",children:n+1}),(0,N.jsx)("td",{children:e.nama_item}),(0,N.jsx)("td",{children:e.jumlah}),(0,N.jsx)("td",{children:e.satuan}),(0,N.jsx)("td",{children:new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR"}).format(e.biaya_satuan)}),(0,N.jsx)("td",{children:new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR"}).format(e.total_biaya)}),(0,N.jsx)("td",{children:e.keterangan||"-"})]},e.id))),(0,N.jsxs)("tr",{className:"fw-bold",children:[(0,N.jsx)("td",{colSpan:5,className:"text-end",children:"Total Biaya Keseluruhan"}),(0,N.jsx)("td",{colSpan:2,children:new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR"}).format(n.sub_pengajuan.reduce(((e,n)=>e+n.total_biaya),0))})]})]})]})})})})]})}),c(!0)},v=[{name:"No",selector:(e,n)=>n+1,width:"50px"},{name:"Aksi",selector:e=>(0,N.jsx)("div",{className:"d-flex justify-content-center",children:(0,N.jsx)(D.A,{outline:!0,color:"info",size:"sm",onClick:()=>y(e),children:"Detail"})})},{name:"Tanggal Pengajuan",selector:e=>new Date(e.created_at).toLocaleDateString("id-ID",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}),width:"200px"},{name:"Jenis Permohonan",selector:e=>e.pengajuan,width:"250px"},{name:"No Dokumen",selector:e=>e.no_dokumen,width:"200px"},{name:"Nama Barang/Jasa",selector:e=>e.sub_pengajuan[0].nama_item},{name:"Jumlah Barang/Jasa",selector:e=>e.sub_pengajuan[0].jumlah},{name:"Satuan",selector:e=>e.sub_pengajuan[0].satuan},{name:"Biaya Satuan",selector:e=>(0,N.jsx)("div",{children:new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR"}).format(e.sub_pengajuan[0].biaya_satuan)})}];return(0,N.jsxs)(N.Fragment,{children:[(0,N.jsx)(l.A,{children:(0,N.jsxs)(x.A,{children:[(0,N.jsx)("div",{className:"mb-3 d-flex align-items-center justify-content-end",children:(0,N.jsx)("input",{type:"text",className:"form-control w-25",placeholder:"Cari...",value:s,onChange:e=>r(e.target.value)})}),j?(0,N.jsxs)("div",{className:"d-flex justify-content-center",children:[(0,N.jsx)(k.A,{color:"primary",size:"sm",className:"me-2"})," Sedang Mengambil Data"]}):b?(0,N.jsx)("div",{className:"text-center",children:"Something went wrong"}):(0,N.jsx)(T.Ay,{columns:v,data:n,pagination:!0,highlightOnHover:!0})]})}),(0,N.jsxs)(P.A,{isOpen:o,toggle:()=>c(!o),size:"xl",children:[(0,N.jsx)(I.A,{toggle:()=>c(!o),children:"Detail Pengajuan"}),(0,N.jsx)(B.A,{children:null===i||void 0===i?void 0:i.body}),(0,N.jsx)(F.A,{children:(0,N.jsx)(D.A,{color:"secondary",onClick:()=>c(!1),children:"Tutup"})})]})]})},$=()=>{const e=(0,h.A)(),n=(0,s.zy)(),[a,x]=(0,t.useState)([]),{data:p}=(0,m.I)(["dashboard-pengajuan"],(()=>e.get("/api/pengajuan-dashboard").then((e=>e.data.data))));(0,t.useEffect)((()=>{p&&x(p)}),[p]);const g=JSON.parse(localStorage.getItem("auth")),b=(0,u.jE)(),[y,v]=(0,t.useState)("1"),[f,w]=(0,t.useState)(0);(0,t.useEffect)((()=>{b.invalidateQueries(["approval-pengajuan-all"])}),[]);return(0,t.useEffect)((()=>{"approval"===new URLSearchParams(n.search).get("tab")&&v("3")}),[n]),(0,N.jsxs)("div",{children:[(0,N.jsx)(j.A,{}),(0,N.jsxs)(r.Ay,{value:y,children:[(0,N.jsx)(l.A,{className:"mb-1",children:(0,N.jsxs)(i.A,{onChange:(e,n)=>{v(n)},vertical:"sm",variant:"scrollable",scrollButtons:"auto",children:[(0,N.jsx)(o.A,{label:(0,N.jsxs)(c.A,{badgeContent:0,anchorOrigin:{vertical:"top",horizontal:"right"},color:"primary",children:[(0,N.jsx)("strong",{children:"DASHBOARD"})," \xa0\xa0"]}),value:"1"}),(null===g||void 0===g?void 0:g.user.roles.includes("AdminPengajuan"))&&(0,N.jsx)(o.A,{label:(0,N.jsxs)(c.A,{badgeContent:0,anchorOrigin:{vertical:"top",horizontal:"right"},color:"primary ",children:[(0,N.jsx)("strong",{children:"PENGAJUAN"})," \xa0\xa0"]}),value:"2"}),((null===g||void 0===g?void 0:g.user.roles.includes("ManagerUmum"))||(null===g||void 0===g?void 0:g.user.roles.includes("DirekturUmumKeuangan"))||(null===g||void 0===g?void 0:g.user.roles.includes("Presdir")))&&(0,N.jsx)(o.A,{label:(0,N.jsxs)(c.A,{badgeContent:(f>99?"99+":f)||((null===a||void 0===a?void 0:a.total_pengajuan_belum_selesai)>99?"99+":null===a||void 0===a?void 0:a.total_pengajuan_belum_selesai),anchorOrigin:{vertical:"top",horizontal:"right"},color:"warning",style:{textTransform:"capitalize"},children:[(0,N.jsx)("strong",{children:"APPROVAL PENGAJUAN"})," \xa0\xa0"]}),value:"3"}),(0,N.jsx)(o.A,{label:(0,N.jsxs)(c.A,{badgeContent:0,anchorOrigin:{vertical:"top",horizontal:"right"},color:"primary",children:[(0,N.jsx)("strong",{children:"PENGAJUAN SELESAI"})," \xa0\xa0"]}),value:"4"})]})}),(0,N.jsx)(d.A,{value:"1",className:"ps-0 pe-0",children:(0,N.jsx)(A,{diproses:null===a||void 0===a?void 0:a.total_pengajuan_belum_selesai,selesai:null===a||void 0===a?void 0:a.total_pengajuan_selesai,totalPengajuan:null===a||void 0===a?void 0:a.total_pengajuan})}),(0,N.jsx)(d.A,{value:"2",className:"ps-0 pe-0",children:(0,N.jsx)(E,{})}),(0,N.jsx)(d.A,{value:"3",className:"ps-0 pe-0",children:(0,N.jsx)(K,{setBadgeCount:w})}),(0,N.jsxs)(d.A,{value:"4",className:"ps-0 pe-0",children:[(0,N.jsx)(Q,{})," "]})]})]})}}}]);
//# sourceMappingURL=2940.4278cc3c.chunk.js.map