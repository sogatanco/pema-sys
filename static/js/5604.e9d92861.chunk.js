"use strict";(self.webpackChunkmaterialpro_main=self.webpackChunkmaterialpro_main||[]).push([[5604],{96447:(e,a,t)=>{t.r(a),t.d(a,{default:()=>de});var n=t(65043),l=t(77348),i=t(22016),r=t(15710),s=t(86506),o=t(24056),d=t(93933),c=t(49157),u=t(18353),m=t(55080),h=t(65113),p=t(86178),g=t.n(p),x=(t(63578),t(93397)),b=t(70579);const j=()=>{g().locale("id");const e=(0,x.A)(),[a,t]=(0,n.useState)([]),[l,i]=(0,n.useState)([]);return(0,n.useEffect)((()=>{e.get("dapi/mobil/get").then((a=>{if(a.data.success){const n=a.data.data.map((e=>({id:e.id,title:"".concat(e.brand," ").concat(e.plat)})));t(n),console.log("Available cars:",n),e.get("dapi/mobil/pengambilan-calendar").then((e=>{if(e.data.success){const a={};n.forEach((e=>{a[e.title]=e.id}));const t=e.data.data.map(((e,t)=>{let n=e.group||e.group_id;if(!n&&e.brand&&e.plat){const t="".concat(e.brand," ").concat(e.plat);n=a[t]||1}return{id:e.id||t+1,group:n||1,title:e.title||e.user||"-",start_time:g()(e.start_time),end_time:g()(e.end_time),bgColor:e.bgColor||"rgba(225, 166, 244, 0.6)"}}));i(t),console.log("Pengambilan calendar:",t)}})).catch((e=>{console.error("Error fetching pengambilan calendar:",e)}))}})).catch((e=>{console.error("Error fetching available cars:",e)}))}),[]),(0,b.jsx)("div",{children:(0,b.jsx)(h.Ay,{groups:a,items:l,defaultTimeStart:g()().add(0,"day"),defaultTimeEnd:g()().add(12,"hour"),headerLabelFormats:{yearLong:"YYYY",yearShort:"YY",monthShort:"MMM YYYY",monthMedium:"MMMM YYYY",monthLong:"MMMM YYYY",dayShort:"DD MMM",dayLong:"dddd, DD MMM YYYY",hourShort:"HH:mm",hourMedium:"HH:mm",hourLong:"HH:mm:ss"}})})};var v=t(89379),A=t(22019),f=t(34535),y=t(5174),k=t(30815),S=t(37970),M=t(42788),w=t(26259);const C=[];function D(e){return Array.from({length:e},(()=>function(){let e="#";for(let a=0;a<6;a++)e+="0123456789ABCDEF"[Math.floor(16*Math.random())];return e}()))}const B=()=>{const e=(0,x.A)(),a=(new Date).getFullYear(),t=[a-2,a-1,a],[l,i]=(0,n.useState)({series:[{data:[]}],options:{chart:{height:350,type:"bar"},colors:C,plotOptions:{bar:{columnWidth:"45%",distributed:!0}},dataLabels:{enabled:!1},legend:{show:!1},xaxis:{categories:[],labels:{style:{colors:C,fontSize:"12px"}}}}}),[r,s]=(0,n.useState)("yearly"),[o,d]=(0,n.useState)(""),[c,u]=(0,n.useState)(a),[m,h]=(0,n.useState)(""),[p,g]=(0,n.useState)(""),j=(0,f.Ay)(y.A)({borderRadius:"17px",backgroundColor:"white",letterSpacing:"0.5px",border:"none","& .MuiOutlinedInput-notchedOutline":{borderRadius:"17px",border:"none"}});return n.useEffect((()=>{const t="".concat(a,"-01-01 00:00:00"),n="".concat(a,"-12-31 23:59:59");e.get("dapi/mobil/bbm-laporan",{params:{startdate:t,enddate:n}}).then((e=>{if(e.data.success){const a=e.data.data.categories||[],t=e.data.data.data||[],n=D(a.length);i((e=>(0,v.A)((0,v.A)({},e),{},{series:[{data:t}],options:(0,v.A)((0,v.A)({},e.options),{},{colors:n,xaxis:(0,v.A)((0,v.A)({},e.options.xaxis),{},{categories:a})})})))}})).catch((()=>{i((e=>(0,v.A)((0,v.A)({},e),{},{series:[{data:[]}],options:(0,v.A)((0,v.A)({},e.options),{},{xaxis:(0,v.A)((0,v.A)({},e.options.xaxis),{},{categories:[]})})})))}))}),[]),(0,b.jsxs)("div",{className:"chart-container",children:[(0,b.jsxs)(k.A,{display:"flex",justifyContent:"space-between",alignItems:"center",flexWrap:"wrap",sx:{gap:2,flexDirection:{xs:"column",sm:"row"},alignItems:{xs:"stretch",sm:"center"}},children:[(0,b.jsx)("h4",{style:{fontWeight:"bold",color:"black",marginBottom:8},children:"Grafik BBM Mobil Operasional"}),(0,b.jsxs)(k.A,{sx:{borderRadius:3,background:"#f8f9fa",boxShadow:"0 1px 6px rgba(60,60,60,0.07)",p:{xs:1,sm:1.5},display:"flex",flexDirection:{xs:"column",sm:"row"},alignItems:{xs:"stretch",sm:"center"},gap:1,minWidth:{xs:"unset",sm:320},width:{xs:"100%",sm:"auto"},mb:{xs:1,sm:0}},children:[(0,b.jsx)(k.A,{className:"me-2",sx:{minWidth:80,maxWidth:120},children:(0,b.jsxs)(j,{value:r,onChange:e=>{s(e.target.value),d(""),u(a),h(""),g("")},displayEmpty:!0,size:"small",fullWidth:!0,sx:{fontSize:13,height:36},children:[(0,b.jsx)(S.A,{value:"monthly",sx:{fontSize:13},children:"Bulanan"}),(0,b.jsx)(S.A,{value:"yearly",sx:{fontSize:13},children:"Tahunan"}),(0,b.jsx)(S.A,{value:"custom",sx:{fontSize:13},children:"Kustom"})]})}),"monthly"===r&&(0,b.jsxs)(k.A,{display:"flex",alignItems:"center",sx:{gap:1,flexWrap:"wrap"},children:[(0,b.jsxs)(j,{value:o,onChange:e=>d(e.target.value),displayEmpty:!0,size:"small",sx:{minWidth:80,maxWidth:110,fontSize:13,height:36},fullWidth:!0,children:[(0,b.jsx)(S.A,{value:"",sx:{fontSize:13},children:(0,b.jsx)("em",{children:"Pilih Bulan"})}),Array.from({length:12},((e,a)=>(0,b.jsx)(S.A,{value:a+1,sx:{fontSize:13},children:"Bulan ".concat(a+1)},a)))]}),(0,b.jsxs)(j,{value:c,onChange:e=>u(e.target.value),displayEmpty:!0,size:"small",sx:{minWidth:80,maxWidth:110,fontSize:13,height:36},fullWidth:!0,children:[(0,b.jsx)(S.A,{value:"",sx:{fontSize:13},children:(0,b.jsx)("em",{children:"Pilih Tahun"})}),t.map((e=>(0,b.jsx)(S.A,{value:e,sx:{fontSize:13},children:e},e)))]})]}),"yearly"===r&&(0,b.jsx)(k.A,{sx:{minWidth:80,maxWidth:110},children:(0,b.jsxs)(j,{value:c,onChange:e=>u(e.target.value),displayEmpty:!0,size:"small",fullWidth:!0,sx:{fontSize:13,height:36},children:[(0,b.jsx)(S.A,{value:"",sx:{fontSize:13},children:(0,b.jsx)("em",{children:"Pilih Tahun"})}),t.map((e=>(0,b.jsx)(S.A,{value:e,sx:{fontSize:13},children:e},e)))]})}),"custom"===r&&(0,b.jsxs)(k.A,{display:"flex",alignItems:"center",sx:{gap:1,flexWrap:"wrap"},children:[(0,b.jsx)(M.A,{label:"Tanggal Mulai",type:"date",value:m,onChange:e=>h(e.target.value),size:"small",InputLabelProps:{shrink:!0},sx:{minWidth:110,maxWidth:140,fontSize:13,height:36},fullWidth:!0}),(0,b.jsx)(M.A,{label:"Tanggal Akhir",type:"date",value:p,onChange:e=>g(e.target.value),size:"small",InputLabelProps:{shrink:!0},sx:{minWidth:110,maxWidth:140,fontSize:13,height:36},fullWidth:!0})]}),(0,b.jsx)(w.A,{color:"primary",size:"sm",style:{padding:"4px 12px",borderRadius:"17px",fontWeight:"bold",marginTop:2,fontSize:13,height:32,minWidth:70},onClick:()=>{const{start:t,end:n}=(()=>{if("yearly"===r&&c)return{start:"".concat(c,"-01-01 00:00:00"),end:"".concat(c,"-12-31 23:59:59")};if("monthly"===r&&c&&o){const e=new Date(c,o,0).getDate();return{start:"".concat(c,"-").concat(String(o).padStart(2,"0"),"-01 00:00:00"),end:"".concat(c,"-").concat(String(o).padStart(2,"0"),"-").concat(e," 23:59:59")}}return"custom"===r&&m&&p?{start:"".concat(m," 00:00:00"),end:"".concat(p," 23:59:59")}:{start:"".concat(a,"-01-01 00:00:00"),end:"".concat(a,"-12-31 23:59:59")}})();e.get("dapi/mobil/bbm-laporan",{params:{startdate:t,enddate:n}}).then((e=>{if(e.data.success){const a=e.data.data.categories||[],t=e.data.data.data||[],n=D(a.length);i((e=>(0,v.A)((0,v.A)({},e),{},{series:[{data:t}],options:(0,v.A)((0,v.A)({},e.options),{},{colors:n,xaxis:(0,v.A)((0,v.A)({},e.options.xaxis),{},{categories:a})})})))}else i((e=>(0,v.A)((0,v.A)({},e),{},{series:[{data:[]}],options:(0,v.A)((0,v.A)({},e.options),{},{xaxis:(0,v.A)((0,v.A)({},e.options.xaxis),{},{categories:[]})})})))})).catch((e=>{console.error("Error fetching BBM data:",e),i((e=>(0,v.A)((0,v.A)({},e),{},{series:[{data:[]}],options:(0,v.A)((0,v.A)({},e.options),{},{xaxis:(0,v.A)((0,v.A)({},e.options.xaxis),{},{categories:[]})})})))}))},children:"Tampilkan"})]})]}),(0,b.jsx)(A.A,{options:l.options,series:l.series,type:"bar",height:350})]})},P=()=>{const e=(0,n.useRef)(null),a=(0,x.A)(),[t,l]=(0,n.useState)([]);(0,n.useEffect)((()=>{a.get("dapi/mobil/available").then((e=>{e.data.success&&(l(e.data.data),console.log("Available cars:",e.data.data))})).catch((e=>{console.error("Error fetching available cars:",e)}))}),[]);return(0,b.jsxs)("div",{className:"available-cars",children:[(0,b.jsx)("button",{type:"button",className:"arrow-button left-arrow",onClick:()=>{e.current.scrollLeft-=300},children:"<"}),(0,b.jsx)("div",{className:"car-list",ref:e,children:t.map((e=>{const a=e.brand?e.brand.toLowerCase():"";let t="https://agungtoyota.co.id/app/sam/assets/product_car_model/a1f5610604298e07d5b4b2c369555fda.png";return a.includes("scoopy")?t="https://i.imgur.com/6N80uyd.png":a.includes("vanza")?t="https://www.seva.id/_next/image?url=https%3A%2F%2Fimages.prod.seva.id%2FToyota%2FAll%20New%20Avanza%2Fmain_color%2Fhitam.png&w=640&q=75":a.includes("fourtuner")?t="https://omnispace.blob.core.windows.net/strapi-prod/2022-09-19/TRAC_SUV_Car_Toyota_Fortuner_2_ffd7275fdf.png":a.includes("zenix")&&(t="https://www.kallatoyota.co.id/storage/images/thumbnail/car-types/1673314489-hybrid-20-v-hv-cvt-modelista.png"),(0,b.jsxs)("div",{className:"car-card",children:[(0,b.jsx)("img",{src:t,alt:e.name,className:"car-image"}),(0,b.jsx)("h4",{children:e.brand}),(0,b.jsx)("span",{children:e.plat})]},e.plat)}))}),(0,b.jsx)("button",{type:"button",className:"arrow-button right-arrow",onClick:()=>{e.current.scrollLeft+=300},children:">"})]})};var Y=t(81509),N=t(58390),T=t(89302),_=t(66919),E=t(18039),H=t(57972),R=t(74605),z=t(14256),I=t(11906),K=t(60446),W=t.n(K),O=t(40028),L=t(58786),F=t(20917),U=(t(94727),t(30342));const V=(0,n.forwardRef)(((e,a)=>{const t=(0,x.A)(),[l,i]=(0,n.useState)([]),{auth:r}=(0,U.A)(),s=e.afterReviewRef||null,o=(0,n.useCallback)((()=>{var e,a;console.log(r.user);const n=null!==(e=r.user)&&void 0!==e&&null!==(a=e.roles)&&void 0!==a&&a.includes("PICMobil")?"dapi/mobil/get-permintaan-all":"dapi/mobil/get-permintaan";t.get(n).then((e=>{const a=e.data.data.map((e=>(0,v.A)((0,v.A)({},e),{},{displayMobil:"".concat(e.brand," - ").concat(e.plat)})));i(a)})).catch((e=>{console.error("Error fetching data:",e)}))}),[r.user,t]);(0,n.useEffect)((()=>{o()}),[]),(0,n.useImperativeHandle)(a,(()=>({refreshData:o})));const d=[{name:"Aksi",cell:e=>{var a,n,l,i;return(0,b.jsxs)(b.Fragment,{children:[(null===(a=r.user)||void 0===a||null===(n=a.roles)||void 0===n?void 0:n.includes("PICMobil"))&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(I.A,{variant:"contained",color:"success",size:"small",onClick:()=>(e=>{t.post("dapi/mobil/approve-permintaan/".concat(e)).then((()=>{(0,O.x)("success","Permintaan berhasil disetujui."),o(),s&&s.current&&s.current.refreshData&&s.current.refreshData()})).catch((e=>{console.error("Error approving request:",e),(0,O.x)("error","Terjadi kesalahan saat menyetujui permintaan.")}))})(null===e||void 0===e?void 0:e.id),style:{marginRight:"5px"},children:"Approve"}),(0,b.jsx)(I.A,{variant:"contained",color:"error",size:"small",onClick:()=>(e=>{let a="";(0,F.ZX)({title:"Konfirmasi Penolakan",message:"Masukkan alasan penolakan:",customUI:n=>{let{onClose:l}=n;return(0,b.jsxs)("div",{className:"custom-ui",children:[(0,b.jsx)("h1",{children:"Konfirmasi Penolakan"}),(0,b.jsx)(M.A,{label:"Alasan Penolakan",fullWidth:!0,multiline:!0,rows:3,onChange:e=>{a=e.target.value}}),(0,b.jsxs)("div",{style:{marginTop:"20px"},children:[(0,b.jsx)(I.A,{variant:"contained",color:"primary",onClick:()=>{a.trim()?(t.post("dapi/mobil/reject-permintaan/".concat(e),{ket:a}).then((()=>{(0,O.x)("success","Permintaan berhasil ditolak."),o(),s&&s.current&&s.current.refreshData&&s.current.refreshData()})).catch((e=>{console.error("Error rejecting request:",e),(0,O.x)("error","Terjadi kesalahan saat menolak permintaan.")})),l()):(0,O.x)("error","Harap masukkan alasan penolakan.")},children:"Submit"}),(0,b.jsx)(I.A,{variant:"outlined",color:"secondary",onClick:l,style:{marginLeft:"10px"},children:"Batal"})]})]})}})})(null===e||void 0===e?void 0:e.id),style:{marginRight:"5px"},children:"Reject"})]}),!(null!==(l=r.user)&&void 0!==l&&null!==(i=l.roles)&&void 0!==i&&i.includes("PICMobil"))&&(0,b.jsx)(I.A,{variant:"contained",color:"error",size:"small",disabled:null!==(null===e||void 0===e?void 0:e.status),onClick:()=>((e,a)=>{null===a?(0,F.ZX)({title:"Konfirmasi Hapus",message:"Apakah Anda yakin ingin menghapus permintaan ini?",buttons:[{label:"Ya",onClick:()=>{t.post("dapi/mobil/delete-permintaan/".concat(e)).then((()=>{(0,O.x)("success","Permintaan berhasil dihapus."),o()})).catch((e=>{console.error("Error deleting data:",e),(0,O.x)("error","Terjadi kesalahan saat menghapus permintaan.")}))}},{label:"Tidak",onClick:()=>{}}]}):(0,O.x)("error","Tidak bisa dihapus, permintaan sudah direview.")})(null===e||void 0===e?void 0:e.id,null===e||void 0===e?void 0:e.status),children:"Hapus"})]})},ignoreRowClick:!0,allowOverflow:!0,button:!0,width:"250px"},{name:"Tgl Pengajuan",selector:e=>null!==e&&void 0!==e&&e.created_at?new Date(null===e||void 0===e?void 0:e.created_at).toLocaleString():"Unknown",sortable:!0},{name:"Keperluan",selector:e=>null===e||void 0===e?void 0:e.keperluan,sortable:!0},{name:"Mobil",selector:e=>(null===e||void 0===e?void 0:e.displayMobil)||"-",sortable:!0},{name:"Dari",selector:e=>new Date(null===e||void 0===e?void 0:e.mulai).toLocaleString(),sortable:!0},{name:"Sampai",selector:e=>new Date(null===e||void 0===e?void 0:e.hingga).toLocaleString(),sortable:!0},{name:"Perlu Sopir",selector:e=>1===(null===e||void 0===e?void 0:e.sopir)?"Ya":"Tidak",sortable:!0},{name:"Status",selector:e=>null===(null===e||void 0===e?void 0:e.status)?"Under Review":0===(null===e||void 0===e?void 0:e.status)?"Reject":1===(null===e||void 0===e?void 0:e.status)?"Approve":"Unknown",sortable:!0},{name:"Keterangan",selector:e=>(null===e||void 0===e?void 0:e.ket)||"-",sortable:!1}];return(0,b.jsx)(L.Ay,{title:"List Permintaan Kendaraan",columns:d,data:l,pagination:!0,highlightOnHover:!0,striped:!0})})),q=V,Z=n.forwardRef(((e,a)=>{const t=(0,x.A)(),[l,i]=(0,n.useState)([]),r=()=>{t.get("dapi/mobil/get-permintaan-after").then((e=>{e.data.success&&i(e.data.data)})).catch((e=>{console.error("Error fetching after review data:",e)}))};(0,n.useEffect)((()=>{r()}),[]),n.useImperativeHandle(a,(()=>({refreshData:r})));const s=[{name:"Keperluan",selector:e=>e.keperluan,sortable:!0},{name:"Dibuat",selector:e=>e.created_by_name,sortable:!0},{name:"Dari",selector:e=>new Date(e.mulai).toLocaleString(),sortable:!0},{name:"Sampai",selector:e=>new Date(e.hingga).toLocaleString(),sortable:!0},{name:"Status",selector:e=>1===e.status?"Disetujui":"Ditolak",sortable:!0},{name:"Direview",selector:e=>e.review_by_name,sortable:!0},{name:"Keterangan",selector:e=>e.ket,sortable:!0}];return(0,b.jsx)(L.Ay,{title:"Permintaan Setelah Review",columns:s,data:l,pagination:!0,highlightOnHover:!0,striped:!0})})),G=()=>{const e=(0,x.A)(),[a,t]=(0,n.useState)(""),[l,i]=(0,n.useState)(null),[r,s]=(0,n.useState)(null),[o,d]=(0,n.useState)(0),m=(0,n.useRef)(null),h=(0,n.useRef)(null),[p,g]=n.useState(!0);return(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(c.A,{children:(0,b.jsxs)(u.A,{children:[(0,b.jsx)(Y.A,{color:"info",isOpen:p,toggle:()=>g(!1),fade:!1,children:"Permintaan Mobil Minimal 1 Jam sebelum pemakaian"}),(0,b.jsxs)(k.A,{component:"form",onSubmit:n=>{if(n.preventDefault(),!a||!l||!r)return void(0,O.x)("error","Harap isi semua field sebelum mengajukan permintaan.");const c={keperluan:a,dari:l?W()(l).format("YYYY-MM-DD HH:mm:ss"):null,sampai:r?W()(r).format("YYYY-MM-DD HH:mm:ss"):null,perluSopir:o};e.post("dapi/mobil/insert-permintaan",c).then((e=>{console.log("Data submitted successfully:",e.data),(0,O.x)("success","Permintaan berhasil diajukan!"),t(""),i(null),s(null),d(0),m.current&&m.current.refreshData()})).catch((e=>{console.error("Error submitting data:",e),(0,O.x)("error","Terjadi kesalahan saat mengajukan permintaan.")}))},sx:{"& .MuiTextField-root":{m:1,width:"100%"},"& .MuiAutocomplete-root":{m:1,width:"100%"},"& .MuiButton-root":{m:1,width:"100%"},display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",width:"100%",margin:"auto"},noValidate:!0,autoComplete:"off",children:[(0,b.jsx)(M.A,{required:!0,id:"keperluan",label:"Keperluan",variant:"outlined",value:a,onChange:e=>t(e.target.value)}),(0,b.jsxs)(N.$,{dateAdapter:T.R,children:[(0,b.jsx)(_.K,{renderInput:e=>(0,b.jsx)(M.A,(0,v.A)({},e)),label:"Dari",ampm:!1,value:l,onChange:i,viewRenderers:{hours:E.Zo,minutes:E.Zo}}),(0,b.jsx)(_.K,{renderInput:e=>(0,b.jsx)(M.A,(0,v.A)({},e)),label:"Sampai",ampm:!1,value:r,onChange:s,viewRenderers:{hours:E.Zo,minutes:E.Zo}})]}),(0,b.jsx)(k.A,{sx:{"& .MuiFormLabel-root":{m:1,width:"100%"},"& .MuiRadioGroup-root":{m:1,width:"100%"},display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",border:"1px solid #ccc",borderRadius:"4px",paddingLeft:"20px",paddingRight:"20px",width:"100%",margin:"auto",marginTop:"8px"},children:(0,b.jsxs)(H.A,{row:!0,value:o,onChange:e=>d(e.target.value),sx:{justifyContent:"space-between",width:"100%"},children:[(0,b.jsx)(R.A,{value:"1",control:(0,b.jsx)(z.A,{}),label:"Memerlukan Sopir"}),(0,b.jsx)(R.A,{value:"0",control:(0,b.jsx)(z.A,{}),label:"Tidak Memerlukan Sopir"})]})}),(0,b.jsx)(I.A,{type:"submit",variant:"contained",color:"secondary",size:"large",children:"Submit Pemintaan"})]})]})}),(0,b.jsx)(c.A,{children:(0,b.jsx)(u.A,{children:(0,b.jsx)(q,{ref:m,afterReviewRef:h})})}),(0,b.jsx)(c.A,{children:(0,b.jsx)(u.A,{children:(0,b.jsx)(Z,{ref:h})})})]})};var J=t(80045),X=t(28007);const $=["key"],Q=()=>{const e=(0,x.A)(),[a,t]=(0,n.useState)(null),[l,i]=(0,n.useState)([]),[r,s]=(0,n.useState)(null),[o,d]=(0,n.useState)(""),[h,p]=(0,n.useState)("booking"),[g,j]=(0,n.useState)(""),[A,f]=(0,n.useState)(""),[y,w]=(0,n.useState)([]),[C,D]=(0,n.useState)([]),[B,P]=(0,n.useState)([]),H=()=>{e.get("dapi/mobil/get-pengambilan").then((e=>{e.data.success&&P(e.data.data)})).catch((e=>{console.error("Error fetching pengambilan:",e)}))};(0,n.useEffect)((()=>{e.get("api/employe/assignment-list?search=all").then((e=>{i(e.data.data),console.log(e.data.data)})),e.get("dapi/mobil/get-permintaan-by-status").then((e=>{e.data.success&&(console.log(e),w(e.data.data))})).catch((e=>{console.error("Error fetching bookings:",e)})),e.get("dapi/mobil/get").then((e=>{e.data.success&&D(e.data.data)})).catch((e=>{console.error("Error fetching mobils:",e)})),H()}),[]);const R={padding:"5px 10px",backgroundColor:"#007BFF",color:"#fff",border:"none",borderRadius:"5px",cursor:"pointer"},z=[{name:"Pengembalian",cell:a=>a.real_pengembalian?(0,b.jsx)("span",{children:W()(a.real_pengembalian).format("YYYY-MM-DD HH:mm")}):(0,b.jsx)("button",{type:"button",style:R,onClick:()=>(a=>{let t=null;(0,F.ZX)({title:"Konfirmasi Pengembalian",message:"Cek apakah kilometer dan minyak sesuai?",customUI:n=>{let{onClose:l}=n;return(0,b.jsxs)("div",{className:"custom-ui",children:[(0,b.jsx)("h1",{children:"Konfirmasi Pengembalian"}),(0,b.jsx)("p",{children:"Cek apakah kilometer dan minyak sesuai?"}),(0,b.jsx)(M.A,{label:"Kilometer Terakhir",type:"number",fullWidth:!0,onChange:e=>{t=e.target.value}}),(0,b.jsxs)("div",{style:{marginTop:"20px"},children:[(0,b.jsx)(I.A,{variant:"contained",color:"primary",onClick:()=>{t?(e.post("dapi/mobil/pengembalian/".concat(a),{last_km:t}).then((e=>{e.data.success?((0,O.x)("success","Mobil berhasil dikembalikan."),H()):(0,O.x)("error","Gagal mengembalikan mobil.")})).catch((e=>{console.error("Error during return:",e),(0,O.x)("error","Terjadi kesalahan saat mengembalikan mobil.")})),l()):(0,O.x)("error","Harap masukkan kilometer terbaru.")},children:"Ya"}),(0,b.jsx)(I.A,{variant:"outlined",color:"secondary",onClick:l,style:{marginLeft:"10px"},children:"Tidak"})]})]})}})})(a.id),children:"Pengembalian"}),width:"150px",button:!0,sortable:!1},{name:"Nama Karyawan",selector:e=>e.employe_name||e.employe_name,sortable:!0},{name:"Pengambilan",selector:e=>e.taken_time||e.taken_time,sortable:!0},{name:"Perjanjian Pengembalian",selector:e=>e.pengembalian||e.pengembalian,sortable:!0},{name:"Nama Mobil",selector:e=>"".concat(e.brand," - ").concat(e.plat),sortable:!0}],K=(0,b.jsx)("div",{style:{textAlign:"center",padding:"20px"},children:"Tidak ada data yang tersedia."}),[U,V]=n.useState(!0);return(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)(c.A,{children:[(0,b.jsx)(m.A,{children:(0,b.jsx)("strong",{children:"Pengambilan Mobil"})}),(0,b.jsxs)(u.A,{children:[(0,b.jsx)(Y.A,{color:"info",isOpen:U,toggle:()=>V(!1),fade:!1,children:"Utamakan yang telah melakukan booking terlebih dahulu"}),(0,b.jsxs)(k.A,{component:"form",sx:{"& .MuiTextField-root":{m:1,width:"100%"},"& .MuiAutocomplete-root":{m:1,width:"100%"},"& .MuiButton-root":{m:1,width:"100%"},display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",width:"100%",margin:"auto"},noValidate:!0,autoComplete:"off",onSubmit:n=>{if(n.preventDefault(),"booking"===h&&!o)return void(0,O.x)("error","Harap isi semua field (Mobil dan Perkiraan Pengembalian) sebelum menyimpan.");if("booking"!==h&&(!o||!a||!A||!r))return void(0,O.x)("error","Harap isi semua field sebelum menyimpan.");console.log(a);const l={id_mobil:o,booked:"booking"===h?g:null,employe_id:"booking"!==h?null===a||void 0===a?void 0:a.value:null,keperluan:"booking"!==h?A:null,sampai:W()(r).format("YYYY-MM-DD HH:mm:ss"),book:h};e.post("dapi/mobil/insert-pengambilan",l).then((e=>{e.data.success?((0,O.x)("success","Data pengambilan berhasil disimpan."),d(""),j(""),t(null),f(""),s(null),p("booking")):(0,O.x)("error","Gagal menyimpan data pengambilan.")})).catch((e=>{console.error("Error saving data:",e),(0,O.x)("error","Terjadi kesalahan saat menyimpan data.")}))},children:[(0,b.jsxs)(M.A,{style:{width:"100%"},variant:"outlined",value:h,onChange:e=>p(e.target.value),select:!0,label:"Booking / No Booking",children:[(0,b.jsx)(S.A,{value:"booking",children:"Booking"}),(0,b.jsx)(S.A,{value:"no-booking",children:"No Booking"})]}),"booking"===h&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(M.A,{style:{width:"100%"},variant:"outlined",value:g,onChange:e=>j(e.target.value),select:!0,label:"Nomor Booking",children:y.map((e=>(0,b.jsx)(S.A,{value:e.id,children:"".concat(e.created_by_name," - ").concat(W()(e.mulai).format("YYYY-MM-DD HH:mm")," s/d ").concat(W()(e.hingga).format("YYYY-MM-DD HH:mm"))},e.id)))}),(0,b.jsx)(M.A,{style:{width:"100%"},variant:"outlined",value:o,onChange:e=>d(e.target.value),select:!0,label:"Unit Mobil",children:C.map((e=>(0,b.jsx)(S.A,{value:e.id,children:"".concat(e.brand," - ").concat(e.plat)},e.id)))})]}),"booking"!==h&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(M.A,{style:{width:"100%"},variant:"outlined",value:o,onChange:e=>d(e.target.value),select:!0,label:"Unit Mobil",children:C.map((e=>(0,b.jsx)(S.A,{value:e.id,children:"".concat(e.brand," - ").concat(e.plat)},e.id)))}),l.length>0&&(0,b.jsx)(X.A,{style:{marginLeft:-10},disablePortal:!0,id:"combo-box-demo",options:l||[],value:a,onChange:(e,a)=>{"string"===typeof a?t({label:a}):a&&a.inputValue?t({label:a.inputValue}):t(a)},getOptionLabel:e=>"string"===typeof e?e:e.inputValue?e.inputValue:e.label,renderOption:(e,a)=>{const{key:t}=e,n=(0,J.A)(e,$);return(0,b.jsx)("li",(0,v.A)((0,v.A)({},n),{},{children:a.label}),t)},renderInput:e=>(0,b.jsx)(M.A,(0,v.A)((0,v.A)({},e),{},{label:"Nama Karyawan"}))}),(0,b.jsx)(M.A,{required:!0,id:"keperluan",label:"Keperluan",variant:"outlined",value:A,onChange:e=>f(e.target.value)}),(0,b.jsx)(N.$,{dateAdapter:T.R,children:(0,b.jsx)(_.K,{renderInput:e=>(0,b.jsx)(M.A,(0,v.A)({},e)),label:"Perkiraan Pengembalian",ampm:!1,value:r,onChange:s,viewRenderers:{hours:E.Zo,minutes:E.Zo}})})]}),(0,b.jsx)(I.A,{type:"submit",variant:"contained",color:"secondary",size:"large",children:"Simpan"})]})]})]}),(0,b.jsxs)(c.A,{children:[(0,b.jsx)(m.A,{children:(0,b.jsx)("strong",{children:"Pengembalian Mobil"})}),(0,b.jsx)(u.A,{children:(0,b.jsx)(L.Ay,{columns:z,data:B,noDataComponent:K,pagination:!0,fixedHeader:!0,sortable:!0,fixedHeaderScrollHeight:"300px"})})]})]})};var ee=t(53193),ae=t(79190),te=t(85865);const ne=()=>{const e=(0,x.A)(),[a,t]=(0,n.useState)([]);(0,n.useEffect)((()=>{e.get("dapi/mobil/get-bbm").then((e=>{e.data.success&&(console.log(e.data.data),t(e.data.data))})).catch((e=>{console.error("Error fetching BBM data:",e)}))}),[]);return(0,b.jsx)(L.Ay,{title:"Daftar Pengisian BBM",columns:[{name:"Unit Kendaraan",selector:e=>"".concat(e.name),sortable:!0},{name:"Jenis BBM",selector:e=>e.jenis_bbm,sortable:!0},{name:"Jumlah Biaya (Rp)",selector:e=>e.jumlah,sortable:!0},{name:"Tanggal Pengisian",selector:e=>e.w_pengisian,sortable:!0},{name:"Pengisian Oleh",selector:e=>e.oleh_name,sortable:!0}],data:a,pagination:!0,highlightOnHover:!0,striped:!0})},le=["key"],ie=()=>{const e=(0,x.A)(),[a,t]=(0,n.useState)(""),[l,i]=(0,n.useState)(""),[r,s]=(0,n.useState)(""),[o,d]=(0,n.useState)(null),[m,h]=(0,n.useState)(null),[p,g]=(0,n.useState)([]),[j,A]=(0,n.useState)([]),[f,w]=(0,n.useState)(0),[C,D]=(0,n.useState)({});return(0,n.useEffect)((()=>{e.get("api/employe/assignment-list?search=all").then((e=>{g(e.data.data),console.log(e.data.data)})),e.get("dapi/mobil/get").then((e=>{if(e.data.success){const a=e.data.data.map((e=>({value:e.id,label:"".concat(e.brand," - ").concat(e.plat)})));A(a)}})).catch((e=>{console.error("Error fetching unit mobil:",e)}))}),[]),(0,b.jsx)(c.A,{children:(0,b.jsxs)(u.A,{children:[(0,b.jsxs)(k.A,{component:"form",onSubmit:n=>{n.preventDefault();const c={};if(a||(c.unitMobil="Unit Mobil is required"),l||(c.jenisBbm="Jenis BBM is required"),(!r||Number.isNaN(Number(r))||Number(r)<=0)&&(c.jumlahBiaya="Jumlah Biaya must be a positive number"),o||(c.tanggal="Tanggal Pengisian is required"),m||(c.employe="Pengisian oleh is required"),Object.keys(c).length>0)return void D(c);const u=W()(o).format("YYYY-MM-DD HH:mm:ss"),p={id_mobil:a,jenis_bbm:l,jumlah:r,w_pengisian:u,oleh:null===m||void 0===m?void 0:m.value};e.post("dapi/mobil/insert-bbm",p).then((e=>{e.data.success?((0,O.x)("success","Data pengisian BBM berhasil disimpan."),t(""),i(""),s(""),d(null),h(null),D({}),w((e=>e+1))):(0,O.x)("error","Gagal menyimpan data pengisian BBM.")})).catch((e=>{console.error("Error submitting data:",e),(0,O.x)("error","Terjadi kesalahan saat menyimpan data pengisian BBM.")}))},noValidate:!0,autoComplete:"off",sx:{display:"flex",flexDirection:"column",gap:2,margin:"auto",padding:2},children:[(0,b.jsxs)(ee.A,{fullWidth:!0,error:Boolean(C.unitMobil),children:[(0,b.jsx)(ae.A,{id:"unit-mobil-label",children:"Unit Kendaraan"}),(0,b.jsx)(y.A,{labelId:"unit-mobil-label",id:"unit-mobil",value:a,onChange:e=>t(e.target.value),label:"Unit Kendaraan",children:j.map((e=>(0,b.jsx)(S.A,{value:e.value,children:e.label},e.value)))}),C.unitMobil&&(0,b.jsx)(te.A,{color:"error",children:C.unitMobil})]}),(0,b.jsxs)(ee.A,{fullWidth:!0,error:Boolean(C.jenisBbm),children:[(0,b.jsx)(ae.A,{id:"jenis-bbm-label",children:"Jenis BBM"}),(0,b.jsx)(y.A,{labelId:"jenis-bbm-label",id:"jenis-bbm",value:l,onChange:e=>i(e.target.value),label:"Jenis BBM",children:[{label:"Solar (CN 48)",value:"bio_solar",ron:"48",jenis:"diesel"},{label:"Dexlite (CN 51)",value:"dexlite",ron:"51",jenis:"diesel"},{label:"Pertalite (RON 90)",value:"pertalite",ron:"90",jenis:"bensin"},{label:"Pertamax (RON 92)",value:"pertamax",ron:"92",jenis:"bensin"},{label:"Pertamax Green (RON 95)",value:"pertamax_green",ron:"95",jenis:"bensin"},{label:"Pertamax Turbo (RON 98)",value:"pertamax_turbo",ron:"98",jenis:"bensin"},{label:"Dex (CN 53)",value:"dex",ron:"53",jenis:"diesel"}].map((e=>(0,b.jsx)(S.A,{value:e.value,children:e.label},e.value)))}),C.jenisBbm&&(0,b.jsx)(te.A,{color:"error",children:C.jenisBbm})]}),(0,b.jsx)(M.A,{label:"Jumlah Biaya (Rp)",variant:"outlined",type:"number",value:r,onChange:e=>s(e.target.value),error:Boolean(C.jumlahBiaya),helperText:C.jumlahBiaya,fullWidth:!0}),(0,b.jsx)(N.$,{dateAdapter:T.R,children:(0,b.jsx)(_.K,{renderInput:e=>(0,b.jsx)(M.A,(0,v.A)({},e)),label:"Tgl Pengisian",ampm:!1,value:o,onChange:d,viewRenderers:{hours:E.Zo,minutes:E.Zo}})}),p.length>0&&(0,b.jsx)(X.A,{disablePortal:!0,id:"combo-box-demo",options:p||[],value:m,onChange:(e,a)=>{"string"===typeof a?h({label:a}):a&&a.inputValue?h({label:a.inputValue}):h(a)},getOptionLabel:e=>"string"===typeof e?e:e.inputValue?e.inputValue:e.label,renderOption:(e,a)=>{const{key:t}=e,n=(0,J.A)(e,le);return(0,b.jsx)("li",(0,v.A)((0,v.A)({},n),{},{children:a.label}),t)},renderInput:e=>(0,b.jsx)(M.A,(0,v.A)((0,v.A)({},e),{},{label:"Pengisian oleh"}))}),(0,b.jsx)(I.A,{type:"submit",variant:"contained",color:"primary",children:"Submit"})]}),(0,b.jsx)(k.A,{mt:4,children:(0,b.jsx)(ne,{},f)})]})})};var re=t(4598);const se=()=>{const e=(0,x.A)(),[a,t]=(0,n.useState)([]),[l,i]=n.useState(""),[r,s]=n.useState(""),[o,d]=n.useState(""),[h,p]=(0,n.useState)({}),g=()=>{e.get("dapi/mobil/get").then((e=>{e.data.success&&t(e.data.data)})).catch((e=>{console.log(e)}))};n.useEffect((()=>{g()}),[]);const j=[{name:"No",selector:(e,a)=>a+1,sortable:!0},{name:"Brand Kendaraan",selector:e=>e.brand,sortable:!0},{name:"Plat Kendaraan",selector:e=>e.plat,sortable:!0},{name:"Status",selector:a=>(0,b.jsx)(R.A,{control:(0,b.jsx)(re.A,{checked:"aktif"===a.status,onChange:()=>((a,t)=>{e.post("dapi/mobil/update/".concat(a),{status:"aktif"===t?"non-aktif":"aktif"}).then((e=>{e.data.success?((0,O.x)("success","Status berhasil diubah"),g()):(0,O.x)("error","Status gagal diubah")})).catch((e=>{console.log(e),(0,O.x)("error","Terjadi kesalahan saat mengubah status")}))})(a.id,a.status),color:"primary"}),label:"aktif"===a.status?"Aktif":"Nonaktif"})},{name:"Action",selector:a=>(0,b.jsx)(I.A,{size:"small",variant:"contained",color:"secondary",onClick:()=>{(a=>{(0,F.ZX)({title:"Konfirmasi Hapus",message:"Apakah Anda yakin ingin menghapus data ini?",buttons:[{label:"Ya",onClick:()=>{e.post("dapi/mobil/delete/".concat(a)).then((e=>{e.data.success?((0,O.x)("success","Data berhasil dihapus"),g()):(0,O.x)("error","Data gagal dihapus")})).catch((e=>{console.log(e),(0,O.x)("error","Terjadi kesalahan saat menghapus data")}))}},{label:"Tidak",onClick:()=>{}}]})})(a.id)},children:"Hapus"})}];return(0,b.jsx)(b.Fragment,{children:(0,b.jsxs)(c.A,{children:[(0,b.jsx)(m.A,{children:(0,b.jsx)("strong",{children:"Management Kendaraan Operasional"})}),(0,b.jsxs)(u.A,{children:[(0,b.jsxs)(k.A,{component:"form",onSubmit:async a=>{a.preventDefault();const t={};l||(t.brand="Brand Kendaraan is required"),r||(t.plat="Plat Kendaraan is required"),o||(t.status="Status Kendaraan is required"),Object.keys(t).length>0?p(t):(await e.post("dapi/mobil/insert",{brand:l,plat:r,status:o}).then((e=>{e.data.success?((0,O.x)("success","Data berhasil disimpan"),i(""),s(""),d(""),g()):(0,O.x)("error","Data gagal disimpan")})).catch((e=>{console.log(e),(0,O.x)("error","Terjadi kesalahan saat menyimpan data")})),p({}))},noValidate:!0,autoComplete:"off",sx:{display:"flex",flexDirection:"column",gap:2,margin:"auto",padding:2},children:[(0,b.jsx)(M.A,{label:"Merek Kendaraan",variant:"outlined",type:"text",value:l,onChange:e=>i(e.target.value),error:Boolean(h.brand),helperText:h.brand,fullWidth:!0}),(0,b.jsx)(M.A,{label:"Plat Kendaraan",variant:"outlined",type:"text",value:r,onChange:e=>s(e.target.value),error:Boolean(h.plat),helperText:h.plat,fullWidth:!0}),(0,b.jsxs)(ee.A,{fullWidth:!0,error:Boolean(h.status),children:[(0,b.jsx)(ae.A,{id:"unit-kendaraan-label",children:"Status"}),(0,b.jsxs)(y.A,{labelId:"unit-kendaraan-label",id:"unit-kendaraan",value:o,onChange:e=>d(e.target.value),label:"Unit Kendaraan",children:[(0,b.jsx)(S.A,{value:"aktif",children:"Aktif"}),(0,b.jsx)(S.A,{value:"non-aktif",children:"Non-Aktif"})]}),h.status&&(0,b.jsx)(te.A,{color:"error",children:h.status})]}),(0,b.jsx)(I.A,{type:"submit",variant:"contained",color:"primary",children:"Tambah Data Kendaraan"})]}),(0,b.jsx)(L.Ay,{className:"mt-3",columns:j,data:a,pagination:!0,highlightOnHover:!0,pointerOnHover:!0,striped:!0,responsive:!0})]})]})})},oe=()=>{var e,a;const[t,l]=(0,n.useState)("1"),{auth:h}=(0,U.A)();(0,n.useEffect)((()=>{const e=()=>{const e=window.location.hash.replace("#","");["1","2","3","4","5"].includes(e)&&l(e)};return e(),window.addEventListener("hashchange",e),()=>window.removeEventListener("hashchange",e)}),[]);const p=null===h||void 0===h||null===(e=h.user)||void 0===e||null===(a=e.roles)||void 0===a?void 0:a.includes("PICMobil");return(0,b.jsx)(b.Fragment,{children:(0,b.jsxs)(i.Ay,{value:t,children:[(0,b.jsx)(c.A,{className:"mb-1",children:(0,b.jsxs)(r.A,{onChange:(e,a)=>{l(a),window.location.hash="#".concat(a)},"aria-label":"lab API tabs example",vertical:"sm",variant:"scrollable",scrollButtons:"auto",children:[(0,b.jsx)(o.A,{label:(0,b.jsxs)(d.A,{badgeContent:0,anchorOrigin:{vertical:"top",horizontal:"right"},color:"primary",children:[(0,b.jsx)("strong",{children:"DASHBOARD"})," \xa0\xa0"]}),value:"1"}),(0,b.jsx)(o.A,{label:(0,b.jsxs)(d.A,{badgeContent:0,anchorOrigin:{vertical:"top",horizontal:"right"},color:"primary",children:[(0,b.jsx)("strong",{children:"BOOKING"})," \xa0\xa0"]}),value:"2"}),p&&(0,b.jsx)(o.A,{label:(0,b.jsxs)(d.A,{badgeContent:0,anchorOrigin:{vertical:"top",horizontal:"right"},color:"primary",children:[(0,b.jsx)("strong",{children:"PENGAMBILAN & PENGEMBALIAN"})," \xa0\xa0"]}),value:"3"}),p&&(0,b.jsx)(o.A,{label:(0,b.jsxs)(d.A,{badgeContent:0,anchorOrigin:{vertical:"top",horizontal:"right"},color:"primary",children:[(0,b.jsx)("strong",{children:"PENGISIAN BBM"})," \xa0\xa0"]}),value:"4"}),p&&(0,b.jsx)(o.A,{label:(0,b.jsxs)(d.A,{badgeContent:0,anchorOrigin:{vertical:"top",horizontal:"right"},color:"primary",children:[(0,b.jsx)("strong",{children:"SETTING"})," \xa0\xa0"]}),value:"5"})]})}),(0,b.jsxs)(s.A,{value:"1",className:"ps-0 pe-0",children:[(0,b.jsx)(c.A,{className:"mt-4",children:(0,b.jsx)(u.A,{children:(0,b.jsx)(B,{})})}),(0,b.jsxs)(c.A,{className:"mt-4",children:[(0,b.jsx)(m.A,{children:(0,b.jsx)("strong",{children:"Mobil Operasional yang Tersedia"})}),(0,b.jsx)(u.A,{children:(0,b.jsx)(P,{})})]}),(0,b.jsxs)(c.A,{children:[(0,b.jsx)(m.A,{children:(0,b.jsx)("strong",{children:"Daftar Penggunaan Mobil"})}),(0,b.jsx)(u.A,{className:"px-4",children:(0,b.jsx)(j,{})})]})]}),(0,b.jsx)(s.A,{value:"2",className:"ps-0 pe-0",children:(0,b.jsx)(G,{})}),p&&(0,b.jsx)(s.A,{value:"3",className:"ps-0 pe-0",children:(0,b.jsx)(Q,{})}),p&&(0,b.jsx)(s.A,{value:"4",className:"ps-0 pe-0",children:(0,b.jsx)(ie,{})}),p&&(0,b.jsx)(s.A,{value:"5",className:"ps-0 pe-0",children:(0,b.jsx)(se,{})})]})})},de=()=>(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(l.A,{}),(0,b.jsx)(oe,{})]})}}]);
//# sourceMappingURL=5604.e9d92861.chunk.js.map