"use strict";(self.webpackChunkmaterialpro_main=self.webpackChunkmaterialpro_main||[]).push([[6251],{26251:(e,s,a)=>{a.r(s),a.d(s,{default:()=>$});var i=a(89379),t=a(65043),l=a(7493),n=a(55918),d=a.n(n),o=a(70579);const r=e=>{let{filters:s,onFilterChange:a,disableFilter:i}=e;const[n,r]=(0,t.useState)(!1),c=()=>{r(!n)},u=(new Date).getFullYear(),v=[u,u-1],h=[{label:"Januari",value:1},{label:"Februari",value:2},{label:"Maret",value:3},{label:"April",value:4},{label:"Mei",value:5},{label:"Juni",value:6},{label:"Juli",value:7},{label:"Agustus",value:8},{label:"September",value:9},{label:"Oktober",value:10},{label:"November",value:11},{label:"Desember",value:12}],m=()=>(0,o.jsxs)("div",{className:"filter-list",children:[!i&&(0,o.jsxs)(o.Fragment,{children:[(0,o.jsxs)("div",{className:"filter-group",children:[(0,o.jsx)("div",{className:"filter-title",children:(0,o.jsx)("span",{children:"Sort"})}),["all","in progress","review","approved"].map((e=>(0,o.jsxs)("div",{className:"filter-item",children:[(0,o.jsx)("input",{type:"radio",id:"sort-".concat(e),name:"sort",checked:s.sort===e,onChange:()=>a("sort",e)}),(0,o.jsx)(l.A,{htmlFor:"sort-".concat(e),className:s.sort===e?"active":"",children:e.replace("-"," ").replace(/\b\w/g,(e=>e.toUpperCase()))})]},e)))]}),(0,o.jsx)("hr",{className:"mobile-separator"})]}),(0,o.jsxs)("div",{className:"filter-group",children:[(0,o.jsx)("div",{className:"filter-title",children:(0,o.jsx)("span",{children:"Kategori"})}),[{value:"all",label:"All"},{value:"tambahan",label:"Tambahan"},{value:"projects",label:"Proyek/Proker"}].map((e=>(0,o.jsxs)("div",{className:"filter-item",children:[(0,o.jsx)("input",{type:"radio",id:e.value,name:"kategori",checked:s.kategori===e.value,onChange:()=>a("kategori",e.value)}),(0,o.jsx)(l.A,{htmlFor:e.value,className:s.kategori===e.value?"active":"",children:e.label})]},e.value)))]}),(0,o.jsx)("hr",{className:"mobile-separator"}),(0,o.jsxs)("div",{className:"filter-group",children:[(0,o.jsx)("div",{className:"filter-title",children:(0,o.jsx)("span",{children:"Priority"})}),["all","biasa","mendesak"].map((e=>(0,o.jsxs)("div",{className:"filter-item",children:[(0,o.jsx)("input",{type:"radio",id:"priority-".concat(e),name:"is_priority",checked:s.is_priority===e,onChange:()=>a("is_priority",e)}),(0,o.jsx)(l.A,{htmlFor:"priority-".concat(e),className:s.is_priority===e?"active":"",children:e.replace("-"," ").replace(/\b\w/g,(e=>e.toUpperCase()))})]},e)))]}),(0,o.jsx)("hr",{className:"mobile-separator"}),(0,o.jsxs)("div",{className:"filter-group",children:[(0,o.jsx)("div",{className:"filter-title",children:(0,o.jsx)("span",{children:"Tahun"})}),v.map((e=>(0,o.jsxs)("div",{className:"filter-item",children:[(0,o.jsx)("input",{type:"radio",id:"tahun-".concat(e),name:"tahun",checked:(null===s||void 0===s?void 0:s.tahun.toString())===e.toString(),onChange:()=>a("tahun",e)}),(0,o.jsx)(l.A,{htmlFor:"tahun-".concat(e),className:s.tahun===e?"active":"",children:e})]},e)))]}),(0,o.jsxs)("div",{className:"filter-group",children:[(0,o.jsx)("div",{className:"filter-title",children:(0,o.jsx)("span",{children:"Bulan"})}),(0,o.jsxs)("select",{className:"filter-select",value:Number(s.bulan),onChange:e=>a("bulan",e.target.value),children:[(0,o.jsx)("option",{value:"",children:"All"}),h.map((e=>(0,o.jsx)("option",{value:e.value,children:e.label},e.value)))]})]})]});return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("button",{type:"button",className:"mobile-filter-button",onClick:c,children:(0,o.jsx)(d(),{icon:"filter_list",style:{fontSize:20}})}),n&&(0,o.jsx)("div",{className:"mobile-filter-modal-overlay",onClick:c,children:(0,o.jsxs)("div",{className:"mobile-filter-modal-content",onClick:e=>e.stopPropagation(),children:[(0,o.jsxs)("div",{className:"modal-header",children:[(0,o.jsx)("h3",{children:"Filter"}),(0,o.jsx)("button",{type:"button",className:"close-button",onClick:c,children:(0,o.jsx)(d(),{icon:"close",style:{fontSize:24}})})]}),(0,o.jsx)("div",{className:"modal-body",children:m()}),(0,o.jsx)("div",{className:"modal-footer",children:(0,o.jsx)("button",{type:"button",className:"apply-button",onClick:c,children:"Tutup"})})]})}),(0,o.jsx)("div",{className:"daily-filter daily-filter-desktop",children:m()})]})};r.defaultProps={filters:{sort:"all",kategori:"all",is_priority:"all",tahun:(new Date).getFullYear(),bulan:""},disableFilter:!1};const c=r;var u=a(203);const v=e=>{let{actionFn:s,color:a,icon:i,text:t,size:l,badge:n,badgeColor:r,badgeCount:c}=e;return(0,o.jsxs)("button",{type:"button",className:"button ".concat(a," ").concat(l||"md"),onClick:s,children:[(0,o.jsx)(d(),{icon:i}),t," ",n&&(0,o.jsx)("span",{className:"button-badge ".concat(r),children:c})]})},h=e=>{let{value:s,onChange:a}=e;return(0,o.jsx)("div",{className:"search-container",children:(0,o.jsx)("input",{type:"text",placeholder:"Cari Task...",value:s,onChange:a})})};var m=a(93397),p=a(40028);const x=(e,s)=>{const a=[],{activityName:i,startDate:t,endDate:l}=e;return i||t||l?(null!==i&&void 0!==i&&i.trim()||a.push("Task ".concat(s+1,": Nama aktivitas wajib diisi.")),t||a.push("Task ".concat(s+1,": Tanggal mulai wajib diisi.")),l||a.push("Task ".concat(s+1,": Tanggal berakhir wajib diisi.")),t&&l&&new Date(t)>new Date(l)&&a.push("Task ".concat(s+1,": Tanggal mulai tidak boleh setelah tanggal berakhir.")),a):(a.push("Task ".concat(s+1,": Nama aktivitas, tanggal mulai, dan tanggal berakhir wajib diisi.")),a)},j=(e,s)=>{const[a,l]=(0,t.useState)([]),[n,d]=(0,t.useState)(!1),[o,r]=(0,t.useState)(!1),[c,u]=(0,t.useState)({delete:!1,update:!1,review:!1}),[v,h]=(0,t.useState)(!1),[x,j]=(0,t.useState)(!1),g=(0,m.A)(),y=e=>{u((s=>(0,i.A)((0,i.A)({},s),{},{[e]:!s[e]})))},b=()=>{l([]),d(!1)};return{isNewTaskOpen:o,setIsNewTaskOpen:r,handleCheckItem:e=>{l((s=>s.some((s=>s.id===e.id))?s.filter((s=>s.id!==e.id)):[...s,{id:e.id,progress:e.progress,status:e.status}]))},handleCheckForAll:()=>{if(a.length>0||n)l([]),d(!1);else{const s=e.daily.map((e=>{let{id:s,progress:a,status:i}=e;return{id:s,progress:a,status:i}}));l(s),d(!0)}},isAllChecked:n,selectedTasks:a,resetSelection:b,togglePopup:y,visiblePopup:c,handleDelete:async()=>{h(!0);const e=a.map((e=>e.id));try{await((e,s)=>e.delete("api/module/daily/delete",{data:{dailies:s}}))(g,e),s(),(0,p.x)("success","".concat(e.length," task berhasil dihapus!"))}catch(i){(0,p.x)("error","Something went wrong")}finally{b(),h(!1),y("delete")}},deleting:v,handleBulkUpdateStatus:async()=>{if((()=>{const e=a.every((e=>e.progress>=100));return e||(y("review"),(0,p.x)("error","Terdapat task dengan progress kurang dari 100%.")),e})()){j(!0);try{await((e,s)=>e.post("api/module/daily/change-status",{dailies:s}))(g,a.map((e=>{let{id:s,progress:a}=e;return{id:s,progress:a,status:"review"}}))),s(),(0,p.x)("success","Berhasil mengubah task ke Review!")}catch(e){(0,p.x)("error","Gagal mengubah status task")}finally{j(!1),b(),y("review")}}},handleBulkUpdateProgress:async()=>{if((()=>{const e=!a.some((e=>e.progress>=100));return e||(y("update"),(0,p.x)("error","Terdapat task dengan progress 100%.")),e})()){j(!0);try{await((e,s)=>e.put("api/module/daily/change-progress",{dailies:s}))(g,a.map((e=>{let{id:s}=e;return{id:s,progress:100}}))),s(),(0,p.x)("success","Task berhasil diubah menjadi 100%!")}catch(e){(0,p.x)("error","Gagal mengubah progress")}finally{j(!1),b(),y("update")}}},isLoading:x}},g=e=>{let{checked:s,action:a,disabled:i}=e;return console.log("Check",s),console.log("action",a),console.log("disabled",i),(0,o.jsx)("div",{className:"check-box ".concat(s&&!i?"checked":""," ").concat(i?"disabled":""),onClick:i?null:a,children:s&&(0,o.jsx)(d(),{icon:"check",className:"check-icon"})})},y=e=>{let{count:s,progressFn:a,reviewFn:i,deleteFn:l,cancelFn:n}=e;const[d,r]=(0,t.useState)(!1);return(0,o.jsxs)("div",{className:"check-menu-container",children:[(0,o.jsxs)("div",{className:"menu-title",children:[s," task terpilih"]}),(0,o.jsxs)("div",{className:"menu-body",children:[(0,o.jsx)("div",{className:"menu-item",children:!d&&(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(v,{actionFn:()=>{a()},color:"green",text:"Ubah Progress 100%",size:"sm"}),(0,o.jsx)(v,{actionFn:()=>{i()},color:"green",text:"Kirim Review",size:"sm"}),(0,o.jsx)(v,{actionFn:()=>{l()},color:"red",text:"Hapus",size:"sm"}),(0,o.jsx)(v,{actionFn:()=>{n()},color:"grey",text:"Batal",size:"sm"})]})}),(0,o.jsx)("div",{className:"menu-item",children:d&&(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(v,{actionFn:()=>{r(!1)},color:"grey",text:"Cancel",size:"sm"}),(0,o.jsx)(v,{actionFn:()=>{},color:"green",text:"Paste Task",size:"sm"})]})})]})]})};var b=a(87426);const f=e=>{let{color:s,taskId:a,progress:i,isChange:l,refetch:n}=e;const[d,r]=(0,t.useState)(!1),[c,u]=(0,t.useState)(i),[h,x]=(0,t.useState)(!1),j=(0,m.A)(),g=()=>{r((()=>!d))},y=async function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];x(!0);const s=[{id:a,progress:c,change_to_review:e}];await j.put("api/module/daily/change-progress",{dailies:s}).then((()=>{n(),g(),x(!1),(0,p.x)("success","Progress has been updated !")})).catch((()=>{g(),(0,p.x)("error","Something went wrong"),x(!1)}))};return(0,o.jsxs)("div",{className:"progress-container",children:[d&&(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("div",{className:"progress-popup-overlay",onClick:()=>{g(),u(i)}}),(0,o.jsx)("div",{className:"progress-popup",children:(0,o.jsxs)("div",{className:"progress-popup-body",children:[(0,o.jsxs)("div",{className:"input",children:[(0,o.jsx)("input",{type:"range",defaultValue:i,min:"0",max:"100",onChange:e=>{u(parseInt(e.target.value,10))}}),(0,o.jsxs)("span",{children:[c,"%"]})]}),h?(0,o.jsxs)("div",{className:"d-flex gap-2",children:[(0,o.jsx)(b.A,{color:"primary",size:"sm"}),(0,o.jsx)("span",{children:"Menyimpan..."})]}):c===i&&100!==i?(0,o.jsx)("span",{children:"Swipe for update progress"}):(0,o.jsxs)("div",{className:"d-flex gap-2",children:[100===c&&(0,o.jsx)(v,{color:"grey",size:"sm",text:"Kirim Ke Review",actionFn:()=>y(!0)}),(0,o.jsx)(v,{color:"green",size:"sm",text:"Simpan",actionFn:()=>y()})]})]})})]}),(0,o.jsxs)("div",{className:"progress-body ".concat(l?"change":""),onClick:l?g:null,children:[(0,o.jsx)("div",{className:"bar ".concat(s),style:{width:"".concat(i,"%")}}),(0,o.jsxs)("span",{children:[i,"%"]})]})]})},k=e=>{let{dateRange:s,isLate:a=!1}=e;return(0,o.jsxs)("div",{className:"timeline-container",children:[(0,o.jsx)(d(),{icon:"event"}),(0,o.jsx)("span",{className:a?"text-danger":"",children:s})]})},N="https://hr-api.ptpema.co.id/api/",w=e=>{let{data:s}=e;const[a,i]=(0,t.useState)(!1);return(0,o.jsxs)("div",{className:"members-container",children:[a&&(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("div",{className:"members-popup-overlay",onClick:()=>i(!1)}),(0,o.jsx)("div",{className:"members-popup",children:(0,o.jsxs)("div",{className:"members-popup-body",children:[(0,o.jsx)("div",{className:"members-popup-header",children:(0,o.jsxs)("div",{className:"members-popup-title",children:["Member",(null===s||void 0===s?void 0:s.length)>1?"s":""]})}),(0,o.jsx)("div",{className:"members-popup-content",children:(0,o.jsx)("div",{className:"members-list",children:null===s||void 0===s?void 0:s.map((e=>(0,o.jsxs)("div",{className:"members-list-item",children:[(0,o.jsxs)("div",{className:"members-person",children:[(0,o.jsx)("div",{className:"members-avatar",children:(0,o.jsx)("img",{src:"".concat(N,"employee/file?f=photo-profil&id=").concat(e.employe_id),alt:e.name})}),(0,o.jsxs)("div",{className:"members-info",children:[(0,o.jsx)("h4",{children:e.name}),(0,o.jsx)("span",{children:e.position_name})]})]}),(0,o.jsxs)("div",{className:"members-task",children:[(0,o.jsxs)("span",{children:[e.total_daily," Task"]}),(0,o.jsxs)("span",{children:[e.progress,"%"]})]})]},e.employe_id)))})})]})})]}),(0,o.jsx)("div",{className:"members-item",onClick:()=>i(!0),children:null===s||void 0===s?void 0:s.map((e=>(0,o.jsx)("div",{className:"ava-pic",children:(0,o.jsx)("img",{src:"".concat(N,"employee/file?f=photo-profil&id=").concat(e.employe_id),alt:e.name})},e.employe_id)))})]})},_=e=>{let{taskId:s,category:a,refetch:l,setIsNewTaskOpen:n}=e;const d=(0,m.A)(),[o,r]=(0,t.useState)([{taskId:s||null,activityName:"",category:a,startDate:"",endDate:""}]),[c,u]=(0,t.useState)(0),[v,h]=(0,t.useState)(!1),j=()=>{n((e=>!e)),u(0)};return{taskForms:o,isLoading:v,countCopy:c,toggleNewTask:j,handleCopyChange:e=>{const s=parseInt(e,10);if(Number.isNaN(s)||s<0||s>10)return;const a=s-(o.length-1);if(a>0){const e=o[0],s=Array.from({length:a},(()=>(0,i.A)({},e)));r([...o,...s])}else a<0&&r(o.slice(0,1+s));u(s)},handleChange:(e,s,a)=>{const i=[...o];i[e][s]=a,r(i)},deleteCopy:e=>{r((s=>s.filter(((s,a)=>a!==e)))),0!==e&&u((e=>Math.max(0,e-1)))},handleSubmit:async()=>{const e=o.flatMap(((e,s)=>x(e,s)));if(e.length>0)(0,p.x)("error",e.join("\n"));else{h(!0);try{const e=await((e,s)=>e.post("api/module/daily/store",{dailies:s}))(d,o);j(),(0,p.x)("success",e.data.message)}catch(s){j(),(0,p.x)("error","Something went wrong")}finally{l(),h(!1)}}}}},C=e=>{let{taskId:s,setIsNewTaskOpen:a,isNewTaskOpen:i,category:t,refetch:l}=e;const n=()=>{a(!i)},{isLoading:d,taskForms:r,countCopy:c,handleChange:u,handleCopyChange:h,deleteCopy:m,handleSubmit:p}=_({taskId:s,category:t,toggleNewTask:n,refetch:l,setIsNewTaskOpen:a});return(0,o.jsxs)(o.Fragment,{children:[d?(0,o.jsx)("div",{children:(0,o.jsxs)("div",{className:"d-flex justify-content-center align-items-center gap-2",children:[(0,o.jsx)(b.A,{color:"primary",size:"sm"})," ",(0,o.jsx)("span",{children:"Menyimpan task baru.."})]})}):(0,o.jsx)(o.Fragment,{children:(0,o.jsxs)("div",{className:"new-task-container",children:[(0,o.jsx)("div",{className:"new-task",children:r.map(((e,s)=>(0,o.jsxs)("div",{className:"task-form",children:[(0,o.jsx)("span",{children:0===s?"Task Baru":"Tersalin ".concat(s)}),(0,o.jsxs)("div",{className:"task-form-input",children:[(0,o.jsxs)("div",{className:"d-flex flex-column flex-grow-1",style:{width:"100%"},children:[(0,o.jsx)("span",{children:"Nama Aktivitas"}),(0,o.jsx)("textarea",{rows:"1",value:e.activityName,onChange:e=>u(s,"activityName",e.target.value)})]}),(0,o.jsxs)("div",{className:"d-flex flex-column flex-grow-1",children:[(0,o.jsx)("span",{children:"Tanggal Mulai"}),(0,o.jsx)("input",{type:"datetime-local",value:e.startDate,onChange:e=>u(s,"startDate",e.target.value)})]}),(0,o.jsxs)("div",{className:"d-flex flex-column flex-grow-1",children:[(0,o.jsx)("span",{children:"Tanggal Berakhir"}),(0,o.jsx)("input",{type:"datetime-local",value:e.endDate,onChange:e=>u(s,"endDate",e.target.value)})]})]}),0!==s&&(0,o.jsx)("div",{className:"task-form-action",children:(0,o.jsx)(v,{type:"button",icon:"close",color:"red",size:"sm",actionFn:()=>m(s)})})]},s)))}),(0,o.jsxs)("div",{className:"new-task-option-container",children:[(0,o.jsx)("div",{className:"new-task-option",children:(0,o.jsxs)("div",{className:"option-group",children:[(0,o.jsx)("span",{htmlFor:"copy",children:"Salin"}),(0,o.jsx)("input",{type:"number",id:"copy",value:c,min:"0",max:"10",onChange:e=>h(e.target.value)})]})}),(0,o.jsxs)("div",{className:"new-task-action",children:[(0,o.jsx)(v,{type:"button",text:"Batal",actionFn:n,color:"grey",size:"sm"}),(0,o.jsx)(v,{type:"button",text:d?"Loading...":"Simpan",color:"green",size:"sm",disabled:d,actionFn:()=>p()})]})]})]})})," "]})},S=e=>{let{task:s,refetch:a,setIsEditTaskOpen:l}=e;const n=(0,m.A)(),[d,o]=(0,t.useState)(!1),[r,c]=(0,t.useState)({id:"",activity_name:"",category:"",start_date:"",end_date:""});(0,t.useEffect)((()=>{s&&c({id:s.id,activity_name:s.activity_name||"",category:s.category||"non-rutin",start_date:"".concat(s.start_date.date.split("-").reverse().join("-"),"T").concat(s.start_date.time),end_date:"".concat(s.end_date.date.split("-").reverse().join("-"),"T").concat(s.end_date.time)})}),[s]);const u=()=>{l((e=>!e))};return{isLoading:d,toggleEditTask:u,handleChange:e=>{c((s=>(0,i.A)((0,i.A)({},s),{},{[e.target.name]:e.target.value})))},handleUpdate:async()=>{const e=x({id:r.id,activityName:r.activity_name,startDate:r.start_date,endDate:r.end_date},0);if(e.length>0)(0,p.x)("error",e.join("\n"));else{o(!0);try{const e=await((e,s)=>e.put("api/module/daily/update",s))(n,r);a(),u(),(0,p.x)("success",e.data.message)}catch(s){u(),(0,p.x)("error","Something went wrong sdsdfsds")}finally{o(!1)}}}}},F=e=>{let{task:s,setIsEditTaskOpen:a,isEditTaskOpen:i,refetch:t}=e;const l=()=>{a(!i)},{isLoading:n,handleChange:d,handleUpdate:r}=S({task:s,toggleEditTask:l,refetch:t,setIsEditTaskOpen:a}),c="".concat(s.start_date.date.split("-").reverse().join("-"),"T").concat(s.start_date.time),u="".concat(s.end_date.date.split("-").reverse().join("-"),"T").concat(s.end_date.time);return(0,o.jsx)(o.Fragment,{children:n?(0,o.jsx)("div",{className:"p-3",children:(0,o.jsxs)("div",{className:"d-flex justify-content-center align-items-center gap-2",children:[(0,o.jsx)(b.A,{color:"primary",size:"sm"}),(0,o.jsx)("span",{children:"Update task.."})]})}):(0,o.jsxs)("div",{className:"new-task-container",children:[(0,o.jsx)("div",{className:"new-task",children:(0,o.jsxs)("div",{className:"task-form",children:[(0,o.jsx)("span",{children:"Edit Task"})," ",(0,o.jsxs)("div",{className:"task-form-input",children:[(0,o.jsxs)("div",{className:"d-flex flex-column flex-grow-1",style:{width:"100%"},children:[(0,o.jsx)("span",{children:"Nama Aktivitas"})," ",(0,o.jsx)("textarea",{name:"activity_name",rows:"1",defaultValue:s.activity_name,onChange:e=>d(e)})]}),(0,o.jsxs)("div",{className:"d-flex flex-column flex-grow-1",children:[(0,o.jsx)("span",{children:"Tanggal Mulai"})," ",(0,o.jsx)("input",{name:"start_date",type:"datetime-local",defaultValue:c,onChange:e=>d(e)})]}),(0,o.jsxs)("div",{className:"d-flex flex-column flex-grow-1",children:[(0,o.jsx)("span",{children:"Tanggal Berakhir"})," ",(0,o.jsx)("input",{name:"end_date",type:"datetime-local",defaultValue:u,onChange:e=>d(e)})]})]})]})}),(0,o.jsxs)("div",{className:"new-task-option-container",children:[(0,o.jsx)("div",{className:"new-task-option"}),(0,o.jsxs)("div",{className:"new-task-action",children:[(0,o.jsx)(v,{type:"button",text:"Batal",actionFn:l,color:"grey",size:"sm"}),(0,o.jsx)(v,{type:"button",text:n?"Loading...":"Update",color:"green",size:"sm",disabled:n,actionFn:()=>r()})]})]})]})})},T=e=>{let{color:s,text:a}=e;return(0,o.jsx)("div",{className:"label-container ".concat(s),children:(0,o.jsx)("span",{className:"label-text",children:a})})},A=e=>{let{taskId:s,type:a,isChange:i,refetch:l}=e;const[n,d]=(0,t.useState)(!1),[r,c]=(0,t.useState)(a),[u,h]=(0,t.useState)(!1),x=(0,m.A)(),j=()=>d(!n);return(0,o.jsxs)("div",{className:"type-container",children:[n&&(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("div",{className:"type-popup-overlay",onClick:()=>{j(),c(a)}}),(0,o.jsx)("div",{className:"type-popup",children:(0,o.jsxs)("div",{className:"type-popup-body",children:[(0,o.jsx)("div",{className:"input",children:(0,o.jsxs)("select",{id:"typeSelect",value:r,onChange:e=>{c(e.target.value)},children:[(0,o.jsx)("option",{value:"0",children:"Biasa"}),(0,o.jsx)("option",{value:"1",children:"Mendesak"})]})}),u?(0,o.jsxs)("div",{className:"d-flex gap-2 align-items-center",children:[(0,o.jsx)(b.A,{color:"primary",size:"sm"}),(0,o.jsx)("span",{children:"Menyimpan..."})]}):(0,o.jsx)(v,{color:"green",size:"sm",text:"Simpan",actionFn:async()=>{h(!0),await x.put("api/module/daily/change-type",{id:s,is_priority:r}).then((()=>{l(),j(),h(!1),(0,p.x)("success","Tipe tugas berhasil diperbarui!")})).catch((()=>{(0,p.x)("error","Terjadi kesalahan, coba lagi."),h(!1)}))}})]})})]}),(0,o.jsx)("div",{className:"type-body ".concat("1"===a?"red":"info"," ").concat(i?"change":""),onClick:i?j:null,children:(0,o.jsx)("span",{children:"1"===a?(0,o.jsx)(T,{color:"red",text:"Mendesak"}):(0,o.jsx)(T,{color:"blue",text:"Biasa"})})})]})},z=e=>{let{menus:s,taskStatus:a,isLoading:i,isChange:l}=e;const[n,d]=(0,t.useState)(!1),r=l;return(0,o.jsxs)(o.Fragment,{children:[n&&(0,o.jsx)("div",{className:"more-menu-overlay",onClick:()=>d(!n)}),(0,o.jsxs)("div",{className:"more-menu",children:[(0,o.jsx)("div",{className:"menu-button ".concat(r?"active":""),onClick:()=>l?d(!n):"",children:i?(0,o.jsxs)("div",{className:"d-flex gap-2 align-items-center",children:[(0,o.jsx)(b.A,{animation:"border",size:"sm",color:"success"}),(0,o.jsx)("span",{children:"Loading.."})]}):(0,o.jsxs)(o.Fragment,{children:["in progress"===a&&(0,o.jsx)(T,{color:"yellow",text:"In Progress"}),"approved"===a&&(0,o.jsx)(T,{color:"green",text:"Done"}),(null===a||void 0===a?void 0:a.includes("review"))&&(0,o.jsx)(T,{color:"blue",text:"Review"}),"revised"===a&&(0,o.jsx)(T,{color:"red",text:"Revised"}),"cancelled"===a&&(0,o.jsx)(T,{color:"orange",text:"Cancelled"})]})}),n&&(0,o.jsx)(o.Fragment,{children:(0,o.jsx)("div",{className:"menu-list",children:null===s||void 0===s?void 0:s.map((e=>(0,o.jsx)("div",{className:"item",onClick:()=>{e.action(),d(!1)},children:e.name},e.id)))})})]})]})},L=e=>{let{notes:s=[]}=e;const[a,i]=(0,t.useState)(!1),[l,n]=(0,t.useState)([]),[d,r]=(0,t.useState)({}),c=(0,t.useRef)(null),u=(0,t.useRef)(null),h=()=>i((e=>!e));(0,t.useEffect)((()=>{if(a&&u.current){u.current.getBoundingClientRect().top<465?r({top:"calc(100% + ".concat(10,"px)"),bottom:"auto"}):r({bottom:"calc(100% + ".concat(10,"px)"),top:"auto"})}}),[a]),(0,t.useEffect)((()=>{const e=e=>{c.current&&!c.current.contains(e.target)&&u.current&&!u.current.contains(e.target)&&i(!1)};return a?document.addEventListener("mousedown",e):document.removeEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}}),[a]);return(0,o.jsxs)("div",{className:"notes-button-wrapper",children:[(0,o.jsx)("div",{ref:u,children:(0,o.jsx)(v,{actionFn:h,color:"grey",icon:"sticky_note_2",text:"",size:"sm",badge:(null===s||void 0===s?void 0:s.length)>0,badgeColor:"red",badgeCount:(null===s||void 0===s?void 0:s.length)||0})}),a&&(0,o.jsxs)("div",{ref:c,className:"notes-popup",style:d,children:[(0,o.jsxs)("div",{className:"notes-popup-header",children:[(0,o.jsxs)("span",{children:["Catatan (",(null===s||void 0===s?void 0:s.length)||0,")"]}),(0,o.jsx)("button",{type:"button",className:"close-btn",onClick:h,children:"\u2715"})]}),(null===s||void 0===s?void 0:s.length)>0?(0,o.jsx)("div",{className:"notes-list",children:null===s||void 0===s?void 0:s.map((e=>{var s;const a=null===l||void 0===l?void 0:l.includes(e.id),i=(null===e||void 0===e||null===(s=e.notes)||void 0===s?void 0:s.length)>100;return(0,o.jsxs)("div",{className:"note-item",children:[(0,o.jsxs)("div",{className:"note-date",children:[(0,o.jsx)("div",{className:"note-date-time",children:null===e||void 0===e?void 0:e.created_at}),(0,o.jsx)("div",{className:"note-activity",children:null===e||void 0===e?void 0:e.activity_name})]}),(0,o.jsx)("div",{className:"note-body",children:null!==e&&void 0!==e&&e.notes?(0,o.jsxs)(o.Fragment,{children:[(0,o.jsxs)("span",{className:"note-text ".concat(a?"expanded":""),title:null===e||void 0===e?void 0:e.notes,children:[a?null===e||void 0===e?void 0:e.notes:null===e||void 0===e?void 0:e.notes.slice(0,100),i&&!a&&"..."]}),i&&(0,o.jsx)("button",{type:"button",className:"see-more-btn",onClick:()=>{return s=null===e||void 0===e?void 0:e.id,void n((e=>e.includes(s)?e.filter((e=>e!==s)):[...e,s]));var s},children:a?"Sembunyikan":"Selengkapnya"})]}):(0,o.jsx)("span",{className:"note-empty",children:"Tidak ada catatan."})})]},e.id)}))}):(0,o.jsx)("div",{className:"no-note",children:"Belum ada catatan"})]})]})},E="120%",I=e=>{var s,a,i;let{daily:l,fileInputRef:n=null,handleUploadFile:r=null,handleDeleteFile:c=null,isLoadingDelete:u=!1,loadingDeleteId:h=null,isChange:m}=e;const[x,j]=(0,t.useState)(!1),[g,y]=(0,t.useState)({}),b=(0,t.useRef)(null),f=(0,t.useRef)(null);(0,t.useEffect)((()=>{if(x&&f.current){f.current.getBoundingClientRect().top<360?y({top:E,bottom:"auto"}):y({bottom:E,top:"auto"})}}),[x]),(0,t.useEffect)((()=>{const e=e=>{b.current&&!b.current.contains(e.target)&&j(!1)};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)}),[]);return(0,o.jsxs)("div",{className:"attachment-popup-wrapper",ref:b,children:[(0,o.jsx)("input",{type:"file",hidden:!0,ref:n,onChange:r,multiple:!0}),(0,o.jsx)("div",{ref:f,children:(0,o.jsx)(v,{actionFn:()=>{var e;(null===l||void 0===l||null===(e=l.attachments)||void 0===e?void 0:e.length)>0?j(!x):"in progress"!==(null===l||void 0===l?void 0:l.status)&&"revised"!==(null===l||void 0===l?void 0:l.status)||!m||n.current.click()},color:"grey",icon:"attach_file",text:"",size:"sm",badge:!0,badgeColor:(null===l||void 0===l||null===(s=l.attachments)||void 0===s?void 0:s.length)>0?"red":"grey",badgeCount:(null===l||void 0===l||null===(a=l.attachments)||void 0===a?void 0:a.length)||0})}),x&&(0,o.jsxs)("div",{className:"attachment-popup",style:g,children:[(null===l||void 0===l||null===(i=l.attachments)||void 0===i?void 0:i.length)>0?(0,o.jsx)("div",{className:"attachment-list",children:l.attachments.map((e=>(0,o.jsxs)("div",{className:"attachment-item",children:[(0,o.jsx)("span",{className:"attachment-name",title:e.original_name,children:e.original_name}),(0,o.jsx)("div",{className:"attachment-actions",children:(0,o.jsxs)("div",{className:"d-flex align-items-center justify-content-end gap-1",children:[(0,o.jsx)("a",{href:e.file_path,target:"_blank",rel:"noreferrer",title:"Lihat file",children:(0,o.jsx)(d(),{icon:"link",style:{fontSize:"22px"}})}),("in progress"===(null===l||void 0===l?void 0:l.status)||"revised"===(null===l||void 0===l?void 0:l.status))&&(0,o.jsx)("button",{type:"button",className:"delete-btn",title:"Hapus file",onClick:()=>c(e),disabled:h===(null===e||void 0===e?void 0:e.id)&&u,children:u&&h===e.id?"\u231b":(0,o.jsx)(d(),{icon:"delete",style:{fontSize:"22px"}})})]})})]},e.id||e.file_path)))}):(0,o.jsx)("div",{className:"no-file",children:"Belum ada file"}),"cancelled"!==(null===l||void 0===l?void 0:l.status)&&(0,o.jsx)("div",{className:"choose-file-btn",children:null!==l&&void 0!==l&&l.status.includes("review")?"":(0,o.jsx)(o.Fragment,{children:m&&(0,o.jsx)(v,{actionFn:()=>{"in progress"===(null===l||void 0===l?void 0:l.status)||"revised"===(null===l||void 0===l?void 0:l.status)?n.current.click():(0,p.x)("info","Task sudah selesai atau menunggu review, tidak bisa menambah lampiran.")},color:"primary",text:"Pilih File",size:"sm"})})})]})]})},R=e=>{var s,a,i,l,n,d,r,c;let{daily:u,isChecked:h,onCheck:x,refetch:j,activeTab:y}=e;const b=(0,m.A)(),N=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:768;const[s,a]=(0,t.useState)(window.innerWidth<e);return(0,t.useEffect)((()=>{const s=()=>{a(window.innerWidth<e)};return window.addEventListener("resize",s),()=>window.removeEventListener("resize",s)}),[e]),s}(),w=(0,t.useRef)(null),_=JSON.parse(localStorage.getItem("auth")),C=(null===_||void 0===_||null===(s=_.user)||void 0===s?void 0:s.roles)||[],S=C.some((e=>"Manager"===e)),T=C.some((e=>"Supervisor"===e)),[E,R]=(0,t.useState)(!1),[D,P]=(0,t.useState)(!1),[O,B]=(0,t.useState)(!1),M=()=>{R(!E)},U=async e=>{const s=[{id:null===u||void 0===u?void 0:u.id,progress:null===u||void 0===u?void 0:u.progress,status:e}];P(!0),await b.post("api/module/daily/change-status",{dailies:s}).then((()=>{j(),P(!1),(0,p.x)("success","Status task berhasil diubah!")})).catch((e=>{P(!1),(0,p.x)("error",e.response.data.message)}))},[W,K]=(0,t.useState)(!1),[q,J]=(0,t.useState)(0),H=async e=>{var s;const a=null===e||void 0===e||null===(s=e.target)||void 0===s?void 0:s.files;if(!a||0===(null===a||void 0===a?void 0:a.length))return;const i=new FormData;for(let t=0;t<(null===a||void 0===a?void 0:a.length);t++)i.append("files[]",a[t]);K(!0),await b.post("/api/daily/attachment/upload?daily_id=".concat(null===u||void 0===u?void 0:u.id),i,{headers:{"Content-Type":"multipart/form-data"},onUploadProgress:e=>{const s=Math.round(100*e.loaded/e.total);J(s)}}).then((()=>{J(0),j(),(0,p.x)("success","File berhasil diupload!")})).catch((e=>{var s,a;console.error(e),(0,p.x)("error",(null===(s=e.response)||void 0===s||null===(a=s.data)||void 0===a?void 0:a.message)||"Gagal upload file")})).finally((()=>{K(!1),e.target.value=""}))},[V,Y]=(0,t.useState)(!1),[G,Q]=(0,t.useState)(null),$=async e=>{e&&e.id&&(Q(null===e||void 0===e?void 0:e.id),Y(!0),await b.delete("api/daily/attachment/delete",{data:{id:null===e||void 0===e?void 0:e.id}}).then((()=>{(0,p.x)("success","File berhasil dihapus!")})).catch((e=>{(0,p.x)("error",e.response.data.message)})).finally((()=>{j(),Y(!1),Q(null)})))},Z=[{id:1,name:"Review",action:()=>{U("review")}},{id:2,name:"Cancel",action:()=>{U("cancelled")}}];return(0,o.jsxs)(o.Fragment,{children:[!N&&(0,o.jsx)("tr",{className:"desktop-view",children:E?(0,o.jsx)("td",{colSpan:"8",children:(0,o.jsx)(F,{task:u,setIsEditTaskOpen:R,isEditTaskOpen:E,refetch:j})}):(0,o.jsxs)(o.Fragment,{children:["dailies"===y&&(0,o.jsx)("td",{children:(0,o.jsx)("div",{style:{width:"0px"},children:(0,o.jsx)(g,{checked:h,action:x,disabled:(null===_||void 0===_||null===(a=_.user)||void 0===a?void 0:a.employe_id)!==(null===u||void 0===u?void 0:u.employe_id)})})}),(0,o.jsx)("td",{children:null===u||void 0===u?void 0:u.activity_name}),("review"===y||"approved"===y)&&(0,o.jsx)("td",{children:(0,o.jsx)("div",{className:"created_by",style:{display:"inline-block",background:"#eef5ff",padding:"4px 10px",borderRadius:"20px",fontSize:"8px",fontWeight:"600",color:"#1766d1",border:"1px solid #cfe1ff",whiteSpace:"nowrap"},children:null===u||void 0===u?void 0:u.created_by})}),(0,o.jsx)("td",{children:(0,o.jsx)("div",{style:{display:"flex",justifyContent:"center"},children:(0,o.jsx)(A,{taskId:null===u||void 0===u?void 0:u.id,type:null===u||void 0===u?void 0:u.is_priority.toString(),isChange:"in progress"===(null===u||void 0===u?void 0:u.status)||"revised"===(null===u||void 0===u?void 0:u.status)||(S||T)&&(null===u||void 0===u?void 0:u.status.includes("review")),refetch:j})})}),(0,o.jsx)("td",{children:(0,o.jsx)("div",{style:{display:"flex",justifyContent:"center"},children:(0,o.jsx)(f,{color:null!==u&&void 0!==u&&u.status.includes("review")?"blue":"approved"===(null===u||void 0===u?void 0:u.status)?"green":"yellow",taskId:null===u||void 0===u?void 0:u.id,progress:null===u||void 0===u?void 0:u.progress,isChange:("in progress"===(null===u||void 0===u?void 0:u.status)||"revised"===(null===u||void 0===u?void 0:u.status))&&(null===_||void 0===_||null===(i=_.user)||void 0===i?void 0:i.employe_id)===(null===u||void 0===u?void 0:u.employe_id),refetch:j})})}),(0,o.jsx)("td",{children:(0,o.jsx)(k,{dateRange:null===u||void 0===u?void 0:u.date_range})}),(0,o.jsx)("td",{children:(0,o.jsx)(z,{menus:Z,taskStatus:null===u||void 0===u?void 0:u.status,isLoading:D,refetch:j,isChange:"in progress"===(null===u||void 0===u?void 0:u.status)||"revised"===(null===u||void 0===u?void 0:u.status)})}),(0,o.jsx)("td",{colSpan:"2",children:(0,o.jsxs)("div",{style:{display:"flex",gap:"5px",justifyContent:"end"},children:[(0,o.jsx)(L,{notes:null===u||void 0===u?void 0:u.logs}),W?(0,o.jsxs)("div",{className:"position-relative d-inline-flex align-items-center justify-content-center",style:{width:"28px",height:"28px"},children:[(0,o.jsx)("div",{className:"spinner-border text-primary position-absolute",role:"status",style:{width:"28px",height:"28px",borderWidth:"3px"},children:(0,o.jsx)("span",{className:"visually-hidden",children:"Loading..."})}),(0,o.jsxs)("strong",{className:"position-absolute text-primary",style:{fontSize:"8px"},children:[q,"%"]})]}):(0,o.jsx)(o.Fragment,{children:(0,o.jsx)(I,{daily:u,fileInputRef:w,handleUploadFile:H,handleDeleteFile:$,isLoadingDelete:V,loadingDeleteId:G,isChange:("in progress"===(null===u||void 0===u?void 0:u.status)||"revised"===(null===u||void 0===u?void 0:u.status))&&(null===_||void 0===_||null===(l=_.user)||void 0===l?void 0:l.employe_id)===(null===u||void 0===u?void 0:u.employe_id)})}),(null===u||void 0===u?void 0:u.employe_id)===(null===_||void 0===_||null===(n=_.user)||void 0===n?void 0:n.employe_id)&&(0,o.jsx)(o.Fragment,{children:(0,o.jsx)(v,{actionFn:"approved"===(null===u||void 0===u?void 0:u.status)||null!==u&&void 0!==u&&u.status.includes("review")?void 0:M,color:"grey",icon:"edit_document",text:"",size:"sm",disabled:"approved"===(null===u||void 0===u?void 0:u.status)})})]})})]})}),N&&(0,o.jsx)("tr",{className:"mobile-view",children:E?(0,o.jsx)("td",{colSpan:"2",children:(0,o.jsx)(F,{task:u,setIsEditTaskOpen:R,isEditTaskOpen:E,refetch:j})}):(0,o.jsx)("td",{colSpan:"2",children:(0,o.jsxs)("div",{className:"task-item-wrapper",children:[(0,o.jsxs)("div",{className:"task-item-header",children:[(0,o.jsxs)("div",{className:"task-item-title-group",children:["dailies"===y&&(0,o.jsx)("div",{className:"task-item-check",children:(0,o.jsx)(g,{checked:h,action:x})}),(0,o.jsx)("span",{className:"task-item-activity-name",children:null===u||void 0===u?void 0:u.activity_name})]}),(0,o.jsx)("div",{className:"task-item-progress-mobile",children:(0,o.jsx)(f,{color:null!==u&&void 0!==u&&u.status.includes("review")?"blue":"approved"===(null===u||void 0===u?void 0:u.status)?"green":"yellow",taskId:null===u||void 0===u?void 0:u.id,progress:null===u||void 0===u?void 0:u.progress,isChange:("in progress"===(null===u||void 0===u?void 0:u.status)||"revised"===(null===u||void 0===u?void 0:u.status))&&(null===_||void 0===_||null===(d=_.user)||void 0===d?void 0:d.employe_id)===(null===u||void 0===u?void 0:u.employe_id),refetch:j})})]}),(0,o.jsx)("div",{className:"task-item-timeline-mobile",children:(0,o.jsx)(k,{dateRange:null===u||void 0===u?void 0:u.date_range})}),(0,o.jsx)("hr",{}),(0,o.jsxs)("div",{className:"task-item-actions-group",children:[(0,o.jsxs)("div",{className:"task-item-status-group",children:[(0,o.jsx)(A,{taskId:null===u||void 0===u?void 0:u.id,type:null===u||void 0===u?void 0:u.is_priority.toString(),isChange:"in progress"===(null===u||void 0===u?void 0:u.status)||"revised"===(null===u||void 0===u?void 0:u.status)||(S||T)&&(null===u||void 0===u?void 0:u.status.includes("review")),refetch:j}),(0,o.jsx)(z,{menus:Z,taskStatus:null===u||void 0===u?void 0:u.status,isLoading:D,refetch:j,isChange:"in progress"===(null===u||void 0===u?void 0:u.status)||"revised"===(null===u||void 0===u?void 0:u.status)})]}),(0,o.jsx)(v,{actionFn:()=>{B(!O)},color:"grey",icon:"more_horiz",text:"",size:"sm"})]}),O&&(0,o.jsxs)("div",{className:"task-item-secondary-actions",children:[(0,o.jsx)(L,{notes:null===u||void 0===u?void 0:u.logs}),W?(0,o.jsxs)("div",{className:"position-relative d-inline-flex align-items-center justify-content-center",style:{width:"28px",height:"28px"},children:[(0,o.jsx)("div",{className:"spinner-border text-primary position-absolute",role:"status",style:{width:"28px",height:"28px",borderWidth:"3px"},children:(0,o.jsx)("span",{className:"visually-hidden",children:"Loading..."})}),(0,o.jsxs)("strong",{className:"position-absolute text-primary",style:{fontSize:"8px"},children:[q,"%"]})]}):(0,o.jsx)(o.Fragment,{children:(0,o.jsx)(I,{daily:u,fileInputRef:w,handleUploadFile:H,handleDeleteFile:$,isLoadingDelete:V,loadingDeleteId:G,isChange:("in progress"===(null===u||void 0===u?void 0:u.status)||"revised"===(null===u||void 0===u?void 0:u.status))&&(null===_||void 0===_||null===(r=_.user)||void 0===r?void 0:r.employe_id)===(null===u||void 0===u?void 0:u.employe_id)})}),(null===u||void 0===u?void 0:u.employe_id)===(null===_||void 0===_||null===(c=_.user)||void 0===c?void 0:c.employe_id)&&(0,o.jsx)(o.Fragment,{children:(0,o.jsx)(v,{actionFn:"approved"===(null===u||void 0===u?void 0:u.status)||null!==u&&void 0!==u&&u.status.includes("review")?void 0:M,color:"grey",icon:"edit_document",text:"",size:"sm",disabled:"approved"===(null===u||void 0===u?void 0:u.status)})})]})]})})})]})},D=e=>{let{isOpen:s,loading:a,handleConfirm:i,toggle:t,title:l,message:n,btnType:d}=e;return s&&(0,o.jsx)(o.Fragment,{children:(0,o.jsxs)("div",{className:"popup-container",children:[(0,o.jsx)("div",{className:"popup-overlay",onClick:a?null:()=>t()}),(0,o.jsxs)("div",{className:"popup-confirmation",children:[(0,o.jsx)("h6",{className:"fw-bold",children:l}),(0,o.jsx)("hr",{style:{marginTop:"0px"}}),(0,o.jsx)("p",{children:n}),(0,o.jsxs)("div",{className:"action",children:[(0,o.jsx)("button",{type:"button",className:"btn ".concat(d," btn-sm rounded-3"),onClick:()=>i(),disabled:a,children:a?(0,o.jsxs)("div",{children:[(0,o.jsx)(b.A,{size:"sm",color:"light"}),"Loading.."]}):"Ya"}),!a&&(0,o.jsx)("button",{type:"button",className:"btn btn-outline-secondary btn-sm rounded-3",onClick:()=>t(),disabled:a,children:"Tidak"})]})]})]})})},P=e=>{var s,a,i;let{task:l,title:n,category:d,refetch:r,selectedStaff:c,activeTab:u}=e;const h=JSON.parse(localStorage.getItem("auth")),{handleCheckItem:m,handleCheckForAll:p,isAllChecked:x,selectedTasks:b,resetSelection:N,togglePopup:_,visiblePopup:S,handleDelete:F,deleting:T,handleBulkUpdateStatus:A,handleBulkUpdateProgress:z,isLoading:L,isNewTaskOpen:E,setIsNewTaskOpen:I}=j(l,r),P=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:768;const[s,a]=(0,t.useState)(window.innerWidth<e);return(0,t.useEffect)((()=>{const s=()=>{a(window.innerWidth<e)};return window.addEventListener("resize",s),()=>window.removeEventListener("resize",s)}),[e]),s}(768)?1:3;return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("div",{className:"task-card-container",children:(0,o.jsx)("table",{className:"task-card",children:(0,o.jsxs)("tbody",{children:[(0,o.jsxs)("tr",{className:"task-parent",children:[(0,o.jsx)("td",{className:"task-card-title",colSpan:P,children:(null===l||void 0===l?void 0:l.task_title)||n}),(0,o.jsx)("td",{className:"progress-desktop",children:(0,o.jsx)("div",{className:"d-flex align-items-center justify-content-center",children:(0,o.jsx)(f,{color:"blue",progress:null===l||void 0===l?void 0:l.task_progress})})}),(0,o.jsx)("td",{children:(0,o.jsx)(k,{dateRange:null===l||void 0===l?void 0:l.date_range,isLate:null===l||void 0===l?void 0:l.is_late})}),(0,o.jsx)("td",{colSpan:"2",children:(0,o.jsx)(w,{data:null===l||void 0===l?void 0:l.members})}),(0,o.jsx)("td",{children:(0,o.jsxs)("div",{className:"button-add",children:[(0,o.jsx)("div",{className:"d-md-none",children:(0,o.jsx)(w,{data:null===l||void 0===l?void 0:l.members})}),!E&&"dailies"===u&&(0,o.jsx)(o.Fragment,{children:(null===c||void 0===c?void 0:c.employe_id)===(null===h||void 0===h||null===(s=h.user)||void 0===s?void 0:s.employe_id)&&(0,o.jsx)("div",{className:"d-flex gap-2 justify-content-end ".concat(x?"d-none":""),children:(0,o.jsx)(v,{actionFn:()=>I(!0),color:"green",icon:"add",size:"sm"})})})]})})]}),(0,o.jsxs)("tr",{className:"mobile-display",children:[(0,o.jsx)("td",{children:(0,o.jsx)(k,{dateRange:null===l||void 0===l?void 0:l.date_range})}),(0,o.jsx)("td",{children:(0,o.jsx)("div",{className:"d-flex align-items-center justify-content-end",children:(0,o.jsx)(f,{color:"blue",progress:null===l||void 0===l?void 0:l.task_progress})})})]}),E?(0,o.jsx)("tr",{children:(0,o.jsx)("td",{colSpan:"8",children:(0,o.jsx)(C,{taskId:null===l||void 0===l?void 0:l.task_id,setIsNewTaskOpen:I,isNewTaskOpen:E,category:d,refetch:r})})}):(0,o.jsx)(o.Fragment,{children:(0,o.jsxs)("tr",{className:"task-column d-none d-md-table-row ".concat(x||null!==b&&void 0!==b&&b.length?"bg-white":""),children:["dailies"===u&&(0,o.jsx)("td",{width:"30",children:(0,o.jsx)(g,{checked:(null===b||void 0===b?void 0:b.length)>0,action:p})}),(null===b||void 0===b?void 0:b.length)>0?(0,o.jsx)(o.Fragment,{children:(0,o.jsx)("td",{colSpan:"7",children:(0,o.jsx)(y,{count:null===b||void 0===b?void 0:b.length,progressFn:()=>_("update"),reviewFn:()=>_("review"),deleteFn:()=>_("delete"),cancelFn:N})})}):(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("td",{children:"Nama Task"}),("review"===u||"approved"===u)&&(0,o.jsx)("td",{children:"PIC"}),(0,o.jsx)("td",{style:{textAlign:"center"},children:"Tipe"}),(0,o.jsx)("td",{style:{textAlign:"center"},children:"Progress"}),(0,o.jsx)("td",{children:"Jadwal"}),(0,o.jsx)("td",{children:"Status"}),(0,o.jsx)("td",{colSpan:"2"})]})]})}),null!==l&&void 0!==l&&null!==(a=l.daily)&&void 0!==a&&a.length?null===l||void 0===l||null===(i=l.daily)||void 0===i?void 0:i.map((e=>(0,o.jsx)(R,{daily:e,isChecked:null===b||void 0===b?void 0:b.some((s=>{let{id:a}=s;return a===e.id})),onCheck:()=>m(e),refetch:r,activeTab:u},e.id))):(0,o.jsx)(o.Fragment,{children:!E&&(0,o.jsx)("tr",{children:(0,o.jsx)("td",{colSpan:"8",className:"text-center",children:"Tidak Ada Task"})})})]})})}),(0,o.jsx)(D,{isOpen:S.delete,loading:T,toggle:()=>_("delete"),handleConfirm:F,btnType:"btn-danger",title:"Konfirmasi",message:"Apakah Kamu yakin akan menghapus ".concat(null===b||void 0===b?void 0:b.length," task ini?")}),(0,o.jsx)(D,{isOpen:S.update,loading:L,toggle:()=>_("update"),handleConfirm:z,btnType:"btn-success",title:"Konfirmasi",message:"".concat(null===b||void 0===b?void 0:b.length," task akan diubah menjadi 100%?")}),(0,o.jsx)(D,{isOpen:S.review,loading:L,toggle:()=>_("review"),handleConfirm:A,btnType:"btn-success",title:"Konfirmasi",message:"".concat(null===b||void 0===b?void 0:b.length," task akan direview?")})]})},O=e=>{let{filters:s,onProjectAdditionalDetailChange:a,selectedStaff:l,activeTab:n}=e;const d=(0,m.A)(),[r,c]=(0,t.useState)(!1),[p,x]=(0,t.useState)(""),[j,g]=(0,t.useState)(1);let y="",b="";"approved"===n&&(y="api/daily/tambahan/approved-list",b="year=".concat(null===s||void 0===s?void 0:s.tahun,"&month=").concat(null===s||void 0===s?void 0:s.bulan,"&category=").concat(("all"===s.kategori?"":s.kategori)||"","&is_priority=").concat(("all"===(null===s||void 0===s?void 0:s.is_priority)?"":"mendesak"===(null===s||void 0===s?void 0:s.is_priority)?"true":"false")||"")),"dailies"===n&&(y="api/module/daily/by-category/tambahan",b="year=".concat(null===s||void 0===s?void 0:s.tahun,"&month=").concat(null===s||void 0===s?void 0:s.bulan,"&category=").concat(("all"===s.kategori?"":s.kategori)||"","&sort=").concat(("all"===(null===s||void 0===s?void 0:s.sort)?"":null===s||void 0===s?void 0:s.sort)||"","&is_priority=").concat(("all"===(null===s||void 0===s?void 0:s.is_priority)?"":"mendesak"===(null===s||void 0===s?void 0:s.is_priority)?"true":"false")||"","&employe_id=").concat(null===s||void 0===s?void 0:s.employe_id));const{data:f,isLoading:k,error:N,refetch:w}=(0,u.I)({queryKey:["tambahan-list",s],queryFn:()=>d.get("".concat(y,"?").concat(b)).then((e=>e.data))});(0,t.useEffect)((()=>{g(1)}),[s,p]),(0,t.useEffect)((()=>{a({totalAdditional:(null===f||void 0===f?void 0:f.total)||0})}),[f,s,a]);const _=e=>{x(e)},C=(0,t.useMemo)((()=>{var e;if(null===f||void 0===f||!f.data)return{paginatedDaily:[],totalPages:0};const s=f.data,a=(null===s||void 0===s||null===(e=s.daily)||void 0===e?void 0:e.filter((e=>{var s;const a=p.toLowerCase();return null===(s=e.activity_name)||void 0===s?void 0:s.toLowerCase().includes(a)})))||[],i=a.length,t=Math.ceil(i/5),l=5*(j-1),n=l+5;return{taskData:s,paginatedDaily:a.slice(l,n),totalPages:t}}),[f,p,j]),{taskData:S,paginatedDaily:F,totalPages:T}=C,A=(0,t.useMemo)((()=>(0,i.A)((0,i.A)({},S),{},{daily:F})),[S,F]),z=e=>{e>=1&&e<=T&&g(e)};return(0,o.jsx)(o.Fragment,{children:k?(0,o.jsx)("div",{children:"Loading..."}):N?(0,o.jsxs)("div",{children:["Error: ",N.message]}):(0,o.jsx)(o.Fragment,{children:("all"===s.kategori||"tambahan"===s.kategori)&&(0,o.jsxs)("div",{className:"daily-card project mb-3",children:[(0,o.jsxs)("div",{className:"card-header",children:[(0,o.jsx)("div",{className:"header-title",children:(0,o.jsx)("h4",{children:"Tugas Tambahan"})}),(0,o.jsxs)("div",{className:"header-action",children:[(0,o.jsx)("div",{className:"search-desktop",children:(0,o.jsx)(h,{value:p||"",onChange:e=>_(e.target.value)})}),(0,o.jsx)("div",{className:"search-mobile-icon",children:(0,o.jsx)(v,{color:"grey",icon:r?"close":"search",type:"button",actionFn:()=>{c((e=>!e))}})})]})]}),r&&(0,o.jsx)("div",{className:"mobile-search-bar",children:(0,o.jsx)(h,{value:p||"",onChange:e=>_(e.target.value)})}),(0,o.jsx)("div",{className:"card-body",children:("all"===s.kategori||"tambahan"===s.kategori)&&(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(P,{title:"Tugas Tambahan",task:A,refetch:w,category:"tambahan",selectedStaff:l,activeTab:n}),T>1&&(0,o.jsx)("nav",{className:"d-flex justify-content-end mb-2",children:(0,o.jsxs)("ul",{className:"pagination pagination-sm",children:[(0,o.jsx)("li",{className:"page-item ".concat(1===j?"disabled":""),children:(0,o.jsx)("button",{type:"button",className:"page-link",onClick:()=>z(j-1),children:"\xab"})}),Array.from({length:T},((e,s)=>s+1)).map((e=>(0,o.jsx)("li",{className:"page-item ".concat(e===j?"active":""),style:{zIndex:"0"},children:(0,o.jsx)("button",{type:"button",className:"page-link",onClick:()=>z(e),children:e})},e))),(0,o.jsx)("li",{className:"page-item ".concat(j===T?"disabled":""),children:(0,o.jsx)("button",{type:"button",className:"page-link",onClick:()=>z(j+1),children:"\xbb"})})]})})]})})]})})})},B=e=>{var s;let{filters:a,onProjectDetailChange:l,selectedStaff:n,activeTab:d}=e;const r=(0,m.A)(),[c,p]=(0,t.useState)({}),[x,j]=(0,t.useState)({});let g="",y="";"approved"===d&&(g="api/daily/list-by-employee/approved-list",y="year=".concat(null===a||void 0===a?void 0:a.tahun,"&month=").concat(null===a||void 0===a?void 0:a.bulan,"&category=").concat(("all"===a.kategori?"":a.kategori)||"","&is_priority=").concat(("all"===(null===a||void 0===a?void 0:a.is_priority)?"":"mendesak"===(null===a||void 0===a?void 0:a.is_priority)?"true":"false")||"")),"dailies"===d&&(g="api/daily/list-by-employee",y="year=".concat(null===a||void 0===a?void 0:a.tahun,"&month=").concat(null===a||void 0===a?void 0:a.bulan,"&category=").concat(("all"===(null===a||void 0===a?void 0:a.kategori)?"":null===a||void 0===a?void 0:a.kategori)||"","&type=").concat(("all"===(null===a||void 0===a?void 0:a.tipe)?"":null===a||void 0===a?void 0:a.tipe)||"","&sort=").concat(("all"===(null===a||void 0===a?void 0:a.sort)?"":null===a||void 0===a?void 0:a.sort)||"","&is_priority=").concat(("mendesak"===(null===a||void 0===a?void 0:a.is_priority)?"true":"biasa"===(null===a||void 0===a?void 0:a.is_priority)&&"false")||"","&employe_id=").concat(null===a||void 0===a?void 0:a.employe_id));const{data:b,isLoading:f,error:N,refetch:w}=(0,u.I)({queryKey:["daily-list-all",a],queryFn:async()=>(await r.get("".concat(g,"?").concat(y))).data}),_=(0,t.useMemo)((()=>{var e;if(!b)return{projects:[],totalDaily:0};let s=0;return{projects:null===b||void 0===b||null===(e=b.data)||void 0===e?void 0:e.map((e=>{const a=(x[e.project_id]||"").toLowerCase();let t=e.project_task||[],l=e.project_review||[];a&&(t=t.filter((e=>{var s;return null===(s=e.task_title)||void 0===s?void 0:s.toLowerCase().includes(a)})),l=l.filter((e=>{var s;return null===(s=e.task_title)||void 0===s?void 0:s.toLowerCase().includes(a)})));const n=t.reduce(((e,s)=>e+(s.total_daily_count||0)),0);return s+=n,(0,i.A)((0,i.A)({},e),{},{project_task:t,project_review:l})})),totalDaily:s}}),[b,x,a]),[C,S]=(0,t.useState)(!1),F=(e,s)=>{j((a=>(0,i.A)((0,i.A)({},a),{},{[e]:s})))},T=(e,s)=>{p((a=>(0,i.A)((0,i.A)({},a),{},{[e]:s})))};return(0,t.useEffect)((()=>{l({totalProject:(null===b||void 0===b?void 0:b.total)||0,totalDaily:(null===_||void 0===_?void 0:_.totalDaily)||0,formattedEmploye:null===b||void 0===b?void 0:b.formattedEmploye})}),[b,a,_]),(0,o.jsx)(o.Fragment,{children:f?(0,o.jsx)("div",{children:"Loading..."}):N?(0,o.jsxs)("div",{children:["Error: ",N.message]}):0===_.length?(0,o.jsx)("div",{className:"text-gray-500 italic p-2 text-center",children:"Tidak ada project."}):null===_||void 0===_||null===(s=_.projects)||void 0===s?void 0:s.map((e=>{var s;return(0,o.jsxs)("div",{className:"daily-card project mb-3",children:[(0,o.jsxs)("div",{className:"card-header",children:[(0,o.jsxs)("div",{className:"header-title",children:[(0,o.jsx)("h4",{children:e.project_name}),(0,o.jsxs)("div",{className:"title-attribute",children:[(0,o.jsx)(k,{dateRange:e.date_range,isLate:e.is_late}),(0,o.jsxs)("div",{className:"attribute-item",children:[(0,o.jsx)("span",{children:e.total_task}),(0,o.jsx)("span",{children:"Task"})]})]})]}),(0,o.jsxs)("div",{className:"header-action",children:[(0,o.jsx)("div",{className:"search-desktop",children:(0,o.jsx)(h,{value:x[e.project_id]||"",onChange:s=>F(e.project_id,s.target.value)})}),(0,o.jsx)("div",{className:"search-mobile-icon",children:(0,o.jsx)(v,{color:"grey",icon:C?"close":"search",type:"button",actionFn:()=>{S((e=>!e))}})})]})]}),C&&(0,o.jsx)("div",{className:"mobile-search-bar",children:(0,o.jsx)(h,{value:x[e.project_id]||"",onChange:s=>F(e.project_id,s.target.value)})}),(0,o.jsx)("div",{className:"card-body",children:0===(null===e||void 0===e||null===(s=e.project_task)||void 0===s?void 0:s.length)?(0,o.jsx)("div",{className:"p-2 text-center",children:"Tidak ada task."}):null===e||void 0===e?void 0:e.project_task.map((e=>{const s=e.daily||[],a=Math.ceil(s.length/5),l=c[e.task_id]||1,r=5*(l-1),u=r+5,v=s.slice(r,u);return(0,o.jsxs)(t.Fragment,{children:[(0,o.jsx)(P,{task:(0,i.A)((0,i.A)({},e),{},{daily:v}),category:"non-rutin",refetch:w,selectedStaff:n,activeTab:d}),a>1&&(0,o.jsx)("nav",{className:"d-flex justify-content-end mb-2",style:{zIndex:"0"},children:(0,o.jsxs)("ul",{className:"pagination pagination-sm",children:[(0,o.jsx)("li",{className:"page-item ".concat(1===l?"disabled":""),children:(0,o.jsx)("button",{type:"button",className:"page-link",onClick:()=>T(e.task_id,l-1),children:"\xab"})}),Array.from({length:a},((e,s)=>s+1)).map((s=>(0,o.jsx)("li",{className:"page-item ".concat(s===l?"active":""),style:{zIndex:"0"},children:(0,o.jsx)("button",{type:"button",className:"page-link",onClick:()=>T(e.task_id,s),children:s})},s))),(0,o.jsx)("li",{className:"page-item ".concat(l===a?"disabled":""),children:(0,o.jsx)("button",{type:"button",className:"page-link",onClick:()=>T(e.task_id,l+1),children:"\xbb"})})]})})]},e.task_id)}))})]},e.project_id)}))})};var M=a(29820);const U="https://hr-api.ptpema.co.id/api/",W=e=>{let{handleFilterChange:s,onSelectedStaffLoaded:a}=e;const i=(0,m.A)(),{data:l}=(0,u.I)({queryKey:["assignment-list"],queryFn:async()=>(await i.get("api/daily/assignment-list")).data}),[n,d]=(0,t.useState)(),[r,c]=(0,t.useState)([]);(0,t.useEffect)((()=>{if(l){const e=null===l||void 0===l?void 0:l.saya;d(e),c(null===l||void 0===l?void 0:l.list_bawahan)}}),[l]);const[v,h]=(0,t.useState)(!1),[p,x]=(0,t.useState)(null),j=(0,t.useRef)(null),[g,y]=(0,t.useState)(""),b=null===n||void 0===n?void 0:n.employe_id,f=((null===r||void 0===r?void 0:r.filter((e=>e.employe_id!==b)))||[]).filter((e=>{var s;return null===(s=e.first_name)||void 0===s?void 0:s.toLowerCase().includes(g.toLowerCase())})),k=p||n||(r.length>0?r[0]:null),N=e=>{x(e),s("employe_id",e.employe_id),h(!1),a(e)};return(0,t.useEffect)((()=>{(n||r.length>0)&&a(k)}),[n,r,a]),(0,t.useEffect)((()=>{const e=e=>{j.current&&!j.current.contains(e.target)&&h(!1)};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)}),[]),(0,o.jsxs)(o.Fragment,{children:[(0,o.jsxs)("div",{className:"dropdown-wrapper",ref:j,style:{position:"relative"},children:[(0,o.jsxs)("div",{className:"card-person dropdown",onClick:()=>r.length>0?h(!v):null,children:[(0,o.jsx)("img",{src:null!==k&&void 0!==k&&k.image?"".concat(U,"employee/file?f=photo-profil&id=").concat(null===k||void 0===k?void 0:k.employe_id):M,className:"rounded-circle",alt:"avatar",width:"38",height:"38"}),(0,o.jsxs)("div",{className:"person-info ms-2 text-start",children:[(0,o.jsxs)("h6",{className:"mb-0",children:[(null===k||void 0===k?void 0:k.first_name)||"-",r.length>0&&(0,o.jsx)("span",{className:"ms-1 transition-transform ".concat(v?"rotate-180":""),style:{fontSize:"0.8rem"},children:"\u25bc"})]}),(0,o.jsx)("span",{className:"text-muted",children:(null===k||void 0===k?void 0:k.position_name)||"-"})]})]}),v&&(0,o.jsxs)("div",{className:"custom-dropdown",children:[(0,o.jsx)("div",{className:"dropdown-search",children:(0,o.jsx)("input",{type:"search",placeholder:"Cari...",value:g,onChange:e=>y(e.target.value)})}),(0,o.jsxs)("div",{className:"dropdown-list",children:[n&&(0,o.jsxs)("div",{className:"dropdown-person-item self-item ".concat((null===k||void 0===k?void 0:k.employe_id)===n.employe_id?"active":""),onClick:()=>N(n),children:[(0,o.jsx)("img",{src:null!==n&&void 0!==n&&n.image?"".concat(U,"employee/file?f=photo-profil&id=").concat(null===n||void 0===n?void 0:n.employe_id):M,className:"rounded-circle",alt:"avatar",width:"32",height:"32"}),(0,o.jsxs)("div",{className:"person-info ms-2 text-start",children:[(0,o.jsxs)("h6",{className:"mb-0",children:[n.first_name," ",(0,o.jsx)("span",{className:"self-label",children:"(Saya)"})]}),(0,o.jsx)("span",{className:"text-muted",children:n.position_name})]})]}),n&&(0,o.jsx)("div",{className:"dropdown-divider"}),f.length>0?f.map((e=>(0,o.jsxs)("div",{className:"dropdown-person-item ".concat((null===k||void 0===k?void 0:k.employe_id)===e.employe_id?"active":""),onClick:()=>N(e),children:[(0,o.jsx)("img",{src:null!==e&&void 0!==e&&e.image?"".concat(U,"employee/file?f=photo-profil&id=").concat(null===e||void 0===e?void 0:e.employe_id):M,className:"rounded-circle",alt:"avatar",width:"32",height:"32"}),(0,o.jsxs)("div",{className:"person-info ms-2 text-start",children:[(0,o.jsx)("h6",{className:"mb-0",children:e.first_name}),(0,o.jsx)("span",{className:"text-muted",children:e.position_name})]})]},e.employe_id))):(0,o.jsx)("div",{className:"no-result text-center",children:"Tidak ditemukan"})]})]})]})," "]})},K=e=>{let{isOpen:s,togglePopup:a,title:i,children:t,closeButton:l}=e;return s&&(0,o.jsx)(o.Fragment,{children:(0,o.jsxs)("div",{className:"popup-container",children:[(0,o.jsx)("div",{className:"popup-overlay"}),(0,o.jsxs)("div",{className:"popup",children:[(0,o.jsx)("h6",{className:"fw-bold",children:i}),(l||void 0===l)&&(0,o.jsx)("div",{className:"popup-close",children:(0,o.jsx)(d(),{icon:"close",onClick:()=>a()})}),(0,o.jsx)("hr",{style:{marginTop:"0px"}}),t]})]})})},q=e=>{var s,a,i;let{daily:l,refetch:n}=e;const d=(0,m.A)(),r=JSON.parse(localStorage.getItem("auth")),c=(null===r||void 0===r||null===(s=r.user)||void 0===s?void 0:s.roles)||[],u=c.some((e=>"Manager"===e)),h=c.some((e=>"Supervisor"===e)),x=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:768;const[s,a]=(0,t.useState)(window.innerWidth<e);return(0,t.useEffect)((()=>{const s=()=>{a(window.innerWidth<e)};return window.addEventListener("resize",s),()=>window.removeEventListener("resize",s)}),[e]),s}(),[j,g]=(0,t.useState)(!1),[y,b]=(0,t.useState)(!1),[N,w]=(0,t.useState)(!1),[_,C]=(0,t.useState)(""),[S,F]=(0,t.useState)(!1),T=[{id:1,name:"Review (Disabled)",action:()=>{}},{id:2,name:"Cancel (Disabled)",action:()=>{}}],E=()=>{b(!y)},R=()=>{w(!N),C("")};return(0,o.jsxs)(o.Fragment,{children:[!x&&(0,o.jsxs)("tr",{className:"desktop-view",children:[(0,o.jsx)("td",{colSpan:"2",children:null===l||void 0===l?void 0:l.activity_name}),(0,o.jsx)("td",{children:(0,o.jsx)("div",{className:"created_by",style:{display:"inline-block",background:"#eef5ff",padding:"4px 10px",borderRadius:"20px",fontSize:"8px",fontWeight:"600",color:"#1766d1",border:"1px solid #cfe1ff",whiteSpace:"nowrap"},children:null===l||void 0===l?void 0:l.created_by})}),(0,o.jsx)("td",{children:(0,o.jsx)("div",{style:{display:"flex",justifyContent:"center"},children:(0,o.jsx)(A,{taskId:null===l||void 0===l?void 0:l.id,type:null===l||void 0===l?void 0:l.is_priority.toString(),isChange:!0,refetch:n})})}),(0,o.jsx)("td",{children:(0,o.jsx)("div",{style:{display:"flex",justifyContent:"center"},children:(0,o.jsx)(f,{color:"blue",taskId:null===l||void 0===l?void 0:l.id,progress:null===l||void 0===l?void 0:l.progress})})}),(0,o.jsx)("td",{children:(0,o.jsx)(k,{dateRange:null===l||void 0===l?void 0:l.date_range})}),(0,o.jsx)("td",{children:(0,o.jsx)(z,{menus:T,taskStatus:null===l||void 0===l?void 0:l.status})}),(0,o.jsx)("td",{colSpan:"2",children:(0,o.jsxs)("div",{style:{display:"flex",gap:"5px",justifyContent:"end"},children:[(0,o.jsx)(L,{notes:null===l||void 0===l?void 0:l.logs}),(0,o.jsx)(I,{daily:l}),(0,o.jsx)(v,{type:"button",color:"green",size:"sm",actionFn:()=>E(null===l||void 0===l||l.id),icon:"check_circle"}),(0,o.jsx)(v,{type:"button",color:"red",size:"sm",actionFn:()=>R(null===l||void 0===l||l.id),icon:"cancel"})]})})]}),x&&(0,o.jsx)("tr",{className:"mobile-view",children:(0,o.jsx)("td",{colSpan:"2",children:(0,o.jsxs)("div",{className:"task-item-wrapper",children:[(0,o.jsxs)("div",{className:"task-item-header",children:[(0,o.jsx)("div",{className:"task-item-title-group",children:(0,o.jsx)("span",{className:"task-item-activity-name",children:null===l||void 0===l?void 0:l.activity_name})}),(0,o.jsx)("div",{className:"task-item-progress-mobile",children:(0,o.jsx)(f,{color:null!==l&&void 0!==l&&l.status.includes("review")?"blue":"approved"===(null===l||void 0===l?void 0:l.status)?"green":"yellow",taskId:null===l||void 0===l?void 0:l.id,progress:null===l||void 0===l?void 0:l.progress,isChange:("in progress"===(null===l||void 0===l?void 0:l.status)||"revised"===(null===l||void 0===l?void 0:l.status))&&(null===r||void 0===r||null===(a=r.user)||void 0===a?void 0:a.employe_id)===(null===l||void 0===l?void 0:l.employe_id),refetch:n})})]}),(0,o.jsx)("div",{className:"task-item-timeline-mobile mt-1",children:(0,o.jsxs)("div",{className:"d-flex align-items-center justify-content-between",children:[(0,o.jsx)(k,{dateRange:null===l||void 0===l?void 0:l.date_range}),(0,o.jsx)("div",{className:"created_by",style:{display:"inline-block",background:"#eef5ff",padding:"4px 10px",borderRadius:"20px",fontSize:"8px",fontWeight:"600",color:"#1766d1",border:"1px solid #cfe1ff",whiteSpace:"nowrap"},children:null===l||void 0===l?void 0:l.created_by})]})}),(0,o.jsx)("hr",{}),(0,o.jsxs)("div",{className:"task-item-actions-group",children:[(0,o.jsxs)("div",{className:"task-item-status-group",children:[(0,o.jsx)(A,{taskId:null===l||void 0===l?void 0:l.id,type:null===l||void 0===l?void 0:l.is_priority.toString(),isChange:"in progress"===(null===l||void 0===l?void 0:l.status)||"revised"===(null===l||void 0===l?void 0:l.status)||(u||h)&&(null===l||void 0===l?void 0:l.status.includes("review")),refetch:n}),(0,o.jsx)(z,{menus:T,taskStatus:null===l||void 0===l?void 0:l.status,isLoading:j,refetch:n,isChange:"in progress"===(null===l||void 0===l?void 0:l.status)||"revised"===(null===l||void 0===l?void 0:l.status)})]}),(0,o.jsx)(v,{actionFn:()=>{F(!S)},color:"grey",icon:"more_horiz",text:"",size:"sm"})]}),S&&(0,o.jsxs)("div",{className:"task-item-secondary-actions",children:[(null===l||void 0===l||null===(i=l.logs)||void 0===i?void 0:i.length)>0&&(0,o.jsx)(L,{notes:null===l||void 0===l?void 0:l.logs}),(0,o.jsx)(I,{daily:l}),(0,o.jsx)(v,{type:"button",color:"green",size:"sm",actionFn:()=>E(null===l||void 0===l||l.id),icon:"check_circle"}),(0,o.jsx)(v,{type:"button",color:"red",size:"sm",actionFn:()=>R(null===l||void 0===l||l.id),icon:"cancel"})]})]})})}),(0,o.jsx)(D,{isOpen:y,toggle:E,loading:j,title:"Approve Task",message:"Apakah kamu yakin ingin menyetujui task ini?",handleConfirm:()=>{let e="";u&&(e="approved"),h&&(e="review manager"),g(!0),d.put("api/daily/change-status",{id:null===l||void 0===l?void 0:l.id,status:e}).then((()=>{n(),(0,p.x)("success","Task berhasil diapprove!")})).catch((e=>{(0,p.x)("error",e.response.data.message)})).finally((()=>{g(!1),b(!1)}))},btnType:"btn-success"}),(0,o.jsx)(K,{isOpen:N,togglePopup:R,title:"Revise Task",closeButton:!0,children:(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("textarea",{placeholder:"Tuliskan alasan revisi...",style:{width:"100%",minHeight:"100px",marginTop:"10px",padding:"8px",borderRadius:"6px",border:"1px solid #ccc",resize:"vertical"},value:_,onChange:e=>C(e.target.value)}),(0,o.jsxs)("div",{style:{marginTop:"15px",textAlign:"right"},className:"d-flex gap-1 justify-content-end",children:[(0,o.jsx)("button",{type:"button",className:"btn btn-outline-secondary",onClick:()=>R(),children:"Batal"}),(0,o.jsx)("button",{type:"button",className:"btn btn-success",onClick:()=>{""!==_.trim()?(g(!0),d.put("api/daily/change-status",{id:null===l||void 0===l?void 0:l.id,status:"revised",notes:_}).then((()=>{n(),(0,p.x)("success","Status task berhasil diubah!")})).catch((e=>{(0,p.x)("error",e.response.data.message)})).finally((()=>{g(!1),w(!1),C("")}))):(0,p.x)("error","Alasan revisi harus diisi!")},disabled:j,children:j?"Loading...":"Submit"})]})]})})]})},J=e=>{var s,a;let{task:i,title:t,refetch:l}=e;const n=window.innerWidth<768?1:3;return(0,o.jsx)(o.Fragment,{children:(0,o.jsx)("div",{className:"task-card-container",children:(0,o.jsx)("table",{className:"task-card",children:(0,o.jsxs)("tbody",{children:[(0,o.jsxs)("tr",{className:"task-parent",children:[(0,o.jsx)("td",{className:"task-card-title",colSpan:n,children:(null===i||void 0===i?void 0:i.task_title)||t}),(0,o.jsx)("td",{className:"progress-desktop",children:(0,o.jsx)("div",{className:"d-flex align-items-center justify-content-center",children:(0,o.jsx)(f,{color:"blue",progress:null===i||void 0===i?void 0:i.task_progress})})}),(0,o.jsx)("td",{children:(0,o.jsx)(k,{dateRange:null===i||void 0===i?void 0:i.date_range})}),(0,o.jsx)("td",{colSpan:"2",children:(0,o.jsx)(w,{data:null===i||void 0===i?void 0:i.members})}),(0,o.jsx)("td",{children:(0,o.jsx)("div",{className:"button-add",children:(0,o.jsx)("div",{className:"d-md-none",children:(0,o.jsx)(w,{data:null===i||void 0===i?void 0:i.members})})})})]}),(0,o.jsxs)("tr",{className:"mobile-display",children:[(0,o.jsx)("td",{children:(0,o.jsx)(k,{dateRange:null===i||void 0===i?void 0:i.date_range})}),(0,o.jsx)("td",{children:(0,o.jsx)("div",{className:"d-flex align-items-center justify-content-end",children:(0,o.jsx)(f,{color:"blue",progress:null===i||void 0===i?void 0:i.task_progress})})})]}),(0,o.jsxs)("tr",{className:"task-column d-none d-md-table-row",children:[(0,o.jsx)("td",{colSpan:"2",children:"Nama Task"}),(0,o.jsx)("td",{children:"PIC"}),(0,o.jsx)("td",{style:{textAlign:"center"},children:"Tipe"}),(0,o.jsx)("td",{style:{textAlign:"center"},children:"Progress"}),(0,o.jsx)("td",{children:"Jadwal"}),(0,o.jsx)("td",{children:"Status"}),(0,o.jsx)("td",{})]}),null!==i&&void 0!==i&&null!==(s=i.daily_review)&&void 0!==s&&s.length?null===i||void 0===i||null===(a=i.daily_review)||void 0===a?void 0:a.map((e=>(0,o.jsx)(q,{daily:e,refetch:l},e.id))):(0,o.jsx)(o.Fragment,{children:(0,o.jsx)("tr",{children:(0,o.jsx)("td",{colSpan:"8",className:"text-center",children:"Tidak Ada Task"})})})]})})})})},H=e=>{let{filters:s,setReviewTotal:a}=e;const l=(0,m.A)(),[n,d]=(0,t.useState)(!1),[r,c]=(0,t.useState)(""),[p,x]=(0,t.useState)([]),{data:j,isLoading:g,error:y,refetch:b}=(0,u.I)({queryKey:["daily-review",s],queryFn:async()=>{var e,i;const t=await l.get("api/daily/review-list?year=".concat(null===s||void 0===s?void 0:s.tahun,"&month=").concat(null===s||void 0===s?void 0:s.bulan,"&category=").concat(("all"===(null===s||void 0===s?void 0:s.kategori)?"":null===s||void 0===s?void 0:s.kategori)||"","&type=").concat(("all"===(null===s||void 0===s?void 0:s.tipe)?"":null===s||void 0===s?void 0:s.tipe)||"","&is_priority=").concat(("mendesak"===(null===s||void 0===s?void 0:s.is_priority)?"true":"biasa"===(null===s||void 0===s?void 0:s.is_priority)&&"false")||"")),n=(null===(e=t.data)||void 0===e||null===(i=e.data)||void 0===i?void 0:i.length)||0;return a&&a(n),t.data.data}}),f=e=>{c(e.target.value)};(0,t.useEffect)((()=>{if(j){const e=r.toLowerCase().trim();if(0===e.length)return void x(j);const s=j.map((s=>{const a=s.project_review.filter((s=>s.task_title.toLowerCase().includes(e)));return(0,i.A)((0,i.A)({},s),{},{project_review:a})}));x(s)}}),[j,r]);const N=j&&j.length>0,w=r.length>0;return g?(0,o.jsx)("div",{children:"Loading..."}):y?(0,o.jsxs)("div",{children:["Error: ",y.message]}):N||w?(0,o.jsx)(o.Fragment,{children:null===p||void 0===p?void 0:p.map((e=>{var s;return(0,o.jsxs)("div",{className:"daily-card project mb-3",children:[(0,o.jsxs)("div",{className:"card-header",children:[(0,o.jsxs)("div",{className:"header-title",children:[(0,o.jsx)("h4",{children:e.project_name}),(0,o.jsxs)("div",{className:"title-attribute",children:[(0,o.jsx)(k,{dateRange:e.date_range,isLate:e.is_late}),(0,o.jsxs)("div",{className:"attribute-item",children:[(0,o.jsx)("span",{children:e.total_task}),(0,o.jsx)("span",{children:"Task"})]})]})]}),(0,o.jsxs)("div",{className:"header-action",children:[(0,o.jsx)("div",{className:"search-desktop",children:(0,o.jsx)(h,{value:r,onChange:f,placeholder:"Cari Task..."})}),(0,o.jsx)("div",{className:"search-mobile-icon",children:(0,o.jsx)(v,{color:"grey",icon:n?"close":"search",type:"button",actionFn:()=>{d((e=>!e))}})})]})]}),n&&(0,o.jsx)("div",{className:"mobile-search-bar",children:(0,o.jsx)(h,{value:r,onChange:f,placeholder:"Cari Task..."})}),(0,o.jsx)("div",{className:"card-body",children:(0,o.jsx)("div",{className:"card-body",children:0===(null===e||void 0===e||null===(s=e.project_review)||void 0===s?void 0:s.length)?(0,o.jsx)("div",{className:"p-2 text-center text-gray-500 italic",children:"Tidak ada task Review"}):null===e||void 0===e?void 0:e.project_review.map((e=>(0,o.jsx)(J,{task:(0,i.A)({},e),category:"non-rutin",refetch:b},e.task_id)))})})]},e.project_id)}))}):(0,o.jsx)("div",{className:"text-gray-500 italic p-2 text-center",children:"Tidak ada project Review"})},V=e=>{let{filters:s,setReviewTotal:a}=e;const l=(0,m.A)(),[n,d]=(0,t.useState)(!1),[r,c]=(0,t.useState)([]),{data:p,refetch:x}=(0,u.I)({queryKey:["additional-review",s],queryFn:async()=>{var e,i;const t=await l.get("api/daily/additional-review-list?year=".concat(null===s||void 0===s?void 0:s.tahun,"&month=").concat(null===s||void 0===s?void 0:s.bulan,"&category=").concat(("all"===(null===s||void 0===s?void 0:s.kategori)?"":null===s||void 0===s?void 0:s.kategori)||"","&is_priority=").concat(("mendesak"===(null===s||void 0===s?void 0:s.is_priority)?"true":"biasa"===(null===s||void 0===s?void 0:s.is_priority)&&"false")||"")),n=(null===(e=t.data)||void 0===e||null===(i=e.data)||void 0===i?void 0:i.length)||0;return a&&a(n),t.data.data}});(0,t.useEffect)((()=>{p&&c(p)}),[p]);return(0,o.jsx)(o.Fragment,{children:null===r||void 0===r?void 0:r.map((e=>{var s;return(0,o.jsxs)("div",{className:"daily-card project mb-3",children:[(0,o.jsxs)("div",{className:"card-header",children:[(0,o.jsxs)("div",{className:"header-title",children:[(0,o.jsx)("h4",{children:e.project_name}),(0,o.jsxs)("div",{className:"title-attribute",children:[(0,o.jsx)(k,{dateRange:e.date_range,isLate:e.is_late}),(0,o.jsxs)("div",{className:"attribute-item",children:[(0,o.jsx)("span",{children:e.total_task}),(0,o.jsx)("span",{children:"Task"})]})]})]}),(0,o.jsxs)("div",{className:"header-action",children:[(0,o.jsx)("div",{className:"search-desktop",children:(0,o.jsx)(h,{})}),(0,o.jsx)("div",{className:"search-mobile-icon",children:(0,o.jsx)(v,{color:"grey",icon:n?"close":"search",type:"button",actionFn:()=>{d((e=>!e))}})})]})]}),n&&(0,o.jsx)("div",{className:"mobile-search-bar",children:(0,o.jsx)(h,{})}),(0,o.jsx)("div",{className:"card-body",children:(0,o.jsx)("div",{className:"card-body",children:0===(null===e||void 0===e||null===(s=e.project_review)||void 0===s?void 0:s.length)?(0,o.jsx)("div",{className:"p-2 text-center text-gray-500 italic",children:"Tidak ada task Review"}):null===e||void 0===e?void 0:e.project_review.map((e=>(0,o.jsx)(J,{task:(0,i.A)({},e),category:"non-rutin",refetch:x},e.task_id)))})})]},e.project_id)}))})},Y="dailies",G="review",Q="approved",$=()=>{var e,s,a;const l=JSON.parse(localStorage.getItem("auth")),n=(null===l||void 0===l||null===(e=l.user)||void 0===e?void 0:e.roles)||[],d=n.some((e=>"Manager"===e)),r=n.some((e=>"Supervisor"===e)),[u,v]=(0,t.useState)(Y),[h,m]=(0,t.useState)({sort:"all",kategori:"all",is_priority:"all",tipe:"all",tahun:(new Date).getFullYear().toString(),bulan:"",employe_id:""}),[p,x]=(0,t.useState)({totalProject:0}),[j,g]=(0,t.useState)({totalAdditional:0}),[y,b]=(0,t.useState)(0),[f,k]=(0,t.useState)(0),[N,w]=(0,t.useState)(0);(0,t.useEffect)((()=>{w(y+f)}),[y,f]);const _=e=>{x({totalProject:e.totalProject||0,totalDaily:e.totalDaily||0,formattedEmploye:e.formattedEmploye||null,totalAdditional:e.totalAdditional||0})},C=e=>{g({totalAdditional:e.totalAdditional||0})},S=(e,s)=>{m((a=>(0,i.A)((0,i.A)({},a),{},{[e]:s})))},[F,T]=(0,t.useState)(),A=(0,t.useCallback)((e=>{var s;T(e),v(F!==(null===l||void 0===l||null===(s=l.user)||void 0===s?void 0:s.employe_id)&&Y)}),[]),z=e=>{v(e)};return(0,o.jsxs)("div",{className:"daily-container",children:[(0,o.jsxs)("div",{className:"daily-header",children:[(0,o.jsx)("div",{className:"staff-dropdown-wrapper",children:(0,o.jsx)(W,{handleFilterChange:S,onSelectedStaffLoaded:A})}),(0,o.jsx)("div",{className:"header-card",children:(0,o.jsxs)("div",{className:"card-total",children:[(0,o.jsx)("h6",{className:"mb-0",children:(null===p||void 0===p?void 0:p.totalProject)||0}),(0,o.jsx)("span",{className:"text-muted",children:"Proyek"})]})}),(0,o.jsx)("div",{className:"header-card",children:(0,o.jsxs)("div",{className:"card-total",children:[(0,o.jsx)("h6",{className:"mb-0",children:(null===j||void 0===j?void 0:j.totalAdditional)||0}),(0,o.jsx)("span",{className:"text-muted",children:"Tambahan"})]})}),(0,o.jsx)("div",{className:"header-card",children:(0,o.jsxs)("div",{className:"card-total",children:[(0,o.jsx)("h6",{className:"mb-0",children:(null===p||void 0===p?void 0:p.totalDaily)+(null===j||void 0===j?void 0:j.totalAdditional)||0}),(0,o.jsxs)("span",{className:"text-muted",children:["Task ",null===h||void 0===h?void 0:h.tahun]})]})})]}),(0,o.jsxs)("div",{className:"daily-body",children:[(0,o.jsxs)("div",{className:"d-flex justify-content-between",children:[(0,o.jsx)(c,{filters:h,onFilterChange:S,disableFilter:u===G||u===Q}),(d||r)&&(null===F||void 0===F?void 0:F.employe_id)===(null===l||void 0===l||null===(s=l.user)||void 0===s?void 0:s.employe_id)&&(0,o.jsx)("div",{className:"d-flex d-md-none",children:(0,o.jsxs)("div",{className:"tab-container ",children:[(0,o.jsx)("button",{className:"tab-button ".concat(u===Y?"active":""),type:"button",onClick:()=>z(Y),children:"My Dailies"}),(0,o.jsxs)("button",{className:"tab-button ".concat(u===G?"active":""),style:{position:"relative"},type:"button",onClick:()=>z(G),children:["Need Review",(0,o.jsx)("div",{style:{display:"flex",position:"relative"},children:N>0&&(0,o.jsx)("span",{style:{position:"absolute",top:"-20px",right:"-10px",backgroundColor:"#f44336",color:"white",borderRadius:"50%",padding:"2px 6px",fontSize:"10px",minWidth:"18px",textAlign:"center",lineHeight:"1.2",fontWeight:"700",zIndex:"1"},children:N})})]}),(0,o.jsx)("button",{className:"tab-button ".concat(u===Q?"active":""),type:"button",onClick:()=>z(Q),children:"Approved"})]})})]}),(0,o.jsxs)("div",{className:"daily-cards",children:[(d||r)&&(null===F||void 0===F?void 0:F.employe_id)===(null===l||void 0===l||null===(a=l.user)||void 0===a?void 0:a.employe_id)&&(0,o.jsx)("div",{className:"d-none d-md-flex justify-content-end",children:(0,o.jsxs)("div",{className:"tab-container",children:[(0,o.jsx)("button",{className:"tab-button ".concat(u===Y?"active":""),type:"button",onClick:()=>z(Y),children:"My Dailies"}),(0,o.jsxs)("button",{className:"tab-button ".concat(u===G?"active":""),type:"button",onClick:()=>z(G),children:["Need Review",(0,o.jsx)("div",{style:{display:"flex",position:"relative"},children:N>0&&(0,o.jsx)("span",{style:{position:"absolute",top:"-20px",right:"-10px",backgroundColor:"#f44336",color:"white",borderRadius:"50%",padding:"2px 6px",fontSize:"10px",minWidth:"18px",textAlign:"center",lineHeight:"1.2",fontWeight:"700",zIndex:"10"},children:N})})]}),(0,o.jsx)("button",{className:"tab-button ".concat(u===Q?"active":""),type:"button",onClick:()=>z(Q),children:"Approved"})]})}),u===Y&&(0,o.jsxs)(o.Fragment,{children:[("tambahan"===(null===h||void 0===h?void 0:h.kategori)||"all"===(null===h||void 0===h?void 0:h.kategori))&&(0,o.jsx)(O,{filters:h,onProjectAdditionalDetailChange:C,selectedStaff:F,activeTab:Y}),("projects"===(null===h||void 0===h?void 0:h.kategori)||"all"===(null===h||void 0===h?void 0:h.kategori))&&(0,o.jsx)(B,{filters:h,onProjectDetailChange:_,selectedStaff:F,activeTab:Y})]}),u===G&&(0,o.jsxs)(o.Fragment,{children:[("tambahan"===(null===h||void 0===h?void 0:h.kategori)||"all"===(null===h||void 0===h?void 0:h.kategori))&&(0,o.jsx)(V,{filters:h,setReviewTotal:k}),("projects"===(null===h||void 0===h?void 0:h.kategori)||"all"===(null===h||void 0===h?void 0:h.kategori))&&(0,o.jsx)(H,{filters:h,setReviewTotal:b})]}),u===Q&&(0,o.jsxs)(o.Fragment,{children:[("tambahan"===(null===h||void 0===h?void 0:h.kategori)||"all"===(null===h||void 0===h?void 0:h.kategori))&&(0,o.jsx)(O,{filters:h,onProjectAdditionalDetailChange:C,selectedStaff:F,activeTab:Q}),("projects"===(null===h||void 0===h?void 0:h.kategori)||"all"===(null===h||void 0===h?void 0:h.kategori))&&(0,o.jsx)(B,{filters:h,onProjectDetailChange:_,selectedStaff:F,activeTab:Q})]})]})]})]})}},29820:(e,s,a)=>{e.exports=a.p+"static/media/user1.6ac95ef9bc0c027733ea.jpg"},203:(e,s,a)=>{a.d(s,{I:()=>h});var i=a(68664),t=a(10765),l=a(65043),n=a(49939),d=a(28873),o=a(82670),r=a(59781),c=a(1968),u=a(54483),v=a(33729);function h(e,s,a){return function(e,s){const a=(0,r.jE)({context:e.context}),i=(0,c.w)(),t=(0,o.h)(),h=a.defaultQueryOptions(e);h._optimisticResults=i?"isRestoring":"optimistic",h.onError&&(h.onError=n.j.batchCalls(h.onError)),h.onSuccess&&(h.onSuccess=n.j.batchCalls(h.onSuccess)),h.onSettled&&(h.onSettled=n.j.batchCalls(h.onSettled)),(0,v.tu)(h),(0,u.LJ)(h,t),(0,u.wZ)(t);const[m]=l.useState((()=>new s(a,h))),p=m.getOptimisticResult(h);if((0,d.r)(l.useCallback((e=>{const s=i?()=>{}:m.subscribe(n.j.batchCalls(e));return m.updateResult(),s}),[m,i]),(()=>m.getCurrentResult()),(()=>m.getCurrentResult())),l.useEffect((()=>{m.setOptions(h,{listeners:!1})}),[h,m]),(0,v.EU)(h,p,i))throw(0,v.iL)(h,m,t);if((0,u.$1)({result:p,errorResetBoundary:t,useErrorBoundary:h.useErrorBoundary,query:m.getCurrentQuery()}))throw p.error;return h.notifyOnChangeProps?p:m.trackResult(p)}((0,i.vh)(e,s,a),t.$)}}}]);
//# sourceMappingURL=6251.39bbebaa.chunk.js.map